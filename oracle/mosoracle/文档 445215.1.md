# 文档 445215.1

  

|

|

 **In this Document**  

| |
[Goal](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#GOAL)  
---|---  
|
[Solution](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#FIX)  
---|---  
| [1\. Feasibility of filesystem resize
(extend)](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section21)  
---|---  
| [2\. Backup all data on filesystem to be
resized](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section22)  
---|---  
| [3\. Resize (extend) of non-root filesystem on non-LVM
device](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section23)  
---|---  
| [3.1 Unmount filesystem to be
resized](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section24)  
---|---  
| [3.2 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section25)  
---|---  
| [3.3 Resize (extend) the
partition](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section26)  
---|---  
| [3.4 Verify partition
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section27)  
---|---  
| [3.5 Resize (extend) the
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section28)  
---|---  
| [3.6 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section29)  
---|---  
| [3.7 Mount the resized
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section210)  
---|---  
| [3.8 Verify filesystem
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section211)  
---|---  
| [4\. Resize (reduce) of non-root EXT3/4 filesystem on non-LVM
device](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section212)  
---|---  
| [4.1 Unmount the filesystem to be
resized](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section213)  
---|---  
| [4.2 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section214)  
---|---  
| [4.3 Resize (reduce) the
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section215)  
---|---  
| [4.4 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section216)  
---|---  
| [4.5 Resize (reduce) the
partition](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section217)  
---|---  
| [4.6 Verify partition
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section218)  
---|---  
| [4.7 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section219)  
---|---  
| [4.8 Mount the resized
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section220)  
---|---  
| [4.9 Verify filesystem
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section221)  
---|---  
| [5\. Resize (extend) of non-root EXT3/4 filesystem on LVM
device](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section222)  
---|---  
| [5.1 Unmount the
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section223)  
---|---  
| [5.2 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section224)  
---|---  
| [  
5.3 Resize (extend) the Logical
Volume](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section225)  
---|---  
| [5.4 Verify Logical Volume
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section226)  
---|---  
| [  
5.5 Perform a filesystem
check](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section227)  
---|---  
| [5.6 Resize (extend) the
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section228)  
---|---  
| [5.7 Mount the resized
filesystem](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section229)  
---|---  
| [5.8 Verify filesystem
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section230)  
---|---  
| [6\. Add a new Physical Volume to an existing Volume
Group](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section231)  
---|---  
| [6.1 Create new Physical
Volume](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section232)  
---|---  
| [6.2 Add the Physical Volume to the Volume
Group](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section233)  
---|---  
| [6.3 Verify Volume Group
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section234)  
---|---  
| [7\. Resize (extend) an existing Physical
Volume](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section235)  
---|---  
| [7.1 Resize (extend) the Physical
Volume](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section236)  
---|---  
| [7.2 Verify Physical Volume
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section237)  
---|---  
| [7.3 Verify Volume Group
resize](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#aref_section238)  
---|---  
|
[References](https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297&id=445215.1&_adf.ctrl-
state=pc7ho8nqx_72#REF)  
---|---  
  
* * *

## Applies to:

Linux OS - Version 2.4 to 2.6  
Oracle VM - Version 3.3.4 to 3.3.4 [Release OVM33]  
Linux x86  
Linux x86-64  
Linux Itanium  
Linux Kernel - Version: 2.4 to 3.8  
  
  

## Goal

The purpose of this article is to describe how to resize (extend & reduce) an
EXT3/4 filesystem on Oracle Linux.  
The described procedures were performed using EXT3/4 filesystems on Oracle
Linux 5/6 and equally apply to other releases.

## Solution

The following outlines how to resize an EXT3 filesystem.  
Various scenarios are provided i.e.:

  * Resize (extend) of non-root EXT3/4 filesystem on non-LVM device
  * Resize (reduce) of non-root EXT3/4 filesystem on non-LVM device
  * Resize (extend) of non-root EXT3/4 filesystem on LVM device
  * Add a new Physical Volume to an existing Volume Group
  * Resize (extend) an existing Physical Volume

Please read the article in entirety before attempting any part of the
procedures described. All procedures should be thoroughly tested before being
performed against a production environment.

### 1\. Feasibility of filesystem resize (extend)

The underlying device (partition/Logical Volume/disk/LUN) upon which an EXT3/4
filesystem resides must first be resized before the filesystem can be resized.  
Accordingly, the feasibility of underlying device resize must first be
established to determine whether filesystem resize is possible.  
The following conditions/scenarios make it feasible to resize (extend) an
EXT3/4 filesystem:

  * The EXT3/4 filesystem to be extended resides upon some form of Logical Volume Management e.g. LVM/LVM2 and sufficient diskspace exists in the Logical Volume (LV)/Volume Group (VG) or additional Physical Volumes (PVs) can be added to extend the Volume Group/Logical Volume).

  * The EXT3/4 filesystem resides on a device/partition, but does not fully occupy the entire space within the partition and sufficient diskspace exists between the end of the filesystem and partition end boundary.

  * The EXT3/4 filesystem resides on a device/partition occupying the entire partition space, however sufficient, contiguous free blocks exist on the disk/device immediately after the filesystem partition end boundary and either the 1.) next partition start boundary or 2.) end of entire disk/device).

  
Given the above, the method and commands required to resize all underlying
device(s) involved will differ depending upon storage hardware and solutions
employed.

### 2\. Backup all data on filesystem to be resized

Resizing a filesystem and underlying devices is dangerous and potentially
destructive if performed incorrectly.  
Repartitioning devices is similarly destructive and may result in complete
data loss.  
Before proceeding, backup the contents of the filesystem/device to be resized.

### 3\. Resize (extend) of non-root filesystem on non-LVM device

In this example, device /dev/sdb (20Gb) contains a single primary partition
(/dev/sdb1) of 11Gb with an EXT3/4 filesystem (/data) that spans the entire
partition.  
Approximately 9Gb of free diskspace exists between the end of the partition
and end of device.

# df -k /data  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/sdb1 11353328 10668192 223764 98% /data

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 **12008556** sdb1

# fdisk -l /dev/sdb  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 1495 12008556 83 Linux

#### 3.1 Unmount filesystem to be resized

Unmount the filesystem to be resized e.g.:

# umount /data

#### 3.2 Perform a filesystem check

Verify the filesystem type of the filesystem to be resized.  
Perform a filesystem check of the filesystem ensuring to use the corresponding
filesystem check utility (fsck.ext3, fsck.ext4) for the filesystem type e.g.:

# blkid /dev/sdb1  
/dev/sdb1: LABEL="/data" UUID="1fc0bbcd-ba86-40b6-b562-5da90fb0d7af"
TYPE="ext3"  
  
# fsck.ext3 -fy /dev/sdb1  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 21/1441792 files (4.8% non-contiguous), 2712300/2883584 blocks

#### 3.3 Resize (extend) the partition

This step assumes free diskspace exists between the end of the partition and
end of device.  
If free diskspace is unavailable, engage your Storage Administrator to
grow/extend the underlying device before re-creating a larger partition.  
Use the fdisk(8) utility to delete then recreate a larger partition, ensuring
the re-use the original partition start block e.g.:

# fdisk /dev/sdb  
  
The number of cylinders for this disk is set to 2610.  
There is nothing wrong with that, but this is larger than 1024,  
and could in certain setups cause problems with:  
1) software that runs at boot time (e.g., old versions of LILO)  
2) booting and partitioning software from other OSs  
(e.g., DOS FDISK, OS/2 FDISK)  
  
Command (m for help): **p**  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 1495 12008556 83 Linux  
  
Command (m for help): **d**  
Selected partition 1  
  
Command (m for help): **n**  
Command action  
e extended  
p primary partition (1-4)  
 **p**  
Partition number (1-4): **1**  
First cylinder (1-2610, default 1): **< enter>**  
Using default value 1  
Last cylinder or +size or +sizeM or +sizeK (1-2610, default 2610): **<
enter>**  
Using default value 2610  
  
Command (m for help): **p**  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 2610 20964793+ 83 Linux  
  
Command (m for help): **w**  
The partition table has been altered!  
  
Calling ioctl() to re-read partition table.  
Syncing disks.

#### 3.4 Verify partition resize

Verify the system sees the newly created larger partition e.g.:

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 **20964793** sdb1

  
If the system fails to detect the new partition sizing, run the partprobe(8)
utility against the resized device e.g.:

# partprobe /dev/sdb  
# cat /proc/partitions | grep sdb  
...

#### 3.5 Resize (extend) the filesystem

Use the resize2fs(8) utility to extend the EXT3/4 filesystem to utilise the
additional space in the partition e.g.:

# resize2fs /dev/sdb1  
resize2fs 1.39 (29-May-2006)  
Resizing the filesystem on /dev/sdb1 to 5241198 (4k) blocks.  
The filesystem on /dev/sdb1 is now 5241198 blocks long.

Note: when running resize2fs(8), if no size is specified, the filesystem will
be extended to utilise all available/remaining space in the partition.

#### 3.6 Perform a filesystem check

Perform a filesystem check of the resized EXT3/4 filesystem ensuring to use
the corresponding filesystem check utility (fsck.ext3, fsck.ext4) for the
filesystem type in use e.g.:

# fsck.ext3 -fy /dev/sdb1  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 21/2621440 files (4.8% non-contiguous), 2750333/5241198 blocks

#### 3.7 Mount the resized filesystem

Mount the newly resized EXT3/4 filesystem e.g.:

# mount /data

#### 3.8 Verify filesystem resize

Review dmesg(1), messages log, etc. to verify successful filesystem resize
e.g.:

# df -h /data  
Filesystem Size Used Avail Use% Mounted on  
/dev/sdb1 20G 11G 9.0G 54% /data

### 4\. Resize (reduce) of non-root EXT3/4 filesystem on non-LVM device

In this example, device /dev/sdb (20Gb) contains a single primary partition
(/dev/sdb1) of 20Gb with an EXT3/4 filesystem (/data) that spans the entire
partition.  
No free diskspace exists between the end of the partition and end of device.  
Before proceeding, run the following commands - record output for later use.

# df -k /data  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/sdb1 20635700 10672240 8915224 55% /data

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 20964793 sdb1

# fdisk -l /dev/sdb  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 2610 20964793+ 83 Linux

#### 4.1 Unmount the filesystem to be resized

Unmount the EXT3/4 filesystem to be resized e.g.:

# umount /data

#### 4.2 Perform a filesystem check

Verify the filesystem type of the filesystem to be resized i.e. whether EXT3,
EXT4, etc.  
Perform a filesystem check of the filesystem ensuring to use the corresponding
filesystem check utility (fsck.ext3, fsck.ext4) for the filesystem type e.g.:

# blkid /dev/sdb1  
/dev/sdb1: LABEL="/data" UUID="1fc0bbcd-ba86-40b6-b562-5da90fb0d7af"
TYPE="ext3"  
  
# fsck.ext3 -fy /dev/sdb1  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 21/2621440 files (4.8% non-contiguous), 2750333/5241198 blocks

#### 4.3 Resize (reduce) the filesystem

Use the resize2fs(8) utility to shrink the EXT3/4 filesystem to use less space
within the partition.  
Review the df(1) output recorded earlier to determine how small to shrink the
filesystem.  
Ensure not to reduce the ETX3/4 filesystem smaller than the actual amount of
data contained within.

# df -k /data  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/sdb1 20635700 10672240 8915224 55% /data  
  
# resize2fs /dev/sdb1 11G  
resize2fs 1.39 (29-May-2006)  
Resizing the filesystem on /dev/sdb1 to 2883584 (4k) blocks.  
The filesystem on /dev/sdb1 is now 2883584 blocks long.

Note: when running resize2fs(8), if no size is specified, the filesystem will
be extended to utilise all available/remaining space in the partition.

#### 4.4 Perform a filesystem check

Perform a filesystem check of the resized EXT3/4 filesystem ensuring to use
the corresponding filesystem check utility (fsck.ext3, fsck.ext4) for the
filesystem type in use e.g.:

# fsck.ext3 -fy /dev/sdb1  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 21/1441792 files (4.8% non-contiguous), 2712300/2883584 blocks

#### 4.5 Resize (reduce) the partition

From the filesystem check output above, the filesystem is now 2883584 (* 4Kb)
blocks in size i.e.:

# expr 2883584 \\* 4096  
11811160064 (bytes)

  
The size of the partition must remain greater than the size of the current
filesystem usage within it.  
Therefore, the partition is resized to a safe value of no less than 12Gb i.e.:

# expr 1024 \\* 12  
12288 (Mb)

  
Use the fdisk(8) utility to delete then recreate a smaller partition, ensuring
to re-use the original partition start block e.g.:

# fdisk /dev/sdb  
  
The number of cylinders for this disk is set to 2610.  
There is nothing wrong with that, but this is larger than 1024,  
and could in certain setups cause problems with:  
1) software that runs at boot time (e.g., old versions of LILO)  
2) booting and partitioning software from other OSs  
(e.g., DOS FDISK, OS/2 FDISK)  
  
Command (m for help): **p**  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 2610 20964793+ 83 Linux  
  
Command (m for help): **d**  
Selected partition 1  
  
Command (m for help): **n**  
Command action  
e extended  
p primary partition (1-4)  
 **p**  
Partition number (1-4): **1**  
First cylinder (1-2610, default 1): **< enter>**  
Using default value 1  
Last cylinder or +size or +sizeM or +sizeK (1-2610, default 2610): **+12288M**  
  
Command (m for help): **p**  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 1495 12008556 83 Linux  
  
Command (m for help): **w**  
The partition table has been altered!  
  
Calling ioctl() to re-read partition table.  
Syncing disks.

  
At this point, the diskspace between the end of partition and end of device is
available for reuse.

#### 4.6 Verify partition resize

Verify the system sees the newly resized partition e.g.:

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 **12008556** sdb1

  
If the system fails to detect the new partition sizing, run the partprobe(8)
utility against the resized device e.g.:

# partprobe /dev/sdb  
# cat /proc/partitions | grep sdb  
...

#### 4.7 Perform a filesystem check

Perform a filesystem check of the resized EXT3/4 filesystem ensuring to use
the corresponding filesystem check utility (fsck.ext3, fsck.ext4) for the
filesystem type in use e.g.:

# fsck.ext3 -fy /dev/sdb1  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 21/1441792 files (4.8% non-contiguous), 2712300/2883584 blocks

#### 4.8 Mount the resized filesystem

Mount the newly resized EXT3/4 filesystem e.g.:

# mount /data

#### 4.9 Verify filesystem resize

Review dmesg(1), messages log, etc. to verify successful filesystem resize
e.g.:

# df -k /data  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/sdb1 11353328 10668192 223764 98% /data

### 5\. Resize (extend) of non-root EXT3/4 filesystem on LVM device

In this example, a Volume Group (VG) called VolGroupData of size 20Gb contains
a Logical Volume (LV) called LogVolData01 of size 10Gb with an EXT3/4
filesystem (/data) utilising all space within the Logical Volume.  
Both the LV and EXT3/4 filesystem are resized (extended).  
In cases where a VG does not contain sufficient free space to extend a LV, see
sections 6 and 7 for examples of how to extend a VG.  
  
Before proceeding, run the following commands - record output for later use.

# fdisk -l /dev/sdb  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 2610 20964793+ 8e Linux LVM

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 20964793 sdb1

# pvs  
PV VG Fmt Attr PSize PFree  
/dev/sdb1 VolGroupData lvm2 a- 19.99G 9.99G  
  
# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 1 1 0 wz--n- 19.99G 9.99G  
  
# lvs  
LV VG Attr LSize Origin Snap% Move Log Copy% Convert  
LogVolData01 VolGroupData -wi-ao 10.00G

# df -k /dev/mapper/VolGroupData-LogVolData01  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/mapper/VolGroupData-LogVolData01  
10321208 9600672 196248 98% /data

#### 5.1 Unmount the filesystem

Unmount the EXT3/4 filesystem to be resized e.g.:

# umount /data

#### 5.2 Perform a filesystem check

Perform a filesystem check of the resized EXT3/4 filesystem ensuring to use
the corresponding filesystem check utility (fsck.ext3, fsck.ext4) for the
filesystem type in use e.g.:

# blkid /dev/VolGroupData/LogVolData01  
/dev/VolGroupData/LogVolData01: LABEL="/data" UUID="1fc0bbcd-
ba86-40b6-b562-5da90fb0d7af" TYPE="ext3"  
  
# fsck.ext3 -fy /dev/VolGroupData/LogVolData01  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 20/1294336 files (5.0% non-contiguous), 2440792/2580302 blocks

####  
5.3 Resize (extend) the Logical Volume

Use the lvextend(8) or lvresize(8)utility to extend the Logical Volume to use
available space in the Volume Group e.g.:

# lvextend -L 15G /dev/VolGroupData/LogVolData01  
Extending logical volume LogVolData01 to 15.00 GB  
Logical volume LogVolData01 successfully resized

#### 5.4 Verify Logical Volume resize

Verify Logical Volume resize e.g.:

# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 1 1 0 wz--n- 19.99G 4.99G  
  
# lvs  
LV VG Attr LSize Origin Snap% Move Log Copy% Convert  
LogVolData01 VolGroupData -wi-a- 15.00G  
  
# lvs --units m  
LV VG Attr LSize Origin Snap% Move Log Copy% Convert  
LogVolData01 VolGroupData -wi-a- 15360.00M

####  
5.5 Perform a filesystem check

Perform a filesystem check of the resized EXT3/4 filesystem ensuring to use
the corresponding filesystem check utility (fsck.ext3, fsck.ext4) for the
filesystem type in use e.g.:

# fsck.ext3 -fy /dev/VolGroupData/LogVolData01  
e2fsck 1.39 (29-May-2006)  
Pass 1: Checking inodes, blocks, and sizes  
Pass 2: Checking directory structure  
Pass 3: Checking directory connectivity  
Pass 4: Checking reference counts  
Pass 5: Checking group summary information  
data: 20/1310720 files (5.0% non-contiguous), 2441306/2621440 blocks

#### 5.6 Resize (extend) the filesystem

Use the resize2fs(8) utility to extend the EXT3/4 filesystem to use the
additional space in the Logical Volume e.g.:

# resize2fs /dev/VolGroupData/LogVolData01  
resize2fs 1.39 (29-May-2006)  
Resizing the filesystem on /dev/VolGroupData/LogVolData01 to 3932160 (4k)
blocks.  
The filesystem on /dev/VolGroupData/LogVolData01 is now 3932160 blocks long.

Note: when running resize2fs(8), if no size is specified, the filesystem will
be extended to utilise all available/remaining space in the partition.

#### 5.7 Mount the resized filesystem

Mount the newly EXT3/4 resized filesystem e.g.:

# mount /data

#### 5.8 Verify filesystem resize

Review dmesg(1), messages log, etc. to verify successful EXT3/4 filesystem
resize e.g.:

# df -k /dev/mapper/VolGroupData-LogVolData01  
Filesystem 1K-blocks Used Available Use% Mounted on  
/dev/mapper/VolGroupData-LogVolData01  
15481840 9603228 5092180 66% /data

### 6\. Add a new Physical Volume to an existing Volume Group

In this example, a new 10Gg block device (whether a partition, LUN or new
physical disk) is added to an existing Volume Group (VG) containing one fully
utilised 10Gb Physical Volume (PV).

Before proceeding, run the following commands - record output for later use.

# fdisk -l /dev/sdc  
  
Disk /dev/sdc: 10.7 GB, 10737418240 bytes  
255 heads, 63 sectors/track, 1305 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
Sector size (logical/physical): 512 bytes / 512 bytes  
I/O size (minimum/optimal): 512 bytes / 512 bytes  
Disk identifier: 0xdd344dac  
  
Device Boot Start End Blocks Id System  
/dev/sdc1 1 1305 10481388+ 83 Linux

# cat /proc/partitions | grep sdc  
8 16 10485760 sdc  
8 17 10481388 sdc1

# pvs  
PV VG Fmt Attr PSize PFree  
/dev/sdb1 VolGroupData lvm2 a- 10.00G 4.00M  
  
# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 1 1 0 wz--n- 10.00G 4.00M  
  
# lvs  
LV VG Attr LSize Origin Snap% Move Log Copy% Convert  
LogVolData01 VolGroupData -wi-ao 9.99G

#### 6.1 Create new Physical Volume

Create a new Physical Volume (PV) on the new device(s) e.g.:

# pvcreate /dev/sdc1  
Writing physical volume data to disk "/dev/sdc1"  
Physical volume "/dev/sdc1" successfully created

#### 6.2 Add the Physical Volume to the Volume Group

Add the new Physical Volume (PV) to the existing Volume Group (VG) e.g.:

# vgextend VolGroupData /dev/sdc1  
Volume group "VolGroupData" successfully extended

#### 6.3 Verify Volume Group resize

Verify the increased size of the Volume Group e.g.:

# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 2 1 0 wz--n- 19.99g 10.00g  
  
# vgdisplay VolGroupData  
\--- Volume group ---  
VG Name VolGroupData  
System ID  
Format lvm2  
Metadata Areas 2  
Metadata Sequence No 5  
VG Access read/write  
VG Status resizable  
MAX LV 0  
Cur LV 1  
Open LV 0  
Max PV 0  
Cur PV 2  
Act PV 2  
VG Size 19.99 GiB  
PE Size 4.00 MiB  
Total PE 5118  
Alloc PE / Size 2558 / 9.99 GiB  
Free PE / Size 2560 / 10.00 GiB  
VG UUID pkIDJY-jJjd-3R9k-qiER-8VbM-dYkv-LWGEJE  
  
# pvs  
PV VG Fmt Attr PSize PFree  
/dev/sdb1 VolGroupData lvm2 a-- 10.00g 4.00m  
/dev/sdc1 VolGroupData lvm2 a-- 10.00g 10.00g

### 7\. Resize (extend) an existing Physical Volume

In this example, the block device housing an existing fully utilised 10Gb
Physical Volume (PV) is grown by 10Gb.

Before proceeding, run the following commands - record output for later use.

# fdisk -l /dev/sdb  
  
Disk /dev/sdb: 21.4 GB, 21474836480 bytes  
255 heads, 63 sectors/track, 2610 cylinders  
Units = cylinders of 16065 * 512 = 8225280 bytes  
  
Device Boot Start End Blocks Id System  
/dev/sdb1 1 2610 20964793+ 8e Linux LVM

# cat /proc/partitions | grep sdb  
8 16 20971520 sdb  
8 17 20964793 sdb1

# pvs  
PV VG Fmt Attr PSize PFree  
/dev/sdb1 VolGroupData lvm2 a- 10.00G 4.00M  
  
# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 1 1 0 wz--n- 10.00G 4.00M  
  
# lvs  
LV VG Attr LSize Origin Snap% Move Log Copy% Convert  
LogVolData01 VolGroupData -wi-ao 9.99G

#### 7.1 Resize (extend) the Physical Volume

Resize (extend) the Physical Volume (currently 10Gb) to utilise all available
space on the device e.g.:

# pvresize /dev/sdb1  
Physical volume "/dev/sdb1" changed  
1 physical volume(s) resized / 0 physical volume(s) not resized

Note: when running pvresize(), if no size is specified, the PV will be
extended to utilise all available/remaining space on the device.

#### 7.2 Verify Physical Volume resize

Verify the increased size of the Physical Volume e.g.:

# pvs  
PV VG Fmt Attr PSize PFree  
/dev/sdb1 VolGroupData lvm2 a- 20.00G 10.00G

#### 7.3 Verify Volume Group resize

Verify the increased available space within the Volume Group e.g.:

# vgs  
VG #PV #LV #SN Attr VSize VFree  
VolGroupData 1 1 0 wz--n- 20.00G 10.00G

## References

  
[NOTE:445082.1](https://support.oracle.com/epmos/faces/DocumentDisplay?parent=DOCUMENT&sourceId=445215.1&id=445082.1)
\- How to resize an OCFS2 filesystem  
[NOTE:1262343.1](https://support.oracle.com/epmos/faces/DocumentDisplay?parent=DOCUMENT&sourceId=445215.1&id=1262343.1)
\- Expanding an LVM backed filesystem of an Oracle VM guest  
[NOTE:979522.1](https://support.oracle.com/epmos/faces/DocumentDisplay?parent=DOCUMENT&sourceId=445215.1&id=979522.1)
\- How To Extend An LVM (Logical Volume Manager) Volume  
  
  
  



---
### TAGS
{LVM}  {resize}

---
### NOTE ATTRIBUTES
>Created Date: 2017-08-06 08:10:35  
>Last Evernote Update Date: 2018-10-01 15:44:50  
>source: web.clip  
>source-url: https://support.oracle.com/epmos/faces/DocumentDisplay?_afrLoop=35994523625297  
>source-url: &  
>source-url: id=445215.1  
>source-url: &  
>source-url: _adf.ctrl-state=pc7ho8nqx_72#aref_section28  