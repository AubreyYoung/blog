## Oracle通过dblink连接MySQL



环境：Oracle 11.2g RAC   MySQL 5.5.9

### 1.安装Oracle GataWay

![](D:\github\blog\oracle\pictures\2018-07-27_143022.png)

![](D:\github\blog\oracle\pictures\2018-07-27_143638.png)

![](D:\github\blog\oracle\pictures\2018-07-27_143949.png)

### 2.安装mysql-connector-odbc
```
[oracle@szmlserver12_32 tools]$ ls /u01/app/tools/
my5  odbc.ini  unionodbc
```
### 3.配置 ODBC data source for MySQLConnector/ODBC driver
```
[oracle@wonder tools]$ cat /u01/app/tools/odbc.ini 
[myodbc3]

Driver = /u01/app/tools/my5/lib/libmyodbc3.so
SERVER = 22.4.22.16
PORT = 3306
USER = soft
PASSWORD = Ugfd3589
DATABASE = estore
OPTION = 3
SOCKET = 
```
### 4.设置环境变量
```
[oracle@wonder tools]$ cat ~/.bash_profile 
PATH=$PATH:$HOME/bin
export PATH
export ORACLE_BASE=/u01/app
export ORACLE_HOME=/u01/app/oracle
export ORACLE_SID=hidb
export LANG=en
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/u01/app/tools/unionodbc/lib
export ODBCINI=/u01/app/tools/odbc.ini
export PATH=$ORACLE_HOME/bin:$PATH:/u01/app/tools/unionodbc/bin
```
### 5.测试连接成功
```
[oracle@wonder tools]$ isql myodbc3 -v
+---------------------------------------+
| Connected!                            |
|                                       |
| sql-statement                         |
| help [tablename]                      |
| quit                                  |
|                                       |
+---------------------------------------+
SQL> 
```
### 6.配置listener.ora
```
[grid@wonder ~]$ cat /u01/app/11.2.0/grid/network/admin/listener.ora
# listener.ora Network Configuration File: /u01/app/11.2.0/grid/network/admin/listener.ora
# Generated by Oracle configuration tools.

LISTENER =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = IPC)(KEY = EXTPROC1521))
      (ADDRESS = (PROTOCOL = TCP)(HOST = wonder.easou.com)(PORT = 1521))
    )
  )

ADR_BASE_LISTENER = /u01/app/11.2.0

ENABLE_GLOBAL_DYNAMIC_ENDPOINT_LISTENER=ON # line added by Agent
SUBSCRIBE_FOR_NODE_DOWN_EVENT_LISTENER=OFF

SID_LIST_LISTENER=
   (SID_LIST=
        (SID_DESC=
          (SID_NAME= myodbc3)
          (ORACLE_HOME= /u01/app/oracle)
           (PROGRAM = dg4odbc)
           (ENVS=LD_LIBRARY_PATH=/u01/app/oracle/bin:/u01/app/tools/unionodbc/lib:/u01/app/tools/my5/lib)
         )
       )
```
### 7.配置tnsnames.ora,最后增加如下内容
```
myodbc3=
  (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = localhost)(PORT = 1521))
    (CONNECT_DATA =
      (SID = myodbc3)
    )
(HS = OK)
  )
```
### 8.配置HS
```
[oracle@wonder tools]$ cat /u01/app/oracle/hs/admin/initmyodbc3.ora 

HS_FDS_CONNECT_INFO = myodbc3
HS_FDS_TRACE_LEVEL = off
HS_FDS_SHAREABLE_NAME = /u01/app/tools/unionodbc/lib/libodbc.so
HS_LANGUAGE=american_america.we8iso8859p1
HS_NLS_NCHAR=UCS2

#
# ODBC specific environment variables
#
set ODBCINI= /u01/app/tools/odbc.ini
```
### 9.重启监听

[grid@wonder ~]$ lsnrctl stop
[grid@wonder ~]$ lsnrctl start

### 10.配置DBLINK
```
create database link myodbc connect to "soft" identified by "Ugfd3589" using 'myodbc3';   --前面要双引号才不报错

SQL> select count(*) from "acct_user"@myodbc;

  COUNT(*)
----------

13
```

## 11.验证
```
create database link mysql203 connect to "search_wei" identified by "aaaa" using 'mysql203';

select * from "t_info_stat"@mysql203;

SQL> create database link mysql213 connect to "droid" identified by "bbbb" using 'mysql213';

select * from "ums_module"@mysql213;
```