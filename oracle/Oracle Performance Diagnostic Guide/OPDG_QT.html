<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Oracle Performance Diagnostic Guide - Query Tuning</title>
<STYLE>
.odmtest     { font-family: Arial; font-size: 10pt; color: #FFFFFF; line-height:100%; position:relative; left:2; top:1; margin-top:0; margin-bottom:0; z-index:3 }
.odmTxtOnOld     { font-family: Arial; font-size: 10pt; color: #FFFFFF; line-height:100%; position:relative; left:0px; top:-15px; margin-top:-30; margin-bottom:0; cursor:default; z-index:3}
.odmTxtOffOld    { font-family: Arial; font-size: 10pt; color: #000000; line-height:100%; position:relative; left:0px; top:-15px; margin-top:-30; margin-bottom:0; cursor:default; z-index:3}
.odmTxtOn     { font-family: Arial; font-size: 10pt; color: #336699; margin-top:0; margin-bottom:0; font-weight:bold}
.odmTxtOff    { font-family: Arial; font-size: 10pt; color: #A6B3C8; margin-top:0; margin-bottom:0;  font-weight:bold}
.odmTxtFaded  { font-family: Arial; font-size: 10pt; color: #A6B3C8; margin-top:0; margin-bottom:0;  font-weight:bold}
.odmPic       { font-family: Arial; font-size: 12pt; color: #00FF00; line-height:100%; position:relative; left:0px; top:0px; margin-top:0; margin-bottom:0; cursor:default; z-index:2}
.detailTxtOn     { font-family: Arial; font-size: 10pt; color: #FFFFFF; line-height:100%; position:relative; left:0px; top:-15px; margin-top:-30; margin-bottom:0; cursor:default; z-index:3; text-align:center}
.detailTxtOff    { font-family: Arial; font-size: 10pt; color: #000000; line-height:100%; position:relative; left:0px; top:-15px; margin-top:-30; margin-bottom:0; cursor:default; z-index:3; text-align:center}
.detailTxtFaded  { font-family: Arial; font-size: 10pt; color: #A6B3C8; line-height:100%; position:relative; left:0px; top:-15px; margin-top:-30; margin-bottom:0; cursor:default; z-index:3; text-align:center}
.detailPic       { font-family: Arial; font-size: 12pt; line-height:100%; position:relative; left:0px; top:0px; margin-top:0; margin-bottom:0; cursor:default; z-index:2; text-align:center}
.tabTxtOn     { font-family: Arial; font-size: 10pt; color: #FFFFFF; line-height:100%; position:relative; left:5px; top:0px; margin-top:-30; margin-bottom:0; cursor:pointer; z-index:3; font-weight:bold}
.tabTxtOff    { font-family: Arial; font-size: 10pt; color: #000000; line-height:100%; position:relative; left:5px; top:0px; margin-top:-30; margin-bottom:0; cursor:pointer; z-index:3; font-weight:bold}
.tabPic       { font-family: Arial; font-size: 12pt; color: #00FF00; line-height:100%; position:relative; left:0px; top:0px; margin-top:0; margin-bottom:0; cursor:pointer; z-index:2}
.help         {color:#000000; background:#F6F8FA; font-size:10pt; font-family:Arial; margin-left:10px; margin-bottom:0px; border:2px solid #0D4988; padding:5px}
.RPHelp             { border:1px double #2B3366; font-family: Arial; font-size: 10pt; padding-left:4; padding-right:4; padding-top:1; padding-bottom:1; background-color:#CCCCCC; width:300 }
.RPHelpCR           { border:1px double #2B3366; font-family: Arial; font-size: 10pt; padding-left:4; padding-right:4; padding-top:1; padding-bottom:1; background-color:#CCCCCC; width:300; color:#FF0000 }
.qstTxtSm   { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0 }
.qstTxtMed   { font-family: Arial; font-size: 12pt; margin-top:0; margin-bottom:0 }
.HomeHdr1      { font-family: Arial; font-size: 16pt; color: #234A82; margin-top:0; margin-bottom:0; font-weight:bold }
.HomeHdr2      { font-family: Arial; font-size: 14pt; margin-top:0; margin-bottom:0; font-weight:bold }
.HomeHdr3      { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0; font-weight:bold }
.HomeHdr4      { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0; margin-left:15 }
.HomeDate      { font-family: Arial; font-size: 10pt; color: #234A82; margin-top:0; margin-bottom:0; font-weight:bold }
.detailEmptyLayer  { font-size: 1px; font-family: Arial; line-height: 100%; margin: 0 }
.detailEmptyLine 	{ font-family: Arial; font-size: 5pt; word-spacing:0; line-height:100%; color:#3C3C3C; margin-top:0; margin-bottom:0}
.detailHdrTxt       { font-family: Arial; font-size: 14pt; color: #000000; font-weight:bold; margin-bottom:0; margin-top:0 }
.detailSubHdrTxt    { font-family: Arial; font-size: 12pt; color: #000000; font-weight:bold; margin-bottom:0; margin-top:0 }
.detailLine         {color: #A6B3C8; margin-top:0; size:1}
.detailMainTxt      { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0 }
.detailBullet       { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0; list-style-type:disc }
.detailNumber       { font-family: Arial; font-size: 10pt; margin-top:0; margin-bottom:0; list-style-type:decimal }
.detailCmdTxt       { font-family: Courier New; font-size: 10pt; margin-top:0; margin-bottom:0 }
.detailTraceTxt     { font-family: Courier New; font-size: 8pt; color: #3C3C3C; margin-top:0; margin-bottom:0 }
.detailTraceBlk     { font-family: Courier New; font-size: 8pt; margin-top:0; margin-bottom:0 }
.detailTraceBlue    { font-family: Courier New; font-size: 8pt; color: #0000FF; margin-top:0; margin-bottom:0 }
.detailTraceRed     { font-family: Courier New; font-size: 8pt; color: #FF0000; margin-top:0; margin-bottom:0 }
.detailTraceGrn     { font-family: Courier New; font-size: 8pt; color: #00CC00; margin-top:0; margin-bottom:0 }
.detailTracePur     { font-family: Courier New; font-size: 8pt; color: #CC33FF; margin-top:0; margin-bottom:0 }
.detailTraceCursor  { font-family: Courier New; font-size: 8pt; color: #FF0000; margin-top:0; margin-bottom:0 }
.detailTraceSelect  { font-family: Courier New; font-size: 8pt; color: #FF0000; margin-top:0; margin-bottom:0 }
.detailTraceBind    { font-family: Courier New; font-size: 8pt; color: #0000FF; margin-top:0; margin-bottom:0 }
.detailTraceValue   { font-family: Courier New; font-size: 8pt; color: #00CC00; margin-top:0; margin-bottom:0 }
.detailTraceMsg     { font-family: Courier New; font-size: 8pt; color: #CC33FF; margin-top:0; margin-bottom:0; font-weight:bold }
.detailLevel1       { font-family: Arial; font-size: 10pt; color: #000000; margin-top:0; margin-bottom:0; font-style:italic; font-weight:bold }
.detailTbl          { padding:0; background-color:#EEF3F7 }
.detailTblHdr       { font-family: Arial; font-size: 9pt; margin-top:0; margin-bottom:0; margin-left:0; font-weight:bold }
.detailTblHdrSm     { font-family: Arial; font-size: 8pt; margin-top:0; margin-bottom:0; margin-left:0; font-weight:bold }
.detailTblBullet    { font-family: Arial; font-size: 9pt; margin-top:0; margin-bottom:0; margin-left:0 }
.detailTblTxt       { font-family: Arial; font-size: 9pt; word-spacing:0; line-height:100%; color:#234A82; margin-left:0; margin-right:0; margin-top:0; margin-bottom:0}
.detailTblTxtBlk    { font-family: Arial; font-size: 9pt; word-spacing:0; line-height:100%; color:#000000; margin-left:0; margin-right:0; margin-top:0; margin-bottom:0}
.detailTblTxt1      { font-family: Arial; font-size: 9pt; color:#234A82; }
.detailTblTxt2      { font-family: Arial; font-size: 9pt; word-spacing:0; line-height:100%; color:#234A82; margin-top:0; margin-bottom:0}
.detailTblTxt3      { font-family: Arial; font-size: 9pt; word-spacing:0; line-height:100%; color:#3C3C3C; margin-top:0; margin-bottom:0}
.detailTblTxt4      { font-family: Arial; font-size: 8pt; word-spacing:0; line-height:100%; color:#3C3C3C; margin-top:0; margin-bottom:0}
.detailTblCol1		{ background-color: #EEF3F7 }
.detailTblCol2		{ background-color: #C4D1E6 }
.detailTblEmptyLine { font-family: Arial; font-size: 5pt; word-spacing:0; line-height:100%; color:#3C3C3C; margin-top:0; margin-bottom:0}
.detailTblLine      { color: #A6B3C8; margin-top:0; size:2; width:90%}
.detailTblLowBG     { font-family: Arial; font-size: 9pt; margin:0; background-color:#00FF00; align:center; word-spacing:0; line-height:100%; text-align:center; color:#234A82}
.detailTblMedBG     { font-family: Arial; font-size: 9pt; margin:0; background-color:#FFFF00; align:center; word-spacing:0; line-height:100%; text-align:center; color:#234A82}
.detailTblHighBG    { font-family: Arial; font-size: 9pt; margin:0; background-color:#FF0000; align:center; word-spacing:0; line-height:100%; text-align:center; color:#234A82}
.breadcrumb         { font-family: Arial; font-size: 10pt; color: #234a82 }
.pagebreak          {page-break-after: always}
.htmlTitle          { font-family: Arial; font-size: 24pt; color: #234A82; font-weight:bold; margin-bottom:0; margin-top:0; text-align:center }
.htmlHdr            { font-family: Arial; font-size: 18pt; color: #234A82; font-weight:bold; margin-bottom:0; margin-top:0; text-align:center }
</STYLE>


</head>
<body>
<DIV ID="help_layer" style="color:black;background:transparent; visibility:hidden; position:absolute;left:0px;top:0px;z-index:70">help layer Text</DIV>
<table width="100%" border="0" cellspacing="1" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="95%">    <p class="HomeHdr1">Oracle Performance Diagnostic Guide (Version 3.20)</p></td>  </tr>
<tr>    <td width="95%">    <p class="HomeHdr1">Query Tuning</p></td>  </tr>  <tr>    <td width="95%"><p class=HomeDate>9/11/2012</p></td>  </tr></table><br>

<p class="detailMainTxt">&nbsp;</p>
<p class="detailMainTxt">Welcome to the Oracle Performance Diagnostic Guide &nbsp; This guide is intended to help you resolve query tuning, hang/locking, and slow database 
 issues.&nbsp; The guide is not an automated tool but rather seeks to show methodologies, techniques, common causes, and solutions to performance problems.<br>
<br>
Most of the guide is finished but portions of the content under the Hang/Locking 
tab is still under development.
<p class="detailMainTxt">
Your feedback is very valuable to us - please  email your comments to: 
<a href="mailto:Vickie.Carbonneau@oracle.com?subject=Performance%20Diagnostic%20Guide%20Feedback&body=Please%20provide%20a%20rating%20of%201-10.%20%20(1%20being%20the%20lowest,%2010%20being%20the%20highest)%0D%0DRATING:%20%20">
Vickie.Carbonneau@oracle.com</a>
</p>

<p class="HomeHdr2">&nbsp;</p><p class="HomeHdr2">&nbsp;</p><p class="HomeHdr2"><b>Contents</b></p><p class="HomeHdr2">&nbsp;</p><table width="100%" border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111"><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Identify the Issue &gt; Overview">Query Tuning &gt; Identify the Issue &gt; Overview</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Recognize a Query Tuning Issue">Recognize a Query Tuning Issue</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Clarify the Issue">Clarify the Issue</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Verify the Issue">Verify the Issue</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Special Considerations">Special Considerations</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Next Step - Data Collection">Next Step - Data Collection</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Identify the Issue &gt;Data Collection">Query Tuning &gt; Identify the Issue &gt;Data Collection</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Gather an Extended SQL Trace">Gather an Extended SQL Trace</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Next Step - Analyze">Next Step - Analyze</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Identify the Issue&nbsp; &gt; Analysis">Query Tuning &gt; Identify the Issue&nbsp; &gt; Analysis</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Verify the Problem Query using TKProf or Trace Analyzer (TRCANLZR )">Verify the Problem Query using TKProf or Trace Analyzer (TRCANLZR )</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Next Step - Determine a Cause">Next Step - Determine a Cause</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Would You Like to Stop and Log a Service Request?">Would You Like to Stop and Log a Service Request?</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Determine a Cause &gt;Overview">Query Tuning &gt; Determine a Cause &gt;Overview</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Determine a Cause &gt;Data Collection">Query Tuning &gt; Determine a Cause &gt;Data Collection</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Gather the Query's Execution Plan  [Mandatory]">Gather the Query's Execution Plan  [Mandatory]</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Gather Comprehensive Information about the Query (Mandatory)">Gather Comprehensive Information about the Query (Mandatory)</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Gather Historical Information about the Query">Gather Historical Information about the Query</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Construct a Test Script">Construct a Test Script</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Next Step - Analyze">Next Step - Analyze</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Determine a Cause &gt;Analysis">Query Tuning &gt; Determine a Cause &gt;Analysis</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Always Check: Optimizer Mode, Statistics, and Parameters">Always Check: Optimizer Mode, Statistics, and Parameters</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Choose a Tuning Strategy">Choose a Tuning Strategy</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Open a Service Request with Oracle Support Services">Open a Service Request with Oracle Support Services</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr3"><a href="#Query Tuning &gt; Reference">Query Tuning &gt; Reference</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Optimizer Mode, Statistics, and Initialization Parameters">Optimizer Mode, Statistics, and Initialization Parameters</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Access Path">Access Path</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Incorrect Selectivity or Cardinality">Incorrect Selectivity or Cardinality</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Predicates and Query Transformation">Predicates and Query Transformation</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Join Order and Type">Join Order and Type</a></p></td></tr><tr><td width="100%" valign="top" height="12"><p class="HomeHdr4"><a href="#Miscellaneous Causes and Solutions">Miscellaneous Causes and Solutions</a></p></td></tr>    </table>
<p class="HomeHdr2">&nbsp;</p><p class="HomeHdr2">&nbsp;</p><p class="HomeHdr2"><b>Feedback</b></p><p class="HomeHdr2">&nbsp;</p><p class="detailMainTxt">We look forward to your feedback.&nbsp; Please email any comments, suggestion to help improve this guide, or any issues that you have encountered with the tool usage to Vickie.Carbonneau@oracle.com, Technical Advisor, Center of Expertise (CoE).</p>
<p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Identify the Issue &gt; Overview">Query Tuning &gt; Identify the Issue &gt; Overview</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt">
<p>To properly identify the issue we want to resolve, we must do three things:
<ul>
<li> <b>Recognize</b> a query tuning issue </li>
<li> <b>Clarify</b> the details surrounding the issue </li>
<li> <b>Verify</b> that the issue is indeed the problem.</li>
</ul>
</p> </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Recognize a Query Tuning Issue">Recognize a Query Tuning Issue</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><b>What is a Query Tuning Issue?</b><br>
<br>
A query tuning issue can manifest itself as: <br>
<ul>
<li>A particular SQL statement or group of statements that run slowly at a time when other statements run well </li>
<li>One or more sessions are running slowly and most of the delay occurs during the execution of a particular SQL statement </li>
</ul>
You might have identified these queries from: <br>
<ul>
<li>benchmarking/testing </li>
<li>user complaints </li>
<li>statspack or AWR reports showing expensive SQL statements </li>
<li>a query appearing to hang </li>
<li>session consuming a large amount of CPU </li>
</ul>
These problems might appear after: <br>
<ul>
<li>schema changes </li>
<li>changes in stats </li>
<li>changes in data volumes </li>
<li>changes in application </li>
<li>database upgrades </li>
</ul>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Clarify the Issue">Clarify the Issue</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><p>A clear problem statement is critical. You need to be clear on exactly what the problem is. It may be that in subsequent phases of working through the issue, the real problem becomes clearer and you have to revisit and re-clarify the issue. </p>

<p>To clarify the issue, you must know as much as possible of the following: 
<ul>
<li>The affected SQL statement. </li>
<li>The sequence of events leading up to the problem </li>
<li>Where/how was it noticed </li>
<li>The significance of the problem </li>
<li>What IS working </li>
<li>What is the expected or acceptable result? </li>
<li>What have you done to try to resolve the problem </li>
</ul>
</p>
As an example:<br>
<ul>
<li>A SQL statement performs poorly after re-gathering statistics. </li>
<li>It was noticed by end users. </li>
<li>It is making the application run slowly and preventing our system from taking orders. </li>
<li>Everything else is fine and the problem did not show in our test environment. </li>
<li>Normally, this statement runs in less than 2 seconds. </li>
<li>We tried re-gathering stats, but it did not make any difference. </li>
</ul>
<p><br><b>Why is this step mandatory? </b><br>
Skipping this step will be risky because you might attack the wrong problem and waste significant time and effort. A clear problem statement is critical to begin finding the cause and solution to the problem. 
</p>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Notes</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=312789.1">    ODM Reference: Identify the Issue</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">How-To</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=232443.1">    How to Identify Resource Intensive SQL for Tuning</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Case Studies</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=369412.1">    Resolving High CPU usage in Oracle Servers</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Verify the Issue">Verify the Issue</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><p>Our objective in this step of the diagnostic process is to ensure the query that is thought to need tuning, is actually the query at the root of the performance problem. At this point, you need to collect data that verifies the existence of a problem. </p>
<p>To verify the existence of the issue you must collect : 
<ul>
<li>the SQL statement </li>
<li>evidence of the poor performance of the query </li>
</ul>
</p>
<p>Example: </p>
The following query is slow: <br>
<p>
<pre class="detailTraceBlk">
SELECT order_id 
 FROM po_orders
 WHERE branch_id = 6
</pre>
</p>

<p>Timing information was collected using SQLPlus as follows: </p>
<p>
<pre class="detailTraceBlk">
 SQL> set timing on 
 SQL> SELECT order_id 
      FROM po_orders
      WHERE branch_id = 6

       ORDER_ID
     ----------
            232

     Elapsed: 00:00:13.26
</pre>
</p>
<p>Further examples and advice on what diagnostic information will be needed to resolve the problem will be discussed in the DATA COLLECTION section. </p>
<br>
Once the data is collected, you will review it to either verify there is a query tuning issue, or decide it is a different issue.<br>
<br>
<p><b>Why is this step mandatory?</b><br>
If you skip this step, you might have identified the wrong query to tune and waste significant time and effort before you realize it.  For example, the performance problem appears to be a 30 second delay to display a page; however, by verifying the issue, you see that the query you suspect to be a problem actually completes in 1 second.  In this case, query tuning will not help solve this problem.  Maybe, the problem lies with the network (e.g. latency or timeouts)  or application server (e.g., high CPU utilization on the mid tier).</p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Notes</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=312789.1">    ODM Reference: Identify the Issue</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Special Considerations">Special Considerations</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><ul>
<li><font color="#FF0000">If you are on Oracle 10g or higher AND are licensed for the EM Tuning Pack, you should stop here and use the SQL Tuning Advisor to resolve your query tuning problem. </font></b><br>
<blockquote>Please see the following resources to get started with the SQL Tuning Advisor:<br>
<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_tune.htm#i22019">10gR2 PerformanceTuning Guide, Automatic SQL Tuning</a><br>
<a target="detailWindow" href="http://www.oracle.com/technology/products/manageability/database/pdf/ow05/PS_S997_273997_106-1_FIN_v2.pdf">White Paper: Optimizing the Optimizer</a><br>
<a target="detailWindow" href="http://www.oracle.com/database/db_manageability.html">Oracle 10g Manageability</a>
</blockquote>
</li>
<li>Database and application (query) tuning is an interactive process that requires a complete understanding of the environment where the database resides (database, operating system, application, etc). Standard Product Support Services provide solutions to bugs that may affect the performance of the database and its components. Support may also provide general recommendations to begin the tuning process. To perform a complete performance analysis, you must request one of the advanced services that Oracle Support has available to tune your system. Visit http://www.oracle.com/support/assist/index.html or contact your Support Sales representative for further details on these services.</li>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Next Step - Data Collection">Next Step - Data Collection</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">When you have done the above, click "NEXT" to get some guidance on collecting data that will help to validate that you are looking at the right problem and that will help in diagnosing the cause of the problem.    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Identify the Issue &gt;Data Collection">Query Tuning &gt; Identify the Issue &gt;Data Collection</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt">
<p>In this step, we will collect data to help verify whether the suspected query is the one that should be tuned.  
We should be prepared to identify the specific steps in the application that cause the slow query to execute.  
We will trace the database session while the application executes this query.</p>
<p><b>Note:</b>&nbsp; Always try to collect data when the query ran well and when it ran poorly.&nbsp; 
Migrations and other changes sometimes cause queries to change.&nbsp; Having both the 
"good" and "bad" execution plans can help determine what might be going wrong and how to fix it.
</p>
 </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Gather an Extended SQL Trace">Gather an Extended SQL Trace</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>The extended SQL trace (10046 trace at level 12) will capture execution statistics of all SQL statements issued by 
a session during the trace.  It will show us how much time is being spent 
per statement, how much of the time was due to CPU or wait events, and 
what the bind values were. We will be able to verify if the "candidate" SQL statement is truly among the SQL issued by a typical session.</p>
For detailed information on how to use the 10046 trace event, read <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=376442.1">Recommended Method for Obtaining 10046 trace for Tuning</a> first</b><br>
<br>
A summary of the steps needed to obtain the 10046 and TKProf are listed below:    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Choose a session to trace </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><b>Target the most important / impacted sessions</b>
<ul>
<li>Users that are experiencing the problem most severely; e.g., normally the transaction is complete in 1 sec, but now it takes 30 sec.</li>
<li>Users that are aggressively accumulating time in the database</li>
</ul>
<br>
The following queries will allow you to find the sessions currently logged into the database that have accumulated the most time on CPU or for certain wait events.  Use them to identify potential sessions to trace using 10046.<br>
<br>
These queries are filtering the sessions based on logon times less than 4 hours and the last call occurring within 30 minutes.  This is to find more currently relevant sessions instead of long running ones that accumulate a lot of time but aren't having a performance problem.  You may need to adjust these values to suit your environment.<br>
<br>
<u>Find Sessions with the Highest CPU Consumption</u><br>
<br>
<p class="detailMainTxt">&nbsp;</p>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%">
<pre>
-- sessions with highest CPU consumption
SELECT s.sid, s.serial#, p.spid as "OS PID",s.username, s.module, st.value/100 as "CPU sec"
FROM v$sesstat st, v$statname sn, v$session s, v$process p
WHERE sn.name = 'CPU used by this session' -- CPU
AND st.statistic# = sn.statistic#
AND st.sid = s.sid
AND s.paddr = p.addr
AND s.last_call_et < 1800 -- active within last 1/2 hour
AND s.logon_time > (SYSDATE - 240/1440) -- sessions logged on within 4 hours
ORDER BY st.value;

       SID    SERIAL# OS PID       USERNAME             MODULE                                      CPU sec
---------- ---------- ------------ -------------------- ---------------------------------------- ----------
       141       1125 15315        SYS                  sqlplus@coehq2 (TNS V1-V3)                     8.25
       147        575 10577        SCOTT                SQL*Plus                                     258.08
       131        696 10578        SCOTT                SQL*Plus                                     263.17
       139        218 10576        SCOTT                SQL*Plus                                     264.08
       133        354 10583        SCOTT                SQL*Plus                                     265.79
       135        277 10586        SCOTT                SQL*Plus                                     268.02

</pre>
</td>
  </tr>
</table>
<p class="detailMainTxt">&nbsp;</p>
<p class="detailMainTxt">&nbsp;</p>
<u>Find Sessions with Highest Waits of a Certain Type</u><br>
<br>
<p class="detailMainTxt">&nbsp;</p>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%">
<pre>
-- sessions with the highest time for a certain wait
SELECT s.sid, s.serial#, p.spid as "OS PID", s.username, s.module, se.time_waited
FROM v$session_event se, v$session s, v$process p
WHERE se.event = '&event_name' 
AND s.last_call_et < 1800 -- active within last 1/2 hour
AND s.logon_time > (SYSDATE - 240/1440) -- sessions logged on within 4 hours
AND se.sid = s.sid
AND s.paddr = p.addr
ORDER BY se.time_waited;

SQL> /
Enter value for event_name: db file sequential read

       SID    SERIAL# OS PID       USERNAME             MODULE                                   TIME_WAITED
---------- ---------- ------------ -------------------- ---------------------------------------- -----------
       141       1125 15315        SYS                  sqlplus@coehq2 (TNS V1-V3)                         4
       147        575 10577        SCOTT                SQL*Plus                                       45215
       131        696 10578        SCOTT                SQL*Plus                                       45529
       135        277 10586        SCOTT                SQL*Plus                                       50288
       139        218 10576        SCOTT                SQL*Plus                                       51331
       133        354 10583        SCOTT                SQL*Plus                                       51428

</pre>
</td>
  </tr>
</table>
<p class="detailMainTxt">&nbsp;</p>
<p class="detailMainTxt">&nbsp;</p>
<u>10g or higher: Find Sessions with the Highest DB Time</u><br>
<br>
<p class="detailMainTxt">&nbsp;</p>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%">
<pre>
-- sessions with highest DB Time usage
SELECT s.sid, s.serial#, p.spid as "OS PID", s.username, s.module, st.value/100 as "DB Time (sec)"
, stcpu.value/100 as "CPU Time (sec)", round(stcpu.value / st.value * 100,2) as "% CPU"
FROM v$sesstat st, v$statname sn, v$session s, v$sesstat stcpu, v$statname sncpu, v$process p
WHERE sn.name = 'DB time' -- CPU
AND st.statistic# = sn.statistic#
AND st.sid = s.sid
AND  sncpu.name = 'CPU used by this session' -- CPU
AND stcpu.statistic# = sncpu.statistic#
AND stcpu.sid = st.sid
AND s.paddr = p.addr
AND s.last_call_et < 1800 -- active within last 1/2 hour
AND s.logon_time > (SYSDATE - 240/1440) -- sessions logged on within 4 hours
AND st.value > 0;

       SID    SERIAL# OS PID       USERNAME MODULE                                   DB Time (sec) CPU Time (sec)      % CPU
---------- ---------- ------------ -------- ---------------------------------------- ------------- -------------- ----------
       141       1125 15315        SYS      sqlplus@coehq2 (TNS V1-V3)                       12.92           9.34      72.29
</pre>
<br>
<b>Note: sometimes DB Time can be lower than CPU Time when a session issues long-running recursive calls.
The DB Time statistic doesn't update until the top-level call is finished (versus the CPU statistic that updates as each call completes).</b>
</td>
  </tr>
</table>
<p class="detailMainTxt">&nbsp;</p>

<b>Obtain a complete trace</b>
<ul>
<li>Ideally, start the trace as soon as the user logs on and begins the operation or transaction.  Continue tracing until the operation is finished.</li>
<li>Try to avoid starting or ending the trace in the middle of a call unless you know the call is not important to the solution</li>
</ul>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Collect the trace and generate a TKProf or TRCANLZR report </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<ul>
<li>A connected session</li>
<ul>
<li><p>Start tracing on a connected session</p></li>
<li><p>Coordinate with the user to start the operation</p></li>
<li><p>Measure the client's response time for the operation</p>
<blockquote>The idea here is compare the time it takes to perform some function in the application from the user's perspective to the time it takes to execute the application's underlying SQL in the database for that functionality.  If these two times are close, then the performance problem is in the database.  Otherwise, the problem may be elsewhere.</blockquote>
</li>
<li><p>Stop tracing </p></li>
<li><p>Gather the trace file from the "user_dump_dest" location (you can usually identify the file just by looking at the timestamp).</p></li>
</ul>
<br>
<li>Using a test script</li>
<ul>
  <li>Simply run the test script and collect the trace file from the "user_dump_dest" location (you can usually identify the file just by looking at the timestamp).</li>
</ul>
<br>
<li>Other Considerations</li>
<ul>
<li>Shared Servers:  Tracing shared servers could cause many separate trace files to be produced as the session moves to different Oracle processes during execution.  Use the 10g utility, "trcsess" to combine these separate files into one.</li>
</ul>
<br>
<li><p>Generate a TRCANLZR report (see references for <i>Scripts and Tools</i>) or generate a TKProf report and sort the SQL statements in order of most elapsed time using the following command:</p></li>
</ul>
<blockquote>

<p><b>tkprof &lt;trace file name&gt; &lt;output file name&gt;  <font color="#0000ff">sort=fchela,exeela,prsela</font></b></p>
</blockquote>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Make sure trace file contains only data from the recent test </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"> 
<ul>
<li><p>If this session has been traced recently, there may be other traces mixed in the file with the recent trace collected</p></li>
<li><p>We should extract only the trace data that is part of the recent tests.  See the place in the sample trace below where it says "Cut away lines above this point".</p></li>
</ul>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%">
      <p align="left" class="detailMainTxt"><i><b>Trace file from a long running process that has been traced intermittently over several days</b></i></p>
      <p align="left" class="detailTraceBlk">. . .</p>
      <p align="left" class="detailTraceRed"><b>*** <font color="#FF0000">2006-07-24 13:35:05.642</font>
      </b><font color="#0000FF">&lt;== Timestamp from a previous tracing</font></p>
      <p align="left" class="detailTraceBlk">WAIT #8: nam='SQL*Net message from client' ela= 20479935 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">=====================</p>
      <p align="left" class="detailTraceBlk">PARSING IN CURSOR #9 len=43 dep=0 uid=57 oct=3 lid=57 tim=1007742062095 hv=4018512766 ad='97039a58'</p>
      <p align="left" class="detailTraceBlk"><b><font color="#008000">select e.empno, d.deptno</font></b><font color="#0000FF">&lt;== Previous cursor that was traced
      </font> </p>
      <p align="left" class="detailTraceBlk"><b><font color="#008000">from emp e, dept d</font></b></p>
      <p align="left" class="detailTraceBlk">END OF STMT</p>
      <p align="left" class="detailTraceBlk">PARSE #9:c=630000,e=864645,p=10,cr=174,cu=0,mis=1,r=0,dep=0,og=4,tim=1007742062058</p>
      <p align="left" class="detailTraceBlk">BINDS #9:</p>
      <p align="left" class="detailTraceBlk">EXEC #9:c=0,e=329,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=4,tim=1007742062997</p>
      <p align="left" class="detailTraceBlk">WAIT #9: nam='SQL*Net message to client' ela= 18 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">. . .</p>
      <p align="left" class="detailTraceBlk">FETCH #9:c=10000,e=513,p=0,cr=1,cu=0,mis=0,r=15,dep=0,og=4,tim=1007742148898</p>
      <p align="left" class="detailTraceBlk">WAIT #9: nam='SQL*Net message from client' ela= 2450 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">WAIT #9: nam='SQL*Net message to client' ela= 7 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">FETCH #9:c=0,e=233,p=0,cr=0,cu=0,mis=0,r=10,dep=0,og=4,tim=1007742152065</p>
      <p align="left" class="detailTraceBlk">. . .</p>
      <p align="left" class="detailTraceBlk">&nbsp;</p>
      <p align="left" class="detailTracePur"><b>====&gt; CUT AWAY LINES ABOVE THIS POINT - THEY AREN'T PART OF THIS TEST &lt;====</b></p>
      <p align="left" class="detailTraceBlk"><b><font color="#FF0000">*** 2006-07-24 18:35:48.850</font></b></p>
      <font color="#0000FF">&lt;== Timestamp for the tracing we want (notice its about 5 hours later)</font></p>
      <p align="left" class="detailTraceBlk">=====================</p>
      <p align="left" class="detailTraceBlk">PARSING IN CURSOR #10 len=69 dep=0 uid=57 oct=42 lid=57 tim=1007783391548 hv=3164292706 ad='9915de10'</p>
      <p align="left" class="detailTraceBlk">alter session set events '10046 trace name context forever, level 12'</p>
      <p align="left" class="detailTraceBlk">END OF STMT</p>
      <p align="left" class="detailTraceBlk">. . .</p>
      <p align="left" class="detailTraceBlk">=====================</p>
      <p align="left" class="detailTraceBlk">PARSING IN CURSOR #3 len=68 dep=0 uid=57 oct=3 lid=57 tim=1007831212596 hv=1036028368 ad='9306bee0'</p>
      <p align="left" class="detailTraceBlk"><b><font color="#008000">select e.empno, d.dname</font></b><font color="#0000FF">&lt;== Cursor that was traced</font></p>
      <p align="left" class="detailTraceBlk"><b><font color="#008000">from emp e, dept d</font></b></p>
      <p align="left" class="detailTraceBlk"><b><font color="#008000">where e.deptno = d.deptno</font></b></p>
      <p align="left" class="detailTraceBlk">END OF STMT</p>
      <p align="left" class="detailTraceBlk">PARSE #3:c=20000,e=17200,p=0,cr=6,cu=0,mis=1,r=0,dep=0,og=4,tim=1007831212566</p>
      <p align="left" class="detailTraceBlk">BINDS #3:</p>
      <p align="left" class="detailTraceBlk">EXEC #3:c=0,e=321,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=4,tim=1007831213512</p>
      <p align="left" class="detailTraceBlk">WAIT #3: nam='SQL*Net message to client' ela= 15 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">WAIT #3: nam='db file sequential read' ela= 7126 p1=4 p2=11 p3=1</p>
      <p align="left" class="detailTraceBlk">. . .</p>
      <p align="left" class="detailTraceBlk">FETCH #3:c=10000,e=39451,p=12,cr=14,cu=0,mis=0,r=1,dep=0,og=4,tim=1007831253359</p>
      <p align="left" class="detailTraceBlk">WAIT #3: nam='SQL*Net message from client' ela= 2009 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">WAIT #3: nam='SQL*Net message to client' ela= 10 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">FETCH #3:c=0,e=654,p=0,cr=1,cu=0,mis=0,r=13,dep=0,og=4,tim=1007831256674</p>
      <p align="left" class="detailTraceBlk">WAIT #3: nam='SQL*Net message from client' ela= 13030644 p1=1650815232 p2=1 p3=0</p>
      <p align="left" class="detailTraceBlk">STAT #3 id=1 cnt=14 pid=0 pos=1 obj=0 op='HASH JOIN (cr=15 pr=12 pw=0 time=39402 us)'</p>
      <p align="left" class="detailTraceBlk">=====================</p>
      <p align="left" class="detailTraceBlk">PARSING IN CURSOR #7 len=55 dep=0 uid=57 oct=42 lid=57 tim=1007844294588 hv=2217940283 ad='95037918'</p>
      <p align="left" class="detailTraceBlk">
        <font color="#FF0000">
        <b>alter session set events '10046 trace name context off</b>'</font>
        <font color="#0000FF">&lt;== tracing turned off </font> </p>
      <p align="left" class="detailTraceBlk">END OF STMT</p>
        </td>
  </tr>
</table>

    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Make sure the trace is complete </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<ul>
	<li><p>If the trace started or ended during a call, its best to rethink how the trace is started to ensure this doesn't happen.  You can get an idea for the the amount of time attributed to the call that was in progress at the beginning or end of the trace by looking at the timestamps to find the total time spent prior to the first call and comparing it to the call's elapsed time (although if there were other fetch calls before the first one in the trace, you'll miss those) .  The following trace file excerpt was taken by turning on the trace after the query had been executing for a few minutes.</p></li>
</ul>
    <p>&nbsp;
    <table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%"><p align="left" class="detailTraceBlk">*** 2006-07-24 15:00:45.538 
    <font color="#0000FF">&lt;== Time when the trace was started</font></p>
    <p align="left" class="detailTraceBlk">WAIT #3: nam='db file scattered read' ela= 18598 p1=4 p2=69417 p3=8 
    <font color="#0000FF">&lt;== Wait</font></p>
	<p align="left" class="detailTraceBlk">*** 2006-07-24 15:01:16.849 
    <font color="#0000FF">&lt;== 10g will print timestamps if trace hasn't been written to in a while</font></p>
	<p align="left" class="detailTraceBlk"><font color="#008000">WAIT #3: nam='db file scattered read' ela= 20793 p1=4 p2=126722 p3=7</font><p align="left" class="detailTraceBlk">. . .
	<p align="left" class="detailTraceBlk">*** 2006-07-24 15:27:46.076</p>
	<p align="left" class="detailTraceBlk"><b><font color="#008000">WAIT #3: nam='db file sequential read' ela= 226 p1=4 p2=127625 p3=1 &lt;== Yet more waits</font></b></p>
	<p align="left" class="detailTraceBlk"><b><font color="#008000">WAIT #3: nam='db file sequential read' ela= 102 p1=4 p2=45346 p3=1</font></b></p>
	<p align="left" class="detailTraceBlk"><b><font color="#008000">WAIT #3: nam='db file sequential read' ela= 127 p1=4 p2=127626 p3=1</font></b></p>
	<p align="left" class="detailTraceBlk"><b><font color="#008000">WAIT #3: nam='db file scattered read' ela= 2084 p1=4 p2=127627 p3=16</font></b></p>
	<p align="left" class="detailTraceBlk">. . .</p>
	<p align="left" class="detailTraceBlk">*** 2006-07-24 15:30:28.536 
    <font color="#0000FF">&lt;== Final timestamp before end of FETCH call</font></p>
	<p align="left" class="detailTraceBlk"><b><font color="#008000">WAIT #3: nam='db file scattered read' ela= 5218 p1=4 p2=127705 p3=16</font></b>
    <font color="#0000FF">&lt;== Final wait</font></p>
	<p align="left" class="detailTraceBlk">WAIT #3: nam='SQL*Net message from client' ela= 1100 p1=1650815232 p2=1 p3=0</p>
	<p align="left" class="detailTraceBlk">=====================</p>
	<p align="left" class="detailTraceBlk">PARSING IN CURSOR #3 len=39 dep=0 uid=57 oct=0 lid=57 tim=1014506207489 hv=1173176699 ad='931230c8'</p>
	<p align="left" class="detailTraceBlk">select count(*) from big_tab1, big_tab2 
    <font color="#0000FF">&lt;== This is not a real parse call, just printed for 
    convenience</font></p>
	<p align="left" class="detailTraceBlk">END OF STMT
    <p align="left" class="detailTraceBlk">&nbsp;</p>
	<p align="left" class="detailTraceBlk">FETCH #3:c=0,<b><font color="#FF0000">e=11</font></b>,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=0,tim=1014506207466
    <font color="#0000FF">&lt;== Completion of FETCH call</font></p>
	<p align="left" class="detailTraceBlk"><font color="#0000FF">Notice the FETCH reports 11 microSec elapsed. This is wrong as you can see from timestamps -</font></p>
	<p align="left" class="detailTraceBlk"><font color="#0000FF">It should be around 30 minutes. Maybe this is a feature?</font></p>
  </td>
  </tr>
</table>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Check if most of the elapsed time is spent waiting <i>between</i> calls </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>Waits for "SQL*Net Message from Client" between calls (usually FETCH calls) indicate a performance problem with the client (slow client or not using array operations) or network (high latencies, low bandwidth, or timeouts).  Query tuning will not solve these kinds of problems.  Evidence of waits <i>between</i> calls can be spotted by looking at the following:</p>
<p>1) In the TKProf, you will notice the total time spent in the database is small compared to the time waited by the client.  You will also see the bulk of the time in "SQL*Net message from client" in the waits section, as shown below:</p>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%"><p class="detailMainTxt"><i><b>TKProf of a session where the client used an arraysize of 2 and caused many fetch calls</b></i></p>
    <p class="detailMainTxt">&nbsp;</p>
<pre class="detailTraceBlk">select empno, ename from  emp

call     count     cpu  elapsed  disk   query  current    rows
------- ------  ------ -------- ----- ------- --------  ------
Parse        1    0.00     0.00     0       0        0       0
Execute      1    0.00     0.00     0       0        0       0
Fetch        <b><font color="#FF0000">8</font></b>    0.00     0.00     0      14        0      <b><font color="#FF0000">14</font></b>
------- ------  ------ -------- ----- ------- --------  ------
total       10    0.00     0.00     0      14        0      14


Rows     Row Source Operation
-------  ---------------------------------------------------
     14  TABLE ACCESS FULL EMP (cr=14 pr=0 pw=0 time=377 us)


Elapsed times include waiting on following events:
  Event waited on                Times   Max. Wait  Total Waited
  ---------------------------   Waited  ----------  ------------
  SQL*Net message to client          8        0.00          0.00
  <b><font color="#FF0000">SQL*Net message from client</font></b>        <b><font color="#FF0000">8</font></b>       29.36         <b><font color="#FF0000">78.39</font></b></pre>
<p align="left" class="detailMainTxt">&nbsp;</p>
<p align="left" class="detailMainTxt"><font color="#0066CC">Notice above: 8 fetch calls to return 14 rows. 78.39 seconds waiting for &quot;SQL*Net message from client&quot; for 8 waits. Each wait corresponds to each fetch call. The total database time was 377 microSeconds, but the total elapsed time to fetch all 14 rows was 78.39 seconds due to client waits. If you reduce the number of fetches, you will reduce the overall elapsed time. In any case, the database is fine, the problem is really external to the database.
</font> </p>
    </td>
  </tr>
</table>
<p>2) To confirm whether the waits are due to a slow client, examine the 10046 trace for the SQL statement and look for WAITs in between FETCH calls, as follows:</p>
<table width="98%" class="detailTbl" border="1">
  <tr>
    <td width="100%">
    <p align="left" class="detailTraceBlk">PARSING IN CURSOR #2 len=29 dep=0 uid=57 oct=3 lid=57 tim=1016349402066 hv=3058029015 ad='94239ec0'</p>
    <p class="detailTraceBlk">select empno, ename from emp</p>
    <p align="left" class="detailTraceBlk">END OF STMT</p>
<p align="left" class="detailTraceBlk">PARSE #2:c=0,e=5797,p=0,cr=0,cu=0,mis=1,r=0,dep=0,og=4,tim=1016349402036</p>
<p align="left" class="detailTraceBlk">EXEC #2:c=0,e=213,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=4,tim=1016349402675</p>
<p align="left" class="detailTraceBlk"><b><font color="#FF0000">WAIT #2: nam='SQL*Net message to client' ela= 12 p1=1650815232 p2=1 p3=0</font></b></p>

<p align="left" class="detailTraceBlk"><b><font color="#008000">FETCH #2:c=0,e=423,p=0,cr=7,cu=0,mis=0,r=1,dep=0,og=4,tim=1016349403494
</font></b><font color="#0000FF">&lt;== Call Finished </font>
      <p align="left" class="detailTraceBlk"><b><font color="#FF0000">WAIT #2: nam='SQL*Net message from client' ela= 1103179 p1=1650815232 p2=1 p3=0</font></b>
      <font color="#0000FF">&lt;== Wait for client</span> </font>
      <p align="left" class="detailTraceBlk">WAIT #2: nam='SQL*Net message to client' ela= 10 p1=1650815232 p2=1 p3=0</p>
<p align="left" class="detailTraceBlk"><b><font color="#008000">FETCH #2:c=0,e=330,p=0,cr=1,cu=0,mis=0,r=2,dep=0,og=4,tim=1016350507608
</font></b><font color="#0000FF">&lt;== Call Finished (2 rows)</font>
      <p align="left" class="detailTraceBlk"><b><font color="#FF0000">WAIT #2: nam='SQL*Net message from client' ela= 29367263 p1=1650815232 p2=1 p3=0</font></b>
      <font color="#0000FF">&lt;== Wait for client</font></p>
<p align="left" class="detailTraceBlk">WAIT #2: nam='SQL*Net message to client' ela= 9 p1=1650815232 p2=1 p3=0</p>
<p align="left" class="detailTraceBlk"><font color="#008000"><b>FETCH #2:c=0,e=321,p=0,cr=1,cu=0,mis=0,r=2,dep=0,og=4,tim=1016379876558</b>
</font><font color="#0000FF">&lt;== Call Finished (2 rows) </font>
      <p align="left" class="detailTraceBlk"><font color="#FF0000"><b>WAIT #2: nam='SQL*Net message from client' ela= 11256970 p1=1650815232 p2=1 p3=0</b></font>
      <font color="#0000FF">&lt;== Wait for client</font></p>
<p align="left" class="detailTraceBlk">WAIT #2: nam='SQL*Net message to client' ela= 10 p1=1650815232 p2=1 p3=0</p>
<p align="left" class="detailTraceBlk">. . .</p>
<p align="left" class="detailTraceBlk"><b><font color="#008000">FETCH #2:c=0,e=486,p=0,cr=1,cu=0,mis=0,r=1,dep=0,og=4,tim=1016409054527</font></b></p>
<p align="left" class="detailTraceBlk">WAIT #2: nam='SQL*Net message from client' ela= 18747616 p1=1650815232 p2=1 p3=0</p>
<p align="left" class="detailTraceBlk">STAT #2 id=1 cnt=14 pid=0 pos=1 obj=49049 op='TABLE ACCESS FULL EMP (cr=14 pr=0 pw=0 time=377 us)'
      <p align="left" class="detailMainTxt">&nbsp;</p>
      <p align="left" class="detailMainTxt"><font color="#0000FF">Notice: Between each FETCH call, there is a wait for the client. The client is slow and responds every 1 - 2 seconds.</font></p>
      </td>
  </tr>
</table>
<br>
<br>
If it appears that most waits occur in between calls for the <i>SQL*Net message from client</i> event, proceed to the "Slow Database" tab and navigate to this section for help in diagnosing these waits:  Slow Database > Determine a Cause >Analysis > Choose a Tuning Strategy > Reduce Client Bottlenecks 
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Documentation</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="http://download.oracle.com/docs/cd/B14117_01/server.101/b10752/sqltrace.htm#8723">    Understanding SQL Trace and TKProf</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">How-To</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1058210.6">    How To Collect 10046 Trace Data</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=376442.1">    Recommended Method for Obtaining 10046 trace for Tuning</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">SCRIPTS/TOOLS</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=224270.1">    Trace Analyzer TRCANLZR - Interpreting Raw SQL Traces with Binds and/or Waits generated by EVENT 10046</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=108312.1">    How To Generate TKProf reports</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=352363.1">    Collect 10046 Traces Automatically with LTOM</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Next Step - Analyze">Next Step - Analyze</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">When you have collected the data, click "NEXT" to receive guidance on analyzing the data and verify whether or not the suspected query is indeed the one to tune.    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Identify the Issue&nbsp; &gt; Analysis">Query Tuning &gt; Identify the Issue&nbsp; &gt; Analysis</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt"><p>This step will analyze the trace file and TKProf data collected in the previous step to verify the suspected query is actually the one that should be tuned.</p> </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Verify the Problem Query using TKProf or Trace Analyzer (TRCANLZR )">Verify the Problem Query using TKProf or Trace Analyzer (TRCANLZR )</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>At this stage, we will verify the suspected problem query using TKProf or TRCANLZR (recommended).  TKProf and TRCANLZR will summarize the output of the SQL trace file to show us how much time each SQL statement took to 
run, the runtime execution plan (if the cursor was closed), and the waits 
associated with each statement (TRCANLZR will supply more detail and account for the time completely). We can quickly see the statements that 
were responsible for most of the time and hence should be considered for 
tuning.</p>
<p>If we see the that the top SQL statement in TKProf is the same one 
we suspect needs tuning, then we have verified the issue.</p>
<p><b>Data Required for Verification:</b>
<ul>
<li>TKProf or TRCANLZR output from the application that was traced in the previous step, <i>"Data Collection"</i></li>
<li>Measurement of the elapsed time to run the application from a user's point of view</li>
</ul>
</p>
<p><b>Verification Steps:</b></p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Does total elapsed time in TKProf/TRCANLZR account for the application response time that was measured when the application was executed?</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>If so, continue to the next question.</p>
<p>If not:</p>
        <ul>
          <li>
<p>Was the wrong session traced?</p>
          </li>
</ul>
<p><b>Detailed Explanation</b><br>
For example, if the application ran in 410 seconds, look in the "Overall Totals" section at the bottom of the TKProf to see what the total trace elapsed time was (assuming the trace file was started just before the application executed and was stopped just after the execution finished):</p>

<table width="98%" border="1" class="detailTbl">
  <tr>
    <td width="100%" class="detailTraceBlk">
      <div align="left">
        <pre>OVERALL TOTALS FOR ALL NON-RECURSIVE STATEMENTS

call     count       cpu  elapsed  disk    query  current    rows
------- ------  -------- -------- ----- -------- --------  ------
Parse     1165      0.66     2.15     0       45        0       0
Execute   2926      1.23     2.92     0        0        0       0
Fetch     2945    117.03   398.23  5548  1699259       16   39654
------- ------  -------- -------- ----- -------- --------  ------
total     7036    118.92   <b><font color="#FF0000">403.31</font></b>  5548  1699304       16   39654


OVERALL TOTALS FOR ALL RECURSIVE STATEMENTS

call     count       cpu  elapsed  disk    query  current    rows
------- ------  -------- -------- ----- -------- --------  ------
Parse        0      0.00     0.00     0        0        0       0
Execute      0      0.00     0.00     0        0        0       0
Fetch        0      0.00     0.00     0        0        0       0
------- ------  -------- -------- ----- -------- --------  ------
total        0      0.00     <b><font color="#FF0000">0.00</font></b>     0        0        0       0</pre>
        <div align="left">
          <pre>The total database time captured in this trace file was: 
Total Non Recursive Time + Total Recursive Time = 403.31 sec</pre>
        </div>
        </th>
  </tr>
</table>
<p>In this case, 403 seconds out of 410 seconds seen from the users point of view was spent in the database.  Query tuning will indeed help this situation.</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Does the time spent parsing, executing, and fetching account for most of the elapsed time in the trace.</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>If so, continue to the next question.</p>
<p>If not, check client waits (&quot;SQLNet Message from Client&quot;) time between calls</p>
<ul>
   <li>
   <p>Are the client waits occurring in between fetch calls for the same cursor ? </p>
     <ul>
     <li>
     <p>If so, update the problem statement to note this fact and continue with the next question.</p>
     </li>
     <li>
     <p>If most of the time is spent waiting in between calls for different cursors, the bottleneck is in the client tier or network - SQL tuning may not improve the performance of the application.  <br><b>This is no longer a query tuning issue but requires analysis of the client or network.</b></p>
     </li>
     </ul>
   </li>
</ul>
<p><b>Detailed Explanation</b><br>
The goal of query tuning is to reduce the amount of time a query takes to parse, execute, and/or fetch data.  If the trace file shows that these operations occur quickly relative to the total elapsed time, then we may actually need to tune the client or network.</p>
<p>When the database is spending most of the time idle between executions of cursors, we suspect that a client or network is slow.</p>
On the other hand, when most of the query's elapsed time is idle time between fetches of the same cursor, we suspect that the client is not utilizing bulk (array) fetches (we may see similar waits between executions of the same cursor when bulk inserts or updates aren't used).</p>
<p>The result of this is that it would be futile to tune a query that is actually spending most of its time outside of the database; we must know this before we start tuning the query.</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Is the query we expect to tune shown at the top of the TKProf/TRCANLZR report?</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>If so, continue to the next question.</p>
  <p>If not:</p>
<ul>
  <li>
  <p>Was the SQL reported in TKProf/TRCANLZR as the highest elapsed time a PL/SQL procedure?  
  </li>
</ul>
  <blockquote>
  <ul>
    <li>        
      <p>Skip down the file until the first non-PL/SQL query is seen.  If this query is the suspected query, then continue with the next question.</p>
    <li>      
    <p>Otherwise, the problem statement needs to change to either identify the PL/SQL or the first non-PL/SQL query found in the trace file.  After updating the problem statement, continue with the next question.
  </ul>
  </blockquote>
<ul>
  <li>
  <p>Was the wrong session traced?</li>
  <li>
  <p>Was the session traced properly (started trace too late or finished too early)</li>
</ul>
<b>Do not continue until you review your data collection procedures to ensure you are collecting the data properly.</b>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="4">Does the query spend most of its time&nbsp;in the execute/fetch phases (not parse phase)? </li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
  <p>If so, you are done verifying that this query is the one that should be tuned. 
</p>
  <p>If not, there may be a parsing problem that needs to be investigated.  Normal query tuning techniques that alter the execution plan probably won't help.  Update the problem statement to point out that we are aiming to improve the parse time.  Proceed to investigate possible causes for this in this section of the guide:<br>
<br>
Query Tuning > Determine a Cause >Analysis > Choose a Tuning Strategy > Parse Time Reduction Strategy </p>
<p>For example:</p>

<table width="98%" border="1" class="detailTbl">
  <tr>
    <td width="100%" class="detailTraceBlk">      <div align="left">
    <pre>SELECT * FROM  ct_dn dn, ds_attrstore store 
<br>
call     count       cpu  elapsed   disk    query  current     rows
------- ------  -------- -------- ------ -------- --------  -------
Parse      555    100.09   <b><font color="#FF0000">300.83</font></b>      0        0        0        0
Execute    555      0.42     0.78      0        0        0        0
Fetch      555     14.04    <b><font color="#0000FF">85.03</font></b>    513  1448514        0    11724
------- ------  -------- -------- ------ -------- --------  -------
total     1665    114.55   386.65    513  1448514        0    11724</pre>     

    </td>
  </tr>
</table>
<p>The elapsed time spent parsing was 300.83 seconds compared to only 85.03 seconds for fetching. 
This query is having trouble parsing - tuning the query's execution plan will not give the 
greatest performance gain.
</p>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Documentation</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="http://st-doc.us.oracle.com/10/101/server.101/b10752/sqltrace.htm#1052">    Understanding SQL Trace and TKProf</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Special Topics</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=142898.1">    Applications: How to use TKProf and Trace with Applications</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Scripts and Tools</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=224270.1">    Trace Analyzer TRCANLZR - Interpreting Raw SQL Traces with Binds and/or Waits generated by EVENT 10046</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=243755.1">    Implementing and Using the PL/SQL Profiler</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=242374.1">    Tracing PX session with a 10046 event or sql_trace</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Next Step - Determine a Cause">Next Step - Determine a Cause</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">If the analysis above has confirmed the query you want to tune, click "NEXT" to move to the next phase of this process where you will receive guidance to determine a cause for the slow query.    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Would You Like to Stop and Log a Service Request?">Would You Like to Stop and Log a Service Request?</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>We would encourage you to continue until at least the "Determine a Cause", "Data Collection" step, but If you would like to stop at this point and receive assistance from Oracle Support Services, please do the following:</p>
<ul>
<li>In the SR Creation Template, Question "Last Diagnostic Step Completed?", Please copy and paste the following:</li>
<blockquote>
<p>Last Diagnostic Step = Performance_Diagnostic_Guide.QTune.Issue_Identification.Data_Collection</p>
</blockquote>
<li>Enter the problem statement and how the issue has been verified (if performed)</li>
<li>Gather the 10046 trace you collected and prepare to upload it to the service request</li>
<li>Optionally, gather an RDA</li>
<li>Gather other relevant information you may have such as explain plan output</li>
</ul>
<p>The more data you collect ahead of time and upload to Oracle, the fewer round trips will be required for this data and the quicker the problem will be resolved.</p>
<p><a target="detailWindow" href="https://support.oracle.com/epmos/faces/SrCreate">Click here to log your service request</a></p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Determine a Cause &gt;Overview">Query Tuning &gt; Determine a Cause &gt;Overview</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt">
<p>At this point we have verified that an
individual query needs to be tuned; now, we seek to determine the
cause for this query's bad execution plan. To identify the specific cause we will need to
collect data about the execution plan, the runtime statistics, and the
underlying objects referenced in the query.&nbsp; Our approach to
finding the cause  will be:</p>
<ol>
  <li>Check the basics
   <ul>
     <li>Ensure the correct optimizer is used</li>
     <li>Up-to-date statistics are collected for all objects</li>
     <li>Basic parameter settings are appropriate</li>
   </ul>
  </li>
<br> 
 <li>Choose a tuning strategy
   <ul>
    <li><b>Oracle 10g or higher</b>: Use the SQL Tuning Assistant</li>
   <li><b>High Parse Time</b>:  Resolve the high parse time</li>
     <li><b>Bad and Good plan exist</b>:  Compare the "good" and "bad" execution plans to find the cause and apply fix</li>
     <li><b>Only bad plan exists, thorough analysis desired</b>: Analyze the plan to find the cause and apply fix</li>
    <li><b>Only bad plan exists, fast resolution desired</b>: Use triage methods to find a good plan quickly</li>
  </ul>
</li>
<br>
  <li>Follow the steps in the tuning strategy to identify causes and their potential solutions </li>  
<br>
<li>Choose a solution and implement it.</li>
<br>
<li>Verify that the solution solved the problem or more work is needed</li>
</ol>
<p>Its very important to remember that every cause that is identified should be justified by the facts we have collected. If a cause cannot be justified, it should not be identified as a cause (i.e., we are not trying to <i>guess</i> at a solution).</p>
 </td>   </tr> </table> <br><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Determine a Cause &gt;Data Collection">Query Tuning &gt; Determine a Cause &gt;Data Collection</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt">
<p>This phase is very critical to resolving the query
performance problem because accurate data about the query's execution plan and underlying objects are essential for us to determine a cause for the slow performance.</p> </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Gather the Query's Execution Plan  [Mandatory]">Gather the Query's Execution Plan  [Mandatory]</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">An accurate execution plan is key for starting the query tuning process. The process of obtaining an execution plan varies depending on the database version, see the details below.  <br>
<br>
<b>If you are using SQLT (see below) then this step may be omitted.</b>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Prerequisites </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<ul>
<li><b>Create a plan table</b><br>
Use the utlxplan.sql script to create the table as instructed below.<br>
<br>
SQL> @?/rdbms/admin/utlxplan <br>
<br>
Note that the plan table format can change between versions so ensure that you create it using the utlxplan script from the current version.
</li><br>
<li><b>10g and higher: Grant Privileges</b><br>
To use the DBMS_XPLAN.DISPLAY_CURSOR functionality, the calling user must have 
SELECT privilege on V_$SESSION, V_$SQL_PLAN_STATISTICS_ALL, V_$SQL, and V_$SQL_PLAN, otherwise
it will show an appropriate error message.<br>
</li>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Database Version 8.1.7 </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<ol type="a">
<li>  Generate the execution plan:<br>
        SQL> EXPLAIN PLAN FOR <br>
        &lt your query goes here &gt <br>
</li><br>
<li> Display the execution plan:<br>
<br>
<b>Serial Plans</b><br>
To obtain a formatted execution plan for serial plans:<br>
<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> @?/rdbms/admin/utlxpls<br>
        SQL> spool off <br>
<br>
<b>Parallel Plans</b><br>
To obtain a formatted execution plan for parallel plans:<br>
<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> @?/rdbms/admin/utlxplp<br>
        SQL> spool off <br>
 </li>
</ol>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Database Version 9.0.x </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><p>The actual value of bind variables will influence the execution plan that is generated (due to "bind peeking"); its very important to obtain the actual execution plan for the query that is having a performance problem.  Use the appropriate method below.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Preferred Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><p>This approach gathers the actual execution plan (not the EXPLAINed one); one <b>must</b> use one of these methods if the query has bind variables (e.g., :b1 or :custID ) in order to get accurate execution plans.</p>
<ul>

<li>For a complete example on how to set bind values and statistics level to run a query, see the section below entitled, "Construct a Test Script"</li>. 
<li>If the SQL has been executed, and you know the hash value of the SQL, you can pull the plan 
from V$SQL_PLAN_STATISTICS or V$SQL_PLAN (if statistics_level = typical) as described in <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=260942.1">Note 260942.1</a> . </li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Alternate Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><p>Use this approach if you are unable to capture the plan using the preferred approach.  This approach may be used to collect plans reliably from queries that don't have bind variables.</p>
<ol type="a">
<li>  Generate the execution plan:<br>
        SQL> EXPLAIN PLAN FOR <br>
        &lt your query goes here &gt <br>
</li><br>
<li> Display the execution plan:<br>
<br>
<b>Serial Plans</b><br>
To obtain a formatted execution plan for serial plans:<br>
<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> @?/rdbms/admin/utlxpls<br>
        SQL> spool off <br>
<br>
<b>Parallel Plans</b><br>
To obtain a formatted execution plan for parallel plans:<br>
<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> @?/rdbms/admin/utlxplp<br>
        SQL> spool off <br>
 </li>
</ol>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Database Version 9.2.x </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><p>The actual value of bind variables will influence the execution plan that is generated (due to "bind peeking"); its very important to obtain the actual execution plan for the query that is having a performance problem.  Use the appropriate method below.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Preferred Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><p>This approach gathers the actual execution plan (not the EXPLAINed one) and will provide extremely useful information on actual and estimated row counts.<br>
<br>
One <b>must</b> use one of these methods if the query has bind variables (e.g., :b1 or :custID ) in order to get accurate execution plans.</p>
<ul>
<li>If possible, execute the query while the parameter, "STATISTICS_LEVEL" is set to ALL in a session.  <b>Warning: </b>Do not set this for the entire instance!<br>
For a complete example on how to set bind values and statistics level to run a query, see the section below entitled, "Construct a Test Script"</li>. 
<li>If the SQL has been executed, and you know the hash value of the SQL, you can pull the plan 
from V$SQL_PLAN_STATISTICS or V$SQL_PLAN (if statistics_level = typical) as described in <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=260942.1">Note 260942.1</a> . . </li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Alternate Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">Use this approach if you are unable to capture the plan using the preferred approach.  This approach may be used to collect plans reliably from queries that don't have bind variables.<br>
<ol type="a">
<li>  Generate the execution plan:<br>
        SQL> EXPLAIN PLAN FOR <br>
        &lt your query goes here &gt <br>
</li><br>
<li>  Display the execution plan:<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <i>myfile.lst</i><br>
        SQL> alter session set cursor_sharing=EXACT;<br>
        SQL> select plan_table_output from table(dbms_xplan.display('PLAN_TABLE',null,'ALL'));<br>
        SQL> spool off <br>

 </li>

</ol>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Database Version 10.1.x </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><p>The actual value of bind variables will influence the execution plan that is generated (due to "bind peeking"); its very important to obtain the actual execution plan for the query that is having a performance problem.  Use the appropriate method below.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Preferred Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><p>This approach uses DBMS_XPLAN to gather the actual execution plan (not the EXPLAINed one) and will provide extremely useful information on actual and estimated row counts.<br>
<br>
One <b>must</b> use one of these methods if the query has bind variables (e.g., :b1 or :custID ) in order to get accurate execution plans.</p>
<ul>

<li>If possible, execute the query while  the parameter, "STATISTICS_LEVEL = ALL"  is set for your session.<br>
 <b>Warning: </b>Do not set this for the entire instance!<br>
<br>
e.g:<br>
<ol type="a">
        <li>Execute the Query and gather plan statistics:<br>
SQL> alter session set statistics_level = all;<br>       
SQL> select  col1, col2 etc.....</li><br>
 <li>
        Display the execution plan with plan statistics (for last executed cursor):<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from TABLE(dbms_xplan.display_cursor('NULL, NULL , 'RUNSTATS_LAST'))<br>
</ol>
<br>
<li>To get the plan of the last executed SQL issue the following:<br>
<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from table(dbms_xplan.display_cursor(null,null, 'ALL'));<br>
</li><br>

<li>If the SQL has been executed, and you know the SQL_ID value of the SQL, you can pull the plan from from the library cache as shown:<br>
<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from TABLE(dbms_xplan.display_cursor('&SQL_ID', &CHILD,'ALL'));<br>
<br>
If the cursor happened to be executed when plan statistics were gathered, then use "RUNSTATS_LAST" instead of just "ALL".<br>
<br>
<i>sql_id:</i><br>
   specifies the sql_id value for a specific SQL statement, as shown in V$SQL.SQL_ID,  V$SESSION.SQL_ID, or V$SESSION.PREV_SQL_ID. If no sql_id is specified, the  last executed statement of the current session is shown. 
<br>
<i>cursor_child_no:</i><br>
   specifies the child number for a specific sql cursor, as shown in V$SQL.CHILD_NUMBER  or in V$SESSION.SQL_CHILD_NUMBER, V$SESSION.PREV_CHILD_NUMBER. <br>
<br>
</li>
</li>
<li>For a complete example on how to set bind values and statistics level to run a query, see the section below entitled, "Construct a Test Script"</li>. 	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Alternate Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
</ul>
<b>Alternate Approach</b><br>
Use this approach if you are unable to capture the plan using the preferred approach.  This approach may be used to collect plans reliably from queries that don't have bind variables.<br>
<ol type="a">
<li>  Generate the execution plan:<br>
        SQL> EXPLAIN PLAN FOR <br>
        &lt your query goes here &gt <br>
</li><br>
<li>  Display the execution plan:<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> alter session set cursor_sharing=EXACT;<br>
        SQL> select plan_table_output from table(dbms_xplan.display('PLAN_TABLE',null,'ALL'));<br>
        SQL> spool off <br>

 </li>
</ol>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Database Version 10.2.x </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>The actual value of bind variables will influence the execution plan that is generated (due to "bind peeking"); its very important to obtain the actual execution plan for the query that is having a performance problem.  Use the appropriate method below.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Preferred Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><p>This approach uses DBMS_XPLAN to gather the actual execution plan (not the EXPLAINed one) and will provide extremely useful information on actual and estimated row counts.<br>
<br>
One <b>must</b> use one of these methods if the query has bind variables (e.g., :b1 or :custID ) in order to get accurate execution plans.</p>
<ul>

<li>If possible, execute the query with the hint, " gather_plan_statistics" to capture runtime statistics.  Or, use  the parameter, "STATISTICS_LEVEL = ALL"  for your session.<br>
 <b>Warning: </b>Do not set this for the entire instance!<br>
<br>
e.g:<br>
<ol type="a">
        <li>Execute the Query and gather plan statistics:<br>
        SQL> select <b>/*+ gather_plan_statistics */</b> col1, col2 etc.....</li><br>
 <li>
        Display the execution plan with plan statistics (for last executed cursor):<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from TABLE(dbms_xplan.display_cursor('NULL, NULL , 'ALLSTATS LAST'))<br>
</ol>
<br>
<li>To get the plan of the last executed SQL issue the following:<br>
<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from table(dbms_xplan.display_cursor(null,null, 'ALL'));<br>
</li><br>

<li>If the SQL has been executed, and you know the SQL_ID value of the SQL, you can pull the plan from from the library cache as shown:<br>
<br>
        SQL> set linesize 150<br>
        SQL> set pagesize 2000<br>
        SQL> select * from TABLE(dbms_xplan.display_cursor('&SQL_ID', &CHILD,'ALL'));<br>
<br>
If the cursor happened to be executed when plan statistics were gathered, then use "ALL ALLSTATS" instead of just "ALL".<br>
<br>
<i>sql_id:</i><br>
   specifies the sql_id value for a specific SQL statement, as shown in V$SQL.SQL_ID,  V$SESSION.SQL_ID, or V$SESSION.PREV_SQL_ID. If no sql_id is specified, the  last executed statement of the current session is shown. 
<br>
<i>cursor_child_no:</i><br>
   specifies the child number for a specific sql cursor, as shown in V$SQL.CHILD_NUMBER  or in V$SESSION.SQL_CHILD_NUMBER, V$SESSION.PREV_CHILD_NUMBER. <br>
<br>
</li>
<li>For a complete example on how to set bind values and statistics level to run a query, see the section below entitled, "Construct a Test Script"</li>. 
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Alternate Approach</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">Use this approach if you are unable to capture the plan using the preferred approach.  This approach may be used to collect plans reliably from queries that don't have bind variables.<br>
<ol type="a">
<li>  Generate the execution plan:<br>
        SQL> EXPLAIN PLAN FOR <br>
        &lt your query goes here &gt <br>
</li><br>
<li>  Display the execution plan:<br>
        SQL> set lines 130<br>
        SQL> set head off<br>
        SQL> spool <spool file><br>
        SQL> alter session set cursor_sharing=EXACT;<br>
        SQL> select plan_table_output from table(dbms_xplan.display('PLAN_TABLE',null,'ALL'));<br>
        SQL> spool off <br>

 </li>
</ol>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Important: Obtain Plans for Good and Bad Performing Queries </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">It is extremely helpful to collect as much of the data in this section as possible when the query performs poorly and when it performs well.  For example, if the database is migrating from 9.2 to 10g and both systems are available, obtain the execution plans from both systems to compare a good plan to a bad plan.</p>
<p>If the old system is no longer available, you may need to do the following to get the old, good plan:</p>
<ul>
<li>use the parameter <i>optimizer_features_enable = <version> </i> to revert the optimizer's behavior to the older one</li>
<li>Import the old statistics or set them to match the other system</li>
<li>Ensure the optimizer mode is set to the old system (e.g., if migrating from the rule based optimizer, then set: <i> optimizer_mode = rule </i>
</ul>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Reference</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=235530.1">    Recommended Methods for Obtaining a Formatted Explain Plan</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14258/d_xplan.htm#i996786">    10.2 Docs: DBMS_XPLAN</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B14117_01/appdev.101/b10802/d_xplan.htm#996787">    10.1 Docs: DBMS_XPLAN</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B10501_01/appdev.920/a96612/d_xplan2.htm#1001444">    9.2 Docs: DBMS_XPLAN</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Scripts and Tools</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=260942.1">    Script to Obtain an Execution Plan from V$SQL_PLAN</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Gather Comprehensive Information about the Query (Mandatory)">Gather Comprehensive Information about the Query (Mandatory)</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>SQLT (SQLTXPLAIN) gathers comprehensive data about a particular query. This data can be used to&nbsp;examine a query's underlying objects, view the query's
execution plan and dig deeper into the causes for the optimizer's execution plan decisions.</p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Install SQLT and use the SQLTXecute, SQLTXTract, or SQLTxplain options</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>SQLT requires a schema in the database where the query to be tuned is executed.  This schema will be used for the tables used by SQLT.  The installation needs to be done only once.  The SQLXecute option is recommended because it gathers a more complete set of diagnostics.  SQLTXtract can be used when a statement is not easily placed into a file and/or it has already executed and is in the library cache.  SQLTXplain is more limited and is therefore the last resort.</p>
<p>For detailed installation instructions, please see the "instructions.txt" file in the distribution ZIP file for SQLT (click on the reference provided to download).  In summary, this is how to install it:</p>
<p>Uncompress sqlt.zip file into a dedicated directory in the server, and run SQL*Plus from that directory connecting as a user with SYSDBA privilege.</p>
<p>e.g.  Start SQL*Plus, then:<br>
        SQL> connect / as sysdba<br>
        SQL> @sqcreate.sql</p>
<p><b>Note:</b><p>
<ul>
  <li><p>If this query contains bind values and the database is at version 9.0.x or higher, its possible that the plan collected by SQLTXplain is NOT a typical one  due to <i>bind peeking.</i> This is one of the reasons we recommend using SQLTXecute or SQLTXtract; however if there is no other choice, SQLXplain still gathers valuable diagnostics and should be used. </li>
</ul>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Run SQLT against the query that needs to be tuned</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
  <li>This will collect information about each table or view in the query, including statistics/histograms gathered, columns, and view dependencies</li>
  <li>The execution plan and predicate information will be gathered</li>
  <li>If SQLTXecute is used, additional runtime statistics will be gathered including actual row counts per plan step.</li>
<li>AWR SQL history</li>
  <li>A CBO (event 10053) trace will be gathered</li>
  <li>The final output will be produced as an HTML file</li>
  <li><p>Example usage:</p>
      <p><b>sqlplus &lt;usr&gt;/&lt;pwd&gt;<br>start sqltxplain.sql &lt;name of text file containing one SQL statement to be analyzed&gt;;</b></p>
      <p>e.g.,</p>
      <p><b>sqlplus apps/apps;</b><br><b>start sqltxplain.sql sql5.txt;</b></p>
  </li>
</ul>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Gather the resulting trace file</li></ol> <DIV ID="H2SH0L3" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr> 	  <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p><b>Is this step optional?</b><br>
If you do not use SQLT you will be missing a lot of detail about the tables in the query and the 10053 trace.  The <i>analysis</i> step that follows will refer to this data often; by using SQLT, you will gather the data upfront rather than piecemeal (with some inital, minimal effort installing the SQLT tables).</p>
    </td>  </tr>  <tr>  <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Scripts and Tools</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=215187.1">    Downloading and Installing SQLT</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Gather Historical Information about the Query">Gather Historical Information about the Query</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>SPREPSQL.SQL and AWRSQLRPT.SQL gather
historical costs, elapsed times, statistics, and execution plans about
a specific query. They can help identify when an execution plan changed
and what a better performing execution plan looked like.</p>
<p>NOTE 1: You may skip this entire step if you used SQLT since SQLT gathers this data for you.</p>
<p>NOTE 2: A prerequisite to using
SPREPSQL.SQL is to ensure that Statspack snapshots are being collected
at level 6 or greater (AWR will automatically collect the data).  See the reference document on the right.</p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Find the "hash value" or &quot;SQL ID&quot; for the query</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
  <li><p>One way to find the hash value or SQL ID is to look for the query in the Statspack or AWR output under one of the &quot;Top SQL&quot; sections.</li>
  <li><p>Another way is to look in the raw  10046 trace file collected from a session during the &quot;issue verification&quot; phase, find the SQL statement and look for the line associated with that statement containing &quot;hv=&quot;. For example,</li>
</ul>
<table width="100%" class="detailTbl" border="1">
  <tr>
  <td width="100%">
      <p class="detailTraceBlk">PARSING IN CURSOR #2 len=86 dep=0 uid=54 oct=3 lid=54 tim=1010213476218 <b>hv=710622186</b> ad='9d3ad468'</p>
      <p class="detailTraceBlk">select TO_CHAR(hiredate,:dfmt)</p>
      <p class="detailTraceBlk">from emp</p>
      <p class="detailTraceBlk">where sal &gt; :salary</p>
      <p class="detailTraceBlk">and deptno = :b3</p>
      <p class="detailTraceBlk">END OF STMT</p>
  </td>
  </tr>
</table>
<br>
<blockquote>
<p>The hash value is found in the listing above is: <b>710622186</b>.</p>
</blockquote>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Run sqrepsql.sql or awrsqlrpt.sql to look for a point in time when the query might have  performed well</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
  <li><p>When prompted for a begin and end snapshot time, enter a time when you knew the query performed poorly; it may also help to collect another report when you knew the query performed well.</p></li>
  <li><p>For example, using sprepsql.sql :</p></li>
</ul>
<table border="1" width="100%" class="detailTbl">
  <tr>
    <td class="detailTraceBlk" width="100%">  	
      <p><br>
        sqlplus perfstat/pwd;<br>
        @?/rdbms/admin/sprepsql.sql</p>
      <p>Completed Snapshots Snap Snap<br>
        Instance&nbsp;&nbsp;DB Name&nbsp;&nbsp; Id&nbsp;&nbsp;&nbsp; Snap Started&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Level Comment<br>
        --------- --------- ----- ----------------- ----- --------------<br>
        DB9iR2&nbsp;&nbsp;&nbsp; DB9IR2&nbsp;&nbsp;&nbsp; 125&nbsp;&nbsp; 18 Aug 2005 21:49&nbsp;&nbsp;&nbsp;&nbsp; 5<br>
        . . . <br>
        150 03 Apr 2006 16:51 7<br>
        151 03 Apr 2006 16:51 7</p>
      <p>Specify the Begin and End Snapshot Ids<br>
        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
        Enter value for begin_snap: 150<br>
        Begin Snapshot Id specified: 150</p>
      <p>Enter value for end_snap: 151<br>
        End Snapshot Id specified: 151<br>
      </p>
      <p>Specify the Hash Value<br>
        ~~~~~~~~~~~~~~~~~~~~~~<br>
        Enter value for hash_value: <b><font color="#FF0000">710622186</font></b><br>
        Hash Value specified is: <font color="#FF0000"><b>710622186</b></font></p>
      <p>Specify the Report Name<br>
        ~~~~~~~~~~~~~~~~~~~~~~~<br>
        The default report file name is sp_150_151_710622186. To use this name,<br>
        press &lt;return&gt; to continue, otherwise enter an alternative.<br>
    Enter value for report_name:<br>
&nbsp;</p>
   </td>
  </tr>
</table>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Gather the resulting trace file</li></ol> <DIV ID="H3SH0L3" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr> 	  <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p><b>Is this step optional?</b><br>
It is optional, but there is a huge potential benefit if you find an older, better execution plan stored in the repository.  With the better plan, you can compare it to the current bad plan and focus on what has changed and how to fix it.</p>
    </td>  </tr>  <tr>  <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">SCRIPTS/TOOLS</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=209197.1">    Using Statspack to Report Execution Plans</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Construct a Test Script">Construct a Test Script</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>In this step a test script will be created that can be used to run the query with any required bind values and diagnostic events turned on and off. The test script will be valuable as a
benchmark while we make changes to the query.  At this point in
the process, we just want to create the script and make sure it
represents the same performance behavior and execution plan as the
original query from the application.  Please note that the test
script is not the same thing as a <i>test
case</i> that is submitted to Oracle.  We are NOT trying to
reproduce this at Oracle; we want to run the test script on the actual system where the performance problem is 
occurring.</p> 
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Extract a test case from the  extended SQL trace  collected in the Issue Verification phase (where the query was verified to be the biggest bottleneck).</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
  <li>
  <p>Look for the query of interest, pay close attention to the cursor number</li>
  <li>
  <p>Find the bind values for your query, for example:</li>
</ul>
<table border="1" cellspacing="1"  bgcolor="#EEF3F7" width="100%" id="AutoNumber32" class="detailTbl">
  <tr>
    <td class="detailTraceBlk" width="100%"><br>
    PARSING IN <font color="#FF0000">CURSOR #1</font> len=90 dep=0 uid=54 oct=3 lid=54 tim=1004080714263 hv=710622186 ad='9f040c28'<br>
        <font color="#FF0000">select TO_CHAR(hiredate,</font><font color="#0000FF">:dfmt</font>)
    <b><font color="#CC66FF">&lt;-------------- bind variable in position 0</span></font></b><br>
        <font color="#FF0000">from emp</font><br>
        <font color="#FF0000">where sal &gt;</font><font color="#0000FF">:salary</font>
    <b><font color="#CC66FF">&lt;-------------------------- bind variable in position 1</font></b><br>
        <font color="#FF0000">and deptno =</font> <font color="#0000FF">:b3</font>
    <b><font color="#CC66FF">&lt;---------------------------- bind variable in position 2</font></b><br>
      END OF STMT<br>
      PARSE #1:c=10000,e=2506,p=0,cr=0,cu=0,mis=1,r=0,dep=0,og=1,tim=1004080714232<br>
      <font color="#FF0000">BINDS #1:</font> <b><font color="#CC66FF">&lt;------------------------------------ IMPORTANT!, Must be the same # as the cursor above(#1)</font></b><br>
      kkscoacd<br>
      <font color="#0000FF">Bind#0</font> <b><font color="#CC66FF">&lt;-------------------------------------- section for bind position 0</font></b><br>
oacdty=01 mxl=32(20) mxlc=00 mal=00 scl=00 pre=00<br>
oacflg=03 fl2=1000000 frm=01 csi=31 siz=80 off=0<br>
kxsbbbfp=ffffffff7b12bef0 bln=32 avl=10 flg=05<br>
    <font color="#008000">value=&quot;mm-dd-yyyy&quot;</font> <b>
    <font color="#CC66FF">&lt;-------------------------- bind value for &quot;:dfmt&quot; variable</font></b><br>
    <font color="#0000FF">Bind#1</font> <b><font color="#CC66FF">&lt;-------------------------------------- section for bind position 1</font></b><br>
oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00<br>
oacflg=03 fl2=1000000 frm=00 csi=00 siz=0 off=32<br>
kxsbbbfp=ffffffff7b12bf10 bln=22 avl=02 flg=01<br>
    <font color="#008000">value=10</font> <b><font color="#CC66FF">&lt;------------------------------------ bind value for &quot;:salary&quot; variable</font></b><br>
    <font color="#0000FF">Bind#2</font> <b><font color="#CC66FF">&lt;-------------------------------------- section for bind position 2</font></b><br>
oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00<br>
oacflg=03 fl2=1000000 frm=00 csi=00 siz=0 off=56<br>
kxsbbbfp=ffffffff7b12bf28 bln=22 avl=02 flg=01<br>
    <font color="#008000">value=20</font> <b><font color="#CC66FF">&lt;------------------------------------ bind value for &quot;:b3&quot; variable</font></b><br>
    <br>
  </td>
  </tr>
</table>
<ul>
  <li>
  <p>Determine the bind variable types and values. 
  Referring to the example above, we can associate the bind variables, definitions, and values as such: </li>
</ul>
<table border="1" cellspacing="1"  bgcolor="#EEF3F7" width="592" id="AutoNumber42" height="107">
  <tr>
    <td class="detailTblHdrSm" width="49" height="56">
    <p align="center">Bind Variable Name in  Query </td>
    <td class="detailTblHdrSm" width="61" height="56">
    <p align="center">Bind ID in the Trace file </td>
    <td class="detailTblHdrSm" width="174" height="56">
    <p align="center">
    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements001.htm#i54330">Bind datatype info in the trace
    </a></td>
    <td class="detailTblHdrSm" width="105" height="56">
    <p align="center">Datatype</td>
    <td class="detailTblHdrSm" width="80" height="56">
    <p align="center">Bind value </td>
    <td class="detailTblHdrSm" width="90" height="56">
    <p align="center">Bind variable declaration in SQLPlus </td>
  </tr>
  <tr>
    <td class="detailTraceBlk" width="49" height="11">:dfmt</td>
    <td class="detailTraceBlk" width="61" height="11">Bind #0 </td>
    <td class="detailTraceBlk" width="174" height="11"><font color="#0000FF">oacdty=01</font> mxl=<b><font color="#FF0000">32</font></b>(20) --&gt; 
    <font color="#0000FF">varchar2</font>, length of 32</td>
    <td class="detailTraceBlk" width="105" height="11"><font color="#0000FF">varchar2</font>(<b><font color="#FF0000">32</font></b>)</td>
    <td class="detailTraceBlk" width="80" height="11">mm-dd-yyyy</td>
    <td class="detailTraceBlk" width="90" height="11">variable dfmt
    <font color="#0000FF">varchar2</font>(<b><font color="#FF0000">32</font></b>)</td>
  </tr>
  <tr>
    <td class="detailTraceBlk" width="49" height="10">:salary</td>
    <td class="detailTraceBlk" width="61" height="10">Bind #1 </td>
    <td class="detailTraceBlk" width="174" height="10"><font color="#0000FF">oacdty=02</font>  mxl=22(22) --&gt; 
    <font color="#0000FF">number</font>, length not important </td>
    <td class="detailTraceBlk" width="105" height="10"><font color="#0000FF">number</font></td>
    <td class="detailTraceBlk" width="80" height="10">10</td>
    <td class="detailTraceBlk" width="90" height="10">variable salary
    <font color="#0000FF">number</font></td>
  </tr>
  <tr>
    <td class="detailTraceBlk" width="49" height="10">:b3</td>
    <td class="detailTraceBlk" width="61" height="10">Bind #2 </td>
    <td class="detailTraceBlk" width="174" height="10"><font color="#0000FF">oacdty=02</font>  mxl=22(22) --&gt; 
    <font color="#0000FF">number</font>, length not important </td>
    <td class="detailTraceBlk" width="105" height="10"><font color="#0000FF">number</font></td>
    <td class="detailTraceBlk" width="80" height="10">20</td>
    <td class="detailTraceBlk" width="90" height="10">variable b3
    <font color="#0000FF">number</font></td>
  </tr>
</table>
<ul>
  <li>
  <p>Create a test script that incorporates the query with the bind values, for example: </li>
</ul>
<table border="1" cellspacing="1"  bgcolor="#EEF3F7" width="100%" id="AutoNumber52" class="detailTbl">
  <tr>
    <td class="detailTraceBlk" width="100%">
      <p><br>
      set time on<br>
        set timing on</p>
      <p>spool test_script <br>
              </p>
      <p>-- define the variables in SQLPlus <br>
          <font color="#008000">variable dfmt varchar2(32)<br>
          variable salary number <br>
          variable b3 number</font></p>
      <p>-- Set the bind values<br>
        <font color="#0000FF">begin :dfmt := 'mm-dd-yyyy'; :salary := 10; :b3 := 20;<br>
          end; <br>
        /</font></p>
      <p>-- Set statistics level to high<br>
        alter session set statistics_level = all;  </p>
      <p>-- Turn on the trace<br>
          alter session set events '10046 trace name context forever, level 12';<br>
          <br>

          -- Run the query<br>
          <font color="#FF0000">select TO_CHAR(hiredate,:dfmt)<br>
    from emp <br>
    where sal &gt; :salary <br>
    and deptno = :b3;</font></p>
      <p>select 'end of script' from dual;</p>
      <p>-- Turn off the trace<br>
        alter session set events '10046 trace name context off';</p>
      <p>-- 10g: uncomment the following to obtain an execution plan </p>
      <p>-- select * from table(dbms_xplan.display_cursor(NULL,NULL,'RUNSTATS_LAST'));</p>
      <p>-- Reduce statistics level<br>
          alter session set statistics_level = typical; </p>
      <p>spool off<br>
&nbsp;</p>
    </td>
  </tr>
</table>
<p>Gather the resulting spool file called &quot;test_script.lst&quot;.</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Run the test script and gather the extended SQL trace that was produced in the user_dump_dest directory.</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>For example if the test script similar to the one above was named &quot;test.sql&quot;, do the following to run it and gather the resulting trace:</p>
<table border="1" cellspacing="1"  bgcolor="#EEF3F7" width="100%" id="AutoNumber32" class="detailTbl">
    <tr>
      <td class="detailTraceBlk" width="100%">
        <br>sqlplus scott/tiger @test.sql<p>SQL&gt; show parameter user_dump_dest</p>
        <p>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TYPE&nbsp;&nbsp;&nbsp; VALUE<br>
        --------------- ------- ----------------------------------------------------<br>
  user_dump_dest&nbsp; string&nbsp;&nbsp;<font color="#FF0000">/u01/app/oracle/product/DB10gR2/admin/DB10gR2/udump<br>
        </font><br>
        </p>
     </td>
    </tr>
  </table>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Obtain a TKProf report of the extended SQL trace that was produced</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
<li><p>Generate a TKProf report and sort the SQL 
statements in order of most elapsed time using the following command:</p></li>
</ul>
<blockquote>
<p class="detailTraceBlk"><b>tkprof &lt;trace file name&gt; &lt;output file name&gt; <font color="#0000ff">sort=fchela,exeela,prsela</font></b></p>
</blockquote>
<p>Compare the execution plan and other execution statistics
(physical reads, logical reads, rows returned <i><b>per execution </b></i>) 
of the test script query to the one collected in the Issue Verification phase. If 
they are comparable, then the test script is valid. If not, its possible
that the application had set session-level parameters that changed the
execution plan. Additional tips and techniques for constructing a
good test script are found in this
<a target="detailWindow" href="http://www.oracle.com">document</a>.</p>
	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr> 	  <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p><b>Is this step optional?</b><br>
It is optional, but the time to build this test script is usually very short and provides you with a test harness to test the query accurately and repeatedly.  Typically, query tuning issues are resolved on the whole much faster by investing in this step.</p>
    </td>  </tr>  <tr>  <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Next Step - Analyze">Next Step - Analyze</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><p>In the following step, you will receive guidance on interpreting the data you collected to determine the cause for the performance problem; click "NEXT" to continue.</p>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Determine a Cause &gt;Analysis">Query Tuning &gt; Determine a Cause &gt;Analysis</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt">
<p>The data collected in the previous step will be analyzed in this step to determine a cause.  It is very important to ensure the data has been collected as completely as possible and for good as well as bad plans.</p>
<p>This process always starts by sanity checking the statistics, optimizer mode, and important initialization parameters and follows with the choice of a tuning strategy that matches your problem and objectives.</p>
 </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Always Check: Optimizer Mode, Statistics, and Parameters">Always Check: Optimizer Mode, Statistics, and Parameters</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><p>Ensure that the CBO is used, statistics have been gathered properly, and initialization parameters are reasonably set before looking into the details of the execution plan and how to improve it.</p>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Ensure the cost based optimizer is used </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">The use of the CBO is essential for this tuning effort since the RBO is no longer supported.<br>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Data Required For Analysis</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><ul>
<li>Source: Execution plan (collected in "Data Collection", part A)<br>
8.1.7 and 9.0.1: Look at the query's "cost", if its is NULL then the RBO was used.<br>
9.2.x and higher: Look for the text, "Note: rule based optimization" after the plan is displayed to see if the RBO was used.<br>
</li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Common Observations and Causes</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">If the collected data shows the RBO is used, see the table below to find common causes and reasons related to the choice of optimizer:	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Use of the rule based optimizer (RBO)</b></i></p>    <br><p class="detailTblTxt3">The RBO is being deprecated in favor of the cost based optimizer (CBO).  No specific tuning advice on the RBO will be given in this document.  See the references in the sidebar for additional information.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">Review the execution plan (collected in "Data Collection", part A)<br>
8.1.7 and 9.0.1: Look for the cost column to have NULL values<br>
9.2.x and higher: Look for the text, "Note: rule based optimization" after the plan is displayed.
</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No statistics gathered (pre10g)</i></b></p>    <br><p class="detailTblTxt3">Oracle will default to the RBO when none of the objects in the query have any statistics.  In 10g and to some extent in 9.2, Oracle will use the CBO with dynamic sampling and avoid the RBO.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
The execution plan will not display estimated cardinality or cost if RBO is used.  In general, RBO will be used in the following cases (see references for more detail):<br><br>
No "exotic" (post 8.x) features like partitioning, IOTs, parallelism, etc AND:
<ul class="detailTblTxt3">
<li>Pre 9.2.x: <br>
-  OPTIMIZER_MODE = CHOOSE.  Confirm by looking at TKProf, "Optimizer Mode: CHOOSE" for the query<br>
-  and, no statistics on ANY table.  Confirm this by looking at each table in SQLTXPLAIN and checking for a NULL value in the "LAST ANALYZED" column</li>
<li>9.2x + : <br>
-  OPTIMIZER_MODE = CHOOSE or RULE<br>
-  and, dynamic sampling disabled (set to level 0 via hint or parameter)<br>
-  and, no statistics on ANY table.  Confirm this by looking at each table in SQLTXPLAIN and checking for a NULL value in the "LAST ANALYZED" column</li>
</ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameter "optimizer mode" set to RULE</i></b></p>    <br><p class="detailTblTxt3">The optimizer_mode parameter will cause Oracle to use the RBO even if statistics are gathered on some or all objects in the query.  If a feature such as parallel execution or partitioning is used, then the query will switch over to the CBO.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
The execution plan will not display estimated cardinality or cost if RBO is used.  In general, RBO will be used in the following cases (see references for more detail):<br><br>
No "exotic" (post 8.x) features like partitioning, IOTs, parallelism, etc AND:
<ul class="detailTblTxt3">
<li>Pre 9.2.x: optimizer_mode = choose and no statistics on ANY table</li>
<li>9.2x + : optimizer_mode = choose or rule and dynamic sampling disabled</li>
</ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Migrate from the RBO to the CBO</i></b></p>    <br><p class="detailTblTxt3">The RBO is no longer supported and many features since 8.0 do not use it.  The longer term strategy for Oracle installations is to use the CBO.  This will ensure the highest level of support and the most efficient plans when using new features.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Migrating to the CBO can be a high or low effort task depending on the amount of risk you are willing to tolerate.  The lowest effort involves simply changing the "OPTIMIZER_MODE" initialization parameter and gathering statistics on objects, but the less risky approaches take more effort to ensure execution plans don't regress.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Risk depends on the effort placed in localizing the migration (to a single query, session, or application at a time).  The highest risk for performance regressions involve using the init.ora "OPTIMIZER_MODE" parameter.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The most cautious approach involves adding a hint to the query that is performing poorly.  The hint can be "FIRST_ROWS_*" or "ALL_ROWS" depending on the expected number of rows.  If the query can't be changed, then it may be possible to limit the change to CBO to just a certain session using a LOGON trigger.<br>
<br>
See the following links for more detail:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#i12916">Moving from RBO to the Query Optimizer</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://www.oracle.com/technology/products/manageability/database/pdf/ow05/PS_S997_273997_106-1_FIN_v2.pdf">Optimizing the Optimizer: Essential SQL Tuning Tips and Techniques, see the section "Avoiding Plan Regressions after Database Upgrades"</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Ensure fresh and accurate table / index statistics exist </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">Accurate statistics on all  tables and indexes in the query are essential for the CBO to produce good execution plans.<br>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Data Required For Analysis</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The data listed here is required for analyzing the causes in the table below.
<ul>
<li>Source: Execution plan (gathered in "Data Collection", part A)<br>
<ul>
<li>Actual number of rows returned by the query or an execution plan that shows actual and estimated rows per plan step.</li>
<li>Estimated number of rows returned by the query ("Estim Card" or similar)  from the execution plan</li>
<li>Determine if there is a large discrepancy between the actual and estimated rows</li><br>
</ul>
<li>Source: SQLTXPLAIN report, table statistics<br>
<ul>
<li>Examine the "Tables" and "Index" sections, column "Last Analyzed" to determine if the tables and all indexes were analyzed. </li>
<li>Compare the columns "Num Rows" and "Sample Size" in the "Tables" section to see how much of the table was sampled for statistics collection.</li>
<li>Examine the "Tables" and "Index" sections, column "User Stats" to determine if stats were entered directly rather than analyzed.</li>
<li>Examine the "Column Statistics", "Num Buckets", if this is 1, then no histograms were gathered. </li>
</ul>
</li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Common Observations and Causes</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The following table shows common problems and causes related to object statistics:	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>The CBO's estimate of the number of rows returned differs significantly from the actual number of rows returned</b></i></p>    <br><p class="detailTblTxt3">Accurate statistics for tables and indexes is the most important factor for ensuring the CBO generates good execution plans.  When statistics are missing (and the CBO has to guess) or insufficient, the CBO's estimate for the number of rows returned from each table and the query as a whole can be wrong.  If this happens, the CBO may chose a poor execution plan because it based its decision on incorrect estimates.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
  <li>Using the SQLTXPLAIN report, look at the estimated rows returned by the query("Estim Card") for the top-most line of the execution plan</li>
  <li>Compare the estimated rows to the actual rows returned by the query.  If they differ by an order of magnitude or more, the CBO may be affected by inadequate statistics.</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Missing or inadequate statistics</i></b></p>    <br><p class="detailTblTxt3">
<ul class="detailTblTxt3">
<li>Missing Statistics</li> 
     <ul class="detailTblTxt3">
          <li>Statistics were never gathered for tables in the query</li>
          <li>Gathering was not &quot;cascaded&quot; down to indexes</li>
     </ul>
 <li>Inadequate sample size</li>
     <ul class="detailTblTxt3">
          <li>The sample size was not sufficient to allow the CBO to compute selectivity values accurately</li>
     </ul>
      <ul class="detailTblTxt3">
          <li>Histograms not collected on columns involved in the query predicate that have skewed values</li>
      </ul>
</ul></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
One or more of the following may justify the need for better statistics collection:
<ul class="detailTblTxt3">
<li>Missing table statistics:  DBA_TABLES.LAST_ANALYZED is NULL </li>
<li>Missing index statistics:  For indexes belonging to each table: DBA_INDEX.LAST_ANALYZED is NULL </li>
<li>Inadequate sample size for tables: DBA_TABLES.SAMPLE_SIZE / # of rows in the table < 5%</li>
<li>Inadequate sample size for indexes: DBA_INDEXES.SAMPLE_SIZE / # of rows in the table < 30%</li>
<li>Histograms not collected: for each table in the query, no rows in DBA_TAB_HISTOGRAMS for the columns having skewed data</li>
<li>Inadequate number of histograms buckets: For each table in the query, less than 255 rows in DBA_TAB_HISTOGRAMS for the columns having skewed data</li>
</ul>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Unrealistic Statistics</b></i></p>    <br><p class="detailTblTxt3">Values in DBA_TABLES do not match what is known about the table.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">In ALL_TABLES, the value of NUM_ROWS is actually much larger or smaller than SELECT COUNT(*) FROM table_name.</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Unreasonable table stat values were manually set</i></b></p>    <br><p class="detailTblTxt3">Someone either miscalculated or misused DBMS_STATS.SET_STATISTICS</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Check the SQLTXPLAIN report, "Table" or "Index" columns, look for the column "User Stats".  If this is YES", then the stats were entered directly by users through the DBMS_STATS.SET_*_STATS procedure.</li>
<br>
<li>Outrageous statistics values are usually associated with very inaccurate estimated cardinality for the query.  You can also examine the statistics by looking at things like the number of rows and comparing them to the actual number of rows in the table (SQLTXPLAIN will list both for each table and index).<br><br>
One approach to confirming this is to export the current statistics on certain objects, gather fresh statistics and compare the two (avoid doing this on  a production system).</li>
</ul>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   The tables have undergone extreme DML changes; stats are old</i></b></p>    <br><p class="detailTblTxt3">The table has changed dramatically since the stats were collected due to large DML activity.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
You can determine if significant DML activity has occurred against certain tables in the query by looking in the SQLTXPLAIN report and comparing the "Current COUNT" with the "Num Rows".  If there is a large difference, the statistics are stale.<br><br>
You can also look in the DBA_TAB_MODIFICATIONS table to see how much DML has occurred against tables since statistics were last gathered.
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Histograms were collected on skewed data columns but computed cardinality is still incorrect</b></i></p>    <br><p class="detailTblTxt3">The computed cardinality is not correct for a column that is known to contain skewed data despite the fact that histograms have been collected at the maximum bucket size.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">Actual rows returned by the query do not match what the top-most line for the execution plan reports under "Estim Card" in the SQLTXPLAIN report.</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Long VARCHAR2 strings are exact up to the 32 character position</i></b></p>    <br><p class="detailTblTxt3">The histogram endpoint algorithm for character strings looks at the first 32 characters only.  If those characters are exactly the same for many columns, the histograms will not be accurate.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Observe the histogram endpoint values for the column in the SQLTXPLAIN report under the heading "Table Histograms".  Many, if not all, endpoint values will be indistinguishable from each other.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Data skewing is such that the maximum bucket resolution doesn't help</i></b></p>    <br><p class="detailTblTxt3">The histogram buckets must have enough resolution to catch the skewed data.  This usually means at least two endpoints must have the same value in order to be detected as a "popular" (skewed) value.  Skewing goes undetected when the number of samples in each bucket is so large that truly skewed values are buried inside the bucket.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Check the following for the column suspected of having skewed data:
<ol>
<li>A crude way to confirm there is skewed data is by running this query:<br>
SELECT AVG(col1)/((MIN(col1)+MAX(col1))/2) skew_factor FROM table1
<br>
<i>col1, table1</i> refers to the column/table that has skewed data. <br>
</li>
<li>Examine the output of the query for skewing; when the "skew_factor" is much less than or much greater than 1.0, there is some skewing.</li>
<li>Look at the endpoint values for the column in SQLTXPLAIN ("Table Histograms" section) and check if "popular" values are evident in the bucket endpoints (a popular value will have the same endpoint repeated in 2 or more buckets - these are skewed values)</li>
<li>If the histogram has 254 buckets and doesn't show any popular buckets, then this cause is justified.</li>
</ol>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Manually set histogram statistics to reflect the skewing in the column's data </i></b></p>    <br><p class="detailTblTxt3">The histogram will need to be manually defined according to the following method
<ol>
  <li>Find the values where skewing occurs most severely</li>
  <li>Use DBMS_STATS.SET_TABLE_STATS to enter the endpoints and endpoint values representing the skewed data values</li>
</ol>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High effort; It will take some effort to determine what the endpoint values should be and then set them using DBMS_STATS.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; By altering statistics manually, there is a chance that a miscalculation or mistake may affect many queries in the system.  The change may also destabilize good plans.]</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Details for this solution are not yet available.
</p>    <br><p class="detailTblTxt3">Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=72539.1">Interpreting Histogram Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Ensure reasonable initialization parameters are set </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">The CBO uses the values of various initialization parameters to estimate the cost of various operations in the execution plan.  When certain parameters are improperly set, they can cause the cost estimates to be inaccruate and cause suboptimal plans.<br>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Data Required For Analysis</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The data listed here is required for analyzing the causes in the table below.
<ul>
<li>Source: SQLTXPLAIN report, Optimizer Trace section, "Parameters Used by the Optimizer"</li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Common Observations and Causes</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The following table shows common problems and causes related to object statistics:	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Parameter settings affecting table access paths and joins</b></i></p>    <br><p class="detailTblTxt3">Certain initialization parameters may be set too aggressively to obtain better plans with certain queries.  These parameters may adversely affect other queries and cause them to favor full table scans and merge or hash joins instead of index access with nested loop joins.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Parameter settings affecting the optimizer are set to non-default values</li>
<li>The CBO chooses an access path, join order, or operation that is sub-optimal in comparison to another better plan (e.g., CBO chooses a full table scan instead of an index)</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing full table scans and merge/hash joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to affect the CBO's cost estimates :<br><li>optimizer_index_cost_adj set much higher than 100</li><li>db_file_multiblock_read_count set too high (greater than 1MB / db_block_size) </li><li>optimizer_mode=all_rows</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans, merge/hash joins occurring and above parameters not set to default values.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing index scans and nested loop joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to bias the CBO towards index scans and nested loop joins :<br><li>optimizer_index_cost_adj set much lower than 100</li><li>db_file_multiblock_read_count set too low (smaller than 1MB / db_block_size) </li><li>optimizer_index_caching set too high</li><li>optimizer_mode=first_rows (or first_rows_N)</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Index scans and nested loop joins occurring and above parameters not set to default values.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Init.ora parameters not set for Oracle Applications 11i</i></b></p>    <br><p class="detailTblTxt3">Oracle Applications 11i requires certain database initialization parameters to be set according to specific recommendations</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Oracle Applications 11i in use and init.ora parameters not set accordingly</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Set Database Initialization Parameters for Oracle Applications 11i</i></b></p>    <br><p class="detailTblTxt3">Oracle Applications 11i have strict requirements for database initialization parameters that must be followed.  The use of these parameters generally result in much better performance for the queries used by Oracle Apps.  This is a minimum step required when tuning Oracle Apps.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply set the parameters as required.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; these parameters have been extensively tested by Oracle for use with the Apps.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the notes below.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=216205.1">Database Initialization Parameters and Configuration for Oracle Applications 11i</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=174605.1">bde_chk_cbo.sql - Reports Database Initialization Parameters related to an Apps 11i instance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Reference Notes</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href=" http://www.oracle.com">    Gathering Statistics - Best Practices</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href=" http://www.yahoo.com">    Interpreting SQLTXPLAIN output</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href=" http://www.oracle.com">    Compare estimated vs. actual cardinality</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href=" https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=66484.1">    Which optimizer is being used?</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=43065.1">    Rule Based Optimizer -- Changing Query Access Paths</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=216205.1">    Database Initialization Parameters and Configuration for Oracle Applications 11i </a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Choose a Tuning Strategy">Choose a Tuning Strategy</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt"><p>Determining the cause for a query performance problem can be approached in various ways.  Three approaches are presented here:</p>    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Questions that influence the choice of strategy </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">The answers to the following questions will help you choose an appropriate tuning approach.    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Do you have an execution plan when the query ran well?</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><I>Rationale</I>:  If you have a "good" execution plan in addition to the current "bad" one, then you can use the "Execution Plan Comparison" strategy to find where the plans differ.  Once you know where they differ, you can modify the query to produce a good plan, or focus on the particular place where they differ and determine the cause for the difference	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Are you mostly interested in solving this problem quickly rather than getting to the cause?</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><I>Rationale</I>:If you have an urgent need to make the query perform well and you aren't interested in the underlying cause of the problem, you can use the "Quick Solution" strategy to give the CBO more information and possibly obtain a better execution plan.</p>
<p>Once you obtain a better plan, you have the option of performing a plan comparison and then a deeper analysis to find the root cause, or influence the CBO in whatever way possible to obtain the plan.</p>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Does the query spend most of its time&nbsp;in the execute/fetch phases (not parse phase)?</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt"><i>Rationale:</i>  If the query spends most its time parsing, normal query tuning techniques that alter the execution plan to reduce logical I/O during execute or fetch calls probably won't help.  The focus of the tuning should be in reducing parse times; see the "Parse Reduction" strategy.</p>
<p>For example, here is an excerpt from a TKProf for a query:</p>

<table width="98%" border="1" class="detailTbl">
  <tr>
    <td width="100%" class="detailTraceBlk">      <div align="left">
      <pre><br>SELECT * FROM  ct_dn dn, ds_attrstore store . . .
<br>
call     count       cpu  elapsed  disk    query  current     rows
------- ------  -------- -------- ----- -------- --------  -------
Parse      555    100.09   300.83     0        0        0        0
Execute    555      0.42     0.78     0        0        0        0
Fetch      555     14.04    85.03   513  1448514        0    11724
------- ------  -------- -------- ----- -------- --------  -------
total     1665    114.55   386.65   513  1448514        0    11724</pre>      
<br>
    </td>
  </tr>
</table>
<p>The elapsed time spent parsing was 300.83 seconds compared to only 85.03 seconds for fetching. 
This query is having trouble parsing - tuning the query's execution plan to reduce the number
 of buffers read during the fetch call will not give the greatest performance gain
 (in fact only about 85 out of 386 seconds  could be improved in the fetch call).</p>	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Using Oracle 10g ==> Use the SQL Tuning Advisor </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><p>
Oracle 10g is able to perform advanced SQL tuning analysis using the SQL Tuning Advisor (and related Access Advisor).  This is the preferred way to begin a tuning effort if you are using Oracle 10g.  <br>
<br>
Note: You must be licensed for the "Tuning Pack" to use these features.
</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">High Parse Times ==> Parse Time Reduction Strategy </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>
Reduction in high parse times requires a different approach to query tuning than the typical goals of reducing logical I/O or inefficient execution plans.<br>
<br>
<i>When to use:</i>  Use this approach when you have determined the query spends most of its time in the parse phase (this was done when you verified the issue).
</p>
<p><b>Data Required for Analysis</b></p>
<ul>
<li>Source: TKProf<br>
-  parse elapsed time, overall elapsed time<br>
-  parse time spent on CPU; <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=392221.1#hi_cpu_parse">Example of a query with high parse CPU</a><br>
-  parse time spent waiting (not in CPU); <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=395474.1#hi_wait_parse">Example of a query with high parse Waits</a><br>
</li><br>
<li>If the parse time spent on CPU is more than 50% of the parse elapsed time, then the parse time is dominated by CPU; otherwise it is dominated by waits.</li>
</ul>
<p>See the appropriate section below based on the data collected.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">CPU time dominates the parse time</li></ol><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>High CPU usage during HARD parse</b></i></p>    <br><p class="detailTblTxt3">High CPU usage during hard parses are often seen with large statements involving many objects or partitioned objects.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ol>
<li>Check if the statement was hard parsed</li>
<li>Compare parse cpu time to parse elapsed time to see if  parse cpu time is more than 50%</i>
</ol></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Dynamic sampling is being used for the query and impacting the parse time</i></b></p>    <br><p class="detailTblTxt3">Dynamic sampling is performed by the CBO (naturally at parse time) when it is either requested via hint or parameter, or by default because statistics are missing.  Depending on the level of the dynamic sampling, it may take some time to complete - this time is reflected in the parse time for the statement.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>The execution plan output of SQLTXPLAIN, the UTLXPLS script, or a 10053 trace will show if dynamic sampling was used while optimizing the query.</li>
</ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Alternatives to Dynamic Sampling</i></b></p>    <br><p class="detailTblTxt3">If the parse time is high due to dynamic sampling, alternatives may be needed to obtain the desired plan without using dynamic sampling.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; some alternatives are easy to implement (add a hint), whereas others are more difficult (determine the hint required by comparing plans)</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; in general, the solution will affect only the query.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Some alternatives to dynamic sampling are:<br>
<ol>
<li>In 10g or higher, use the SQL Tuning Advisor (STA)  to generate a profile for the query (in fact, its unlikely you'll even set dynamic sampling on a query that has been tuned by the STA)</li>
<li>Find the hints needed to implement the plan normally generated with dynamic sampling and modify the query with the hints</li>
<li>Use a stored outline to capture the plan generated with dynamic sampling</li>
</ol>
<br>
For very volatile data (in which dynamic sampling was helping obtain a good plan), an approach can be used where an application will choose one of several hinted queries depending on the state of the data (i.e., if data recently deleted use query #1, else query #2).
</p>    <br><p class="detailTblTxt3">Documents for hints:<br></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3">Documents for stored outlines / plan stability:<br></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">Using Plan Stability</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">Stored Outline Quick Reference</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=122812.1">How to Tune a Query that Cannot be Modified</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=102311.1">How to Move Stored Outlines for One Application from One Database to Another</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has many IN LIST parameters / OR statements</i></b></p>    <br><p class="detailTblTxt3">The CBO may take a long time to cost a statement with dozens of IN LIST / OR clauses.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>The query has a large set of IN LIST values or OR clauses.</li>
</ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Implement the NO_EXPAND hint to avoid transforming the query block</i></b></p>    <br><p class="detailTblTxt3">In versions 8.x and higher, this will avoid the transformation to separate query blocks with UNION ALL (and save parse time) while still allowing indexes to be used with the IN-LIST ITERATOR operation.  By avoiding a large number of query blocks, the CBO will save time (and hence the parse time will be shorter) since it doesn't have to optimize each block.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; hint applied to a query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; hint applied only to the query and will not affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=62153.1">Optimization of large inlists/multiple OR`s</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50502">NO_EXPAND Hint </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Partitioned table with many partitions</i></b></p>    <br><p class="detailTblTxt3">The use of partitioned tables with many partitions (more than 1,000) may cause high parse CPU times while the CBO determines an execution plan.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>Determine total number of partitions for all tables used in the query.</li>
<li>If the number is over 1,000, this cause is likely</li>
</ol>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   9.2.0.x, 10.0.0: Bug 2785102 - Query involving many partitions (>1000) has high CPU/memory use</i></b></p>    <br><p class="detailTblTxt3">A query involving a table with a large number of partitions takes a long time to  parse, causes rowcache  contention, and high CPU consumption. The case of this bug involved a table with greater than 10000 partitions and global statistics ere not gathered.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; application of a patchset.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; patchsets generally are low risk because they have been regression tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Apply patchset 9.2.0.4<br>
<br>
Workaround: <br>Set "_improved_row_length_enabled"=false</p>    <br><p class="detailTblTxt3">Additional bug information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=BUG&id=2785102">Bug 2785102</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Wait time dominates the parse time</li></ol><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>High wait time during HARD parse</b></i></p>    <br><p class="detailTblTxt3">High wait time during hard parses usually occur due to contention for resources or are related to very large queries.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ol>
<li>Check if the statement was hard parsed (See TKProf, "Misses in the library cache" for the statement - if this is equal to one or higher, then this statement was hard parsed)</li>
<li>Examine the waits in the TKProf for this statement; you will see waits like "SQL*Net more data FROM client" or waits  related to latches, library cache locks or pins.</li>
</ol>
</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Waits for large query texts to be sent from the client</i></b></p>    <br><p class="detailTblTxt3">A large query (containing lots of text) may take several round trips to be sent from the client to the server; each trip takes time (especially on slow networks).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>High parse wait times occur any time, not just during peak load or during certain times of the day</lI>
<li>Most other queries do not have high parse wait times at the same time as the query you are trying to tune</li>
<li>TKProf shows "SQL*Net more data from client" wait events.</li>
<li>Raw 10046 trace shows "SQL*Net more data from client" waits just before the PARSE call completes</li>
<li>Slow network ping times due to high latency networks make these waits worse</li>
</ol>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use PL/SQL REF CURSORs to avoid sending query text to the server across the network</i></b></p>    <br><p class="detailTblTxt3">The performance of parsing a large statement may be improved by encapsulating the SQL in a PL/SQL package and then obtaining a REF CURSOR to the resultset.  This will avoid sending the SQL statement across the network and will only require sending bind values and the PL/SQL call.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; a PL/SQL package will need to be created and the client code will need to be changed to call the PL/SQL and obtain a REF CURSOR.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; there are changes to the client code as well as the PL/SQL code in the database that must be tested thoroughly, but the changes are not widespread and won't affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=120201.1">How to use PL/SQL REF Cursors to Return Result Sets </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14261/sqloperations.htm#sthref1393">Using Cursor Variables (REF CURSORs)</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Only Bad Plan Available, Fast Solution Desired ==> Quick Solution Strategy </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>The goal of this strategy is to change some high-level settings of the optimizer and see if a better plan results (e.g., change the optimizer_mode or use dynamic sampling).  Then, use hints or other means to make the CBO generate the better plan.  The better plan can be used to find an underlying cause later.</p>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Assumptions</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<ul>
<li>Oracle 10g or higher: You have already tried the SQL Tuning Advisor (STA).  Do not use these techniques if you are licensed for the STA and haven't tried using it first.</li>
<li>You have read the section above, "Always Check: Optimizer Mode, Statistics, and Parameters" and have ensured that statistics are being gathered properly.   In summary, we want to ensure the following:<br>
<br>
<ul>
<li>The CBO is being used</li>
<li>Statistics have been gathered for all objects, tables as well as indexes</li>
<li>The sample size is as large as possible - "COMPUTE" if possible</li>
<li>Histograms have been gathered on any columns in the query predicate that may have skewed data</li>
<li>Global partition stats are gathered on a partitioned table</li>
</ul>
</li>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Preparations</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
You will need the query text and bind values (if applicable) to run on the system where the query is slow (or a test system where this problem is reproduced).<br>
<br>
The use of a test script is very valuable for the techniques in this section.  See the instructions in "Determine a Cause" > Data Collection > D. Construct a Test Script<br>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Discover a Better Execution Plan - Basic Techniques</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
The following changes should be tried first - they are likely to give the best results in the shortest time.<br>
<ol>
<li><b>Change the optimizer mode</b>:  If the optimizer mode is currently ALL_ROWS, use FIRST_ROWS_N (choose a value for N that reflects the number of rows that the user wants to see right away) or vice versa.  The optimizer mode may be changed via hint or parameter, for example:</li>
<ul>
<li>Hint:<br><pre>
SELECT /*+ first_rows_1 */  col1, col2, ...
FROM table1...
WHERE col1 = 1 AND ...
</pre>
</li>
<li>Parameter:  <br>
<pre>
ALTER SESSION SET optimizer_mode = first_rows_1; 
SELECT  col1, col2, ...
FROM table1...
WHERE col1 = 1 AND ...
</pre>
</li>
</ul>
<li><b>Dynamic Sampling</b>: This will sample the number of rows returned by the query and determine very accurate selectivity estimates that often lead to good execution plans.  There are two ways to use it:<br>
<ul>
<li>Hint:<br><pre>
SELECT /*+ dynamic_sampling(5) */  col1, col2, ...
FROM table1...
WHERE col1 = 1 AND ...
</pre>
</li>
<li>Parameter:  <br>
<pre>
ALTER SESSION SET optimizer_dynamic_sampling = 5; 
SELECT  col1, col2, ...
FROM table1...
WHERE col1 = 1 AND ...
</pre>
</li>
</ul>
The dynamic sampling levels generally control how large the sample size will be.  A setting of 10 will cause all rows to be sampled from the tables in the query - if the tables are large this will take some time.  Its a good idea to start with a level of 5 and increase it until the performance of the query improves.<br>
<br>
<b>Note:</b>  The query should be run TWICE to truly determine if the performance is better.  This is because the first time the query is parsed, the dynamic sampling effort may take considerable time and doesn't reflect the execution plan's performance.  The second run will indicate if the execution plan is improved and hence performance is better.
</li><br>
<li><b>OPTIMIZER_FEATURES_ENABLE parameter</b>:  If this query performed better in an older version (say prior to a migration), then use this parameter to "rollback" the optimizer to the older version.  In Oracle 10g and higher, this can be set at the session level which is preferred over system-wide level.</li>
<br>
<li><b>Replace bind variables with literals</b> : Sometimes bind peeking doesn't occur for all bind variables (may happen for certain complex queries).  Substituting the literals will allow the CBO to have accurate values.  <br>
<br>
<b>Note</b>: the use of literals is strictly for this test; it is not recommended to use literals on production OLTP applications due to concurrency issues.
</ol>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="4">Discover a Better Execution Plan - Additional Techniques</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Try these changes if the basic techniques did not result in a better execution plan.</p>
<ol>
<li>If the query returns FEW rows
<ul>
<li>ALTER SESSION SET OPTIMIZER_INDEX_COST_ADJ = 10 (or lower)</li>
<li>ALTER SESSION SET OPTIMIZER_INDEX_CACHING = 90 (or higher)</li>
</ul>
<br>
</li>
<li>If the query returns MANY rows
<ul>
<li>ALTER SESSION SET OPTIMIZER_INDEX_COST_ADJ = 1000 (or higher) </li>
<li>ALTER SESSION SET OPTIMIZER_INDEX_CACHING = 0 </li>
<li>PARALLEL hint; Use parallelism if sufficient CPU and I/O bandwidth are available to run the statement (along with other sessions concurrently)</li>
<br>
</ul>
<li>If the query uses views, try the following hints:
<ul><li>PUSH_PRED, NO_MERGE</li>
<li>MERGE</li>
</ul>
<br>
</li>
<li>If the query has a subquery, try the following hints:
<ul><li>PUSH_SUBQ</li>
<li>UNNEST</li>
</ul>
</li>
</ol>
<p><b>Note:</b> In Oracle 10gR2, you can set an initialization parameter in a hint so it affects only the query being tuned.  This undocumented hint is called "OPT_PARAM".  It may be used as follows:<br>
For text values (e.g., 'TRUE'): OPT_PARAM('initialization parameter name'  'parameter value - text')<br>
For numeric values: OPT_PARAM('initialization parameter'  99)</p>
<p>For example:</p>
<p class="detailTraceBlk"><b>SELECT /*+ OPT_PARAM('optimizer_index_adj' 10) */ col1, col2<br>FROM table1 WHERE col1 = 10;</b><p>
<p>This hint will be documented in later versions.</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="5">Implement the New Good Plan</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
This section will identify ways to implement the new, good plan you discovered through the techniques above.<br>
<ul>
<li>If you are able to modify the query or application...
<ol>
<br>
<li>Examine the good plan and find the difference with the bad plan.<br>
Often, this will be something simple like the use of an index or a different join order.<br>
See the "Execution Plan Comparison" strategy section for more details.
</li>
<li>Find a hint for the query to make the CBO generate the good plan.<br>
Sometimes it is helpful to obtain stored outlines for the bad execution plan and the good one to compare and see what hints may be needed.<br>
<br>
If you aren't able to find a suitable hint, try the method below using stored outlines. 
</li>
</ol>
</li>
<br>
<li>If you are NOT able to modify the query (third party application, etc)...
<ul>
<br>
<li>Use stored outlines to "lock in" a good plan
<ol>
<li>Use session-based initialization parameters to change the execution plan</li>
<li>Capture a stored outline for the query (use ALTER SESSION CREATE_STORED_OUTLINES command)</li>
<li>Verify the stored outline causes the query to perform well</li>
<li>Test the stored outline on a test system</li>
<li>Implement the stored outline in production</li>
</ol>
</li>
<br>
<li>Use initialization parameters to influence the CBO
<ol>
<li>Use a LOGON trigger or change the application  to set its session parameters to values that improve the query's performance.  This approach is not recommended in most cases because it may cause undesirable changes to other queries that perform well.</li>
</li>
</ol>
</ul>
</ul>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="6">Follow-up</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
If the problem was not solved or if you need to find the underlying cause, see the "Plan Analysis" strategy for a more rigorous way to help identify the underlying cause.<br>
<br>
If you would like to log a service request, see the section below for more details.	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Good and Bad Execution Plan Available => Execution Plan Comparison Strategy </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">NOTE: This section is still under construction.<br>
<br>
<p>
The goal of this strategy is to compare the good and bad execution plans, find the differences, and look for ways to make the bad plan change so it becomes like the good one.<br>
<br>
<i>When to use:</i>  Use this approach when:
<ul>
<li>a good plan is available</li>
<li>a reasonably quick solution is required</li>
<li>determining an underlying cause is not required (due to time constraints)</li>
<li>the query may be modified (hints, etc)</li>
</ul>
</p>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Review the "Always Check:..." section to ensure the CBO has enough information to make a good choice</li></ol> <DIV ID="H2SH5L1" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Obtain a "good" plan and a "bad" plan</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Ideally, you have collected all of the data described in the data collection step for both good and bad plans.  With this information, it will be possible to compare both plans.<br><br>
<b>Note:</b>  Oracle 10gR2's PLAN_TABLE has a column called "OTHER_XML" which contains the hints needed to produce the plan.  If the good plan is from 10gR2, view the contents of this column to extract the hints for the query.  You can skip the rest of this procedure since the hints are complete, or you can continue and eliminate all of the hints but the ones actually needed to enforce the plan.
</p>	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Walk through the plan steps and compare</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>The remainder of the steps will compare the join orders, join types, access methods, and other operations between the two execution plans.  This comparison is done by "walking" through the execution step-by-step in the order the plan is executed by Oracle.</p>
<p>The SQLTXPLAIN report's execution plan output has a column called, "Exec Order" which will guide you on the proper sequence of steps (the plan starts with step 1).  For example:</p>
<table width="98%" border="1" class="detailTblTxtBlk">
<tr>
<td>
<p align="center"><b>Id</b></td>
<td bgcolor="#FF0000">
<p align="center"><b>Exec<br>Order</b></td>
<td>
<p align="center"><b>Explain Plan Operation</b></td>
</tr>
<tr>
<td>0:</td>
<td bgcolor="#FF0000">5</td>
<td class="detailTraceBlk">SELECT STATEMENT</td>
</tr>
<tr>
<td>1:</td>
<td bgcolor="#FF0000">4</td>
<td class="detailTraceBlk" >&nbsp;SORT GROUP BY</td>
</tr>
<tr>
<td>2:</td>
<td bgcolor="#FF0000">3</td>
<td class="detailTraceBlk" >&nbsp; HASH JOIN</td>
</tr>
<tr>
<td>3:</td>
<td bgcolor="#FF0000">1</td>
<td class="detailTraceBlk" >&nbsp;&nbsp; INDEX FAST FULL SCAN TOWNER.TEAMS_LINKS_IDX_001</td>
</tr>
<tr>
<td>4:</td>
<td bgcolor="#FF0000">2</td>
<td class="detailTraceBlk">&nbsp;&nbsp; INDEX FAST FULL SCAN TOWNER.UOIS_IDX_003</td>
</tr>
</table>
<p>In this case, the execution will start with the step that has the "Explain Plan Operation" as "INDEX FAST FULL SCAN TOWNER.TEAMS_LINKS_IDX_001", followed by "INDEX FAST FULL SCAN TOWNER.UOIS_IDX_003"</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="4">Comparing and changing the join order</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Comparing the Join Orders</b></p> 
<p>The join order is one of the most important factors for query performance for queries involving many tables.  The join order for the good plan may be obtained in  one of two ways:</p>
<ul>
<li><b>10053 Trace File</b>: Using the 10053 trace for the good plan, find the final join order chosen by the CBO.  The join order is simply read from top to bottom (from Table #0 to Table # N). For example:<br><br>
<p class="detailTraceTxt">
Best so far: TABLE#: 0  CST:       8502  CDN:     806162  BYTES:   72554580<br>
Best so far: TABLE#: 1  CST:      40642 CDN:     806162  BYTES:  112056518<br>
</p>
<p>To map the table #s to actual names, you'll need to find the line at the top of the join order, similar to this:</p>
<p class="detailTraceTxt">
Join order[1]: EMP [ E] DEPT [ D]
</p>
<p>Table #0 is the furthest left table, Table #1 is the next to the right and so on.</p>
<p>In this case, the order is EMP, DEPT<br>
&nbsp;</p></li>
<li><b>SQLTXPLAIN File</b>: Run through the plan in the order of the execution (SQLTXPLAIN has a column called "Exec Order" which tells you this), and take note of the order of the tables as you "walk" through the plan.
<br>
<br>
<table width="98%" border="1" class="detailTblTxtBlk">
<tr>
<td>
<p align="center"><b>Id</b></td>
<td bgcolor="#FF0000">
<p align="center"><b>Exec<br>Order</b></td>
<td>
<p align="center"><b>Explain Plan Operation</b></td>
</tr>
<tr>
<td>0:</td>
<td bgcolor="#FF0000">5</td>
<td class="detailTraceBlk">SELECT STATEMENT</td>
</tr>
<tr>
<td>1:</td>
<td bgcolor="#FF0000">4</td>
<td class="detailTraceBlk" >&nbsp;SORT GROUP BY</td>
</tr>
<tr>
<td>2:</td>
<td bgcolor="#FF0000">3</td>
<td class="detailTraceBlk" >&nbsp; HASH JOIN</td>
</tr>
<tr>
<td>3:</td>
<td bgcolor="#FF0000">1</td>
<td class="detailTraceBlk" >&nbsp;&nbsp; INDEX FAST FULL SCAN TOWNER.TEAMS_LINKS_IDX_001</td>
</tr>
<tr>
<td>4:</td>
<td bgcolor="#FF0000">2</td>
<td class="detailTraceBlk">&nbsp;&nbsp; INDEX FAST FULL SCAN TOWNER.UOIS_IDX_003</td>
</tr>
</table>
<p>In this case, two indexes are scanned instead of the actual tables, so we need to find the tables they correspond to by looking in the SQLTXPLAIN report:</p>

<table width="100%" border="1">
<tr>
<td class="detailTblTxtBlk" width="126">
<p align="center"><b>Table Owner.Table Name</b></td>
<td class="detailTblTxtBlk" width="205">
<p align="center"><b>Index Owner.Index Name</b></td>
<td class="detailTblTxtBlk" width="27">
<p align="center"><b>Used</b></td>
<td class="detailTblTxtBlk" width="42">
<p align="center"><b>Index<br>Type</b></td>
<td class="detailTblTxtBlk" width="67"><b>Uniqueness</b></td>
<td class="detailTblTxtBlk" width="119">
<p align="center"><b>Indexed Columns</b></td>
</tr>
<tr>
<td class="detailTraceBlk" width="126">TOWNER.TEAMS_LINKS</td>
<td class="detailTraceBlk" width="205">TOWNER.TEAMS_LINKS_DEST_I</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">DEST_VALUE DEST_TYPE</td>
</tr>
<tr bgcolor="#FF0000">
<td class="detailTraceBlk" width="126">TOWNER.TEAMS_LINKS</td>
<td class="detailTraceBlk" width="205">TOWNER.TEAMS_LINKS_IDX_001</td>
<td class="detailTraceBlk" width="27">3</td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">LINK_TYPE DEST_VALUE SRC_VALUE</td>
</tr>
<tr>
<td class="detailTraceBlk" width="126">TOWNER.TEAMS_LINKS</td>
<td class="detailTraceBlk" width="205">TOWNER.TEAMS_LINKS_IDX_002</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">LINK_TYPE SRC_VALUE DEST_VALUE</td>
</tr>
<tr>
<td class="detailTraceBlk" width="126">TOWNER.TEAMS_LINKS</td>
<td class="detailTraceBlk" width="205">TOWNER.TEAMS_LINKS_PK</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">UNIQUE</td>
<td class="detailTraceBlk" width="119">SRC_VALUE DEST_VALUE LINK_TYPE</td>
</tr>
<tr>
  <td class="detailTraceBlk" width="126">...</td>
  <td class="detailTraceBlk" width="205">...</td>
  <td class="detailTraceBlk" width="27"></td>
  <td class="detailTraceBlk" width="42">...</td>
  <td class="detailTraceBlk" width="67">...</td>
  <td class="detailTraceBlk" width="119">...</td>
</tr>
<tr>
<td class="detailTraceBlk" width="126">TOWNER.UOIS</td>
<td class="detailTraceBlk" width="205">TOWNER.UOIS_IDX_002</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">CONTENT_TYPE CONTENT_STATE</td>
</tr>
<tr bgcolor="#FF0000">
<td class="detailTraceBlk" width="126">TOWNER.UOIS</td>
<td class="detailTraceBlk" width="205">TOWNER.UOIS_IDX_003</td>
<td class="detailTraceBlk" width="27">4</td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">UOI_ID CONTENT_STATE</td>
</tr>
<tr >
<td class="detailTraceBlk" width="126">TOWNER.UOIS</td>
<td class="detailTraceBlk" width="205">TOWNER.UOIS_METADATA_STATE_DT</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">METADATA_STATE_DT</td>
</tr>
<tr>
  <td class="detailTraceBlk" width="126">...</td>
  <td class="detailTraceBlk" width="205">...</td>
  <td class="detailTraceBlk" width="27"></td>
  <td class="detailTraceBlk" width="42">...</td>
  <td class="detailTraceBlk" width="67">...</td>
  <td class="detailTraceBlk" width="119">...</td>
</tr>
<tr>
<td class="detailTraceBlk" width="126">TOWNER.UOIS</td>
<td class="detailTraceBlk" width="205">TOWNER.UOI_UCT_I</td>
<td class="detailTraceBlk" width="27"></td>
<td class="detailTraceBlk" width="42">NORMAL</td>
<td class="detailTraceBlk" width="67">NONUNIQUE</td>
<td class="detailTraceBlk" width="119">CONTENT_TYPE</td>
</tr>
</table>
<p>Now we can resolve that the table order is: 1) TOWNER.TEAM_LINKS, 2) TOWNER.UOIS</p>
</li>
</ul>
<p>Compare the order of the good plan to the bad plan.  If they differ, use the "ORDERED" or "LEADING" hints to direct the CBO.</p>
<p><b>Changing the Join Order</b><br>
For example, in the case above, we can make the join order of the good plan with the the following hint:</p>
<blockquote>
<p class="detailTraceBlk">SELECT <b> /*+ ordered */ </b> TL.COL1, TU.COL2
FROM TOWNER.TEAM_LINKS TL,  TOWNER.UOIS TU
WHERE ...</p>
</blockquote>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="5">Compare data access methods of both plans</li></ol> <DIV ID="H2SH5L5" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="6">Compare join types of both plans</li></ol> <DIV ID="H2SH5L6" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp; </td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="7">Identify major operations that differ between plans</li></ol> <DIV ID="H2SH5L7" style="visibility:hidden"><p class="detailEmptyLayer">temp text</DIV> </td> </tr> <tr> <td width="3%" class="detailEmptyLine">&nbsp;</td> <td width="97%" class="detailEmptyLine">&nbsp;</td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="8">Make the CBO generate the "good" plan</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
Once the difference between the plans has been found, the query will need to be modified with a hint to cause the good plan to be generated.  If its not possible to change the query, then alternative ways to change the query may be needed, such as:
<br>
<ul>
<br>
<li>Use stored outlines to "lock in" a good plan
<ol>
<li>Use session-based initialization parameters to change the execution plan</li>
<li>Capture a stored outline for the query (use ALTER SESSION CREATE_STORED_OUTLINES command)</li>
<li>Verify the stored outline causes the query to perform well</li>
<li>Test the stored outline on a test system</li>
<li>Implement the stored outline in production</li>
</ol>
</li>
<br>
<li>Use initialization parameters to influence the CBO
<ol>
<li>Use a LOGON trigger or change the application  to set its session parameters to values that improve the query's performance.  This approach is not recommended in most cases because it may cause undesirable changes to other queries that perform well.</li>
</li>
</ol>
</ul>
	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">Only Bad Plan Available, Thorough Analysis Desired ==> Plan Analysis Strategy </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>
Review the query text, access paths, join orders, and join methods for common problems; implement the solutions to these problems.  This is the default approach to query tuning issues and is the main subject of this phase.&nbsp; In summary, this approach will focus on :
<ul>
<li><b>Statistics and Parameters:</b>  Ensure statistics are up-to-date and parameters are reasonable</li>
<li><b>SQL statement structure</b>: Look for constructs known to confuse the optimizer</li>
<li><b>Data access paths</b>: Look for inefficient ways of accessing data knowing how many rows are expected</li>
<li><b>Join orders and join methods</b>: Look for join orders where large rowsources are at the beginning; look for inappropriate use of join types </li>
<li><b>Other operations</b>: Look for unexpected operations like parallelism or lack of partition elimination</li>
</ul>
</p>
 
<p>
<i>When to use:</i>  Use this approach when:<br>
<ul>
<li>a good plan is not available</li>
<li>an urgent solution is not required</li>
<li>determining an underlying cause is desired</li>
<li>the query may be modified (hints, etc)</li>

</ul>
</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">- - - - - A.  Examine the SQL Statement </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt"><p>Look at the query for common mistakes that occur.  Understand the volume of data that will result when the query executes.</p>    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Ensure no join predicates are missing</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Missing join predicates cause cartesian products that are very inefficient and should be avoided.  They are usually the result of a mistake in the SQL.  You can identify this easily by looking at each table in the <i>FROM</i> clause and ensuring the <i>WHERE</i> clause contains a join condition to one or more of the other tables in the <i>FROM</i> clause.  For example,</p>
<p class="detailTraceTxt"> 
SELECT e.ename, d.dname FROM scott.emp e, scott.dept d WHERE e.empno &lt; 1000</p>
<p>Should be rewritten as:</p>
<p class="detailTraceTxt"> 
SELECT e.ename, d.dname FROM scott.emp e, scott.dept d WHERE e.empno &lt; 1000 AND <b>e.deptno = d.deptno</b>
</p>
	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Look for unusual predicates</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Unusual predicates are usually present due to query generators that do not take into account the proper use of the CBO.  These predicates may cause the CBO to inaccurately estimate the selectivity of the predicate.  Some unusual predicates are:</p>
<ul> 
<li><b>Repeated identical predicates</b>: E.g., WHERE col1 =1 and col1 =1 and col1 =1 and ...., this will cause the CBO underestimate the selectivity of the query.  Assuming that the selectivity of  "col1 = 1" is 0.2, the clause above would have its selectivity = 0.2 * 0.2 * 0.2 = 0.008.  This would mean that the estimated cardinality would be much smaller than it actually is and may chose an index path when a full table scan would have been a better choice or the CBO might decide to begin a join order using a table that returns many more rows than is estimated.</li><br>
<li><b>Join predicates where both sides are identical</b>:  E.g. WHERE d.deptno = d.deptno, this has the effect of 1) removing NULLs from the query (even on a NULLable column) and 2) underestimating the cardinality.</li>
</ul>
<p>The unusual predicates should be removed if they are causing unexpected results (no NULLs) or bad execution plans due to incorrect cardinality estimates.  If there is no way to change the query, it might be beneficial to upgrade to version 9.2 or greater to take advantage of the CBO's awareness of these kinds of predicates.</p>
<p>Other common problems are listed below:</p>	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Bad performance using Fine Grained Access Control (FGAC)</b></i></p>    <br><p class="detailTblTxt3">A query performs well unless FGAC is used.  Whenever FGAC is avoided, the performance improves.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ol>
<li>Compare the execution plans when FGAC was used to when it wasn't.  There should be a difference in plans</li>
<li>The plan with the FGAC use should have additional predicates generated automatically and visible in the "access predicate" or "filter predicate" output of the execution plan (in SQLTXPLAIN)</i>
</ol>
</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Index needed for columns used with fine grained access control </i></b></p>    <br><p class="detailTblTxt3">The use of FGAC will cause additional predicates to be generated.  These predicates may be difficult for the CBO to optimize or they may require the use of new indexes.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>Query performance improves when FGAC is not used</li>
<li>Manually adding  the FGAC-generated predicates to the base query will reproduce the problem.</li>
<li>Event 10730 shows the predicate added by FGAC and it matches the predicate seen in the execution plan's access and filter predicates
</li>
</ol>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create an index on the columns involved in the FGAC</i></b></p>    <br><p class="detailTblTxt3">FGAC introduces additional predicates that may require an index on the relevant columns.  In some cases, a function-based index may be needed.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; just add an index or recreate an index to include the columns used in the security policy.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The index should have little negative impact except where a table already has many indexes and this index causes DML to take longer than desired.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">TBD</p>    <br><p class="detailTblTxt3">TBD</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://coe.oraclecorp.com">TBD</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>	<p class="detailTblTxt2"><b><i>Cause Identified:   <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=BUG&id=5195882">Bug 5195882</a></i></b></p>    <br><p class="detailTblTxt3">Queries In FGAC Using Full Table Scan Instead Of Index Access
<br>
<br>
This bug prevents view merging when PL/SQL functions and views are involved - which is common when FGAC is used.  The inability to merge views leads to bad execution plans.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>Query performance improves when FGAC is not used</li>
<li>Manually adding  the FGAC-generated predicates to the base query will reproduce the problem.</li>
<li>Event 10730 shows the predicate added by FGAC and it matches the predicate seen in the execution plan's access and filter predicates
</li>
</ol>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Apply patch for bug 5195882 or use the workaround</i></b></p>    <br><p class="detailTblTxt3">Patch and workaround available.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Requires a patch application.  The workaround is lower effort, but side effects are unknown.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">If applying the one-off patch,  it carries the risk typically associated with one-off patches.<br>
Patchset 10.2.0.3 has the fix for this bug and is lower risk since patchsets are rigorously tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Contact Oracle Support Services for the patch.<br>
<br>
Workaround:<br>
Set optimizer_secure_view_merging=false</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Look for constructs known to cause problems</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p>Certain constructs are known to cause problems with the CBO.  Some of these include:</p>
<ul> 
<li>Large IN lists / OR statements </li>
<li>Outer Joins</li>
<li>Hierarchical queries</li>
<li>Views, inline views, or subqueries</li>
<p>See the table below for common causes related to SQL constructs.</p>	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Bad Execution Plans with Large IN Lists / OR statements</b></i></p>    <br><p class="detailTblTxt3">Large IN lists / OR statements are sometimes difficult for the CBO to cost accurately.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">Query contains clauses of the form:<br>
<ul class="detailTblTxt3">
<li>...WHERE col1 IN (1, 2, 3, 4, 5, ...)</li>
<li>...WHERE col1 = 1 OR col1 = 2 OR col1 = 3 ... </li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   CBO costs a full table scan cheaper than a series of index range scans</i></b></p>    <br><p class="detailTblTxt3">The CBO determines that it is cheaper to do a full table scan than to expand the IN list / OR into separate query blocks where each one uses an index.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans in the execution plan instead of a set of index range scans (one per value) with a CONCATENATION operation.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Implement the USE_CONCAT hint to force the optimizer to use indexes and avoid a full table scan</i></b></p>    <br><p class="detailTblTxt3">This hint will force the use of an index (supplied with the hint) instead of using a full table scan (FTS).  For certain combinations of IN LIST and OR predicates in queries with tables of a certain size, the use of an index may be far superior to an FTS on a large table.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; simply use the hint in the statement (assuming you can alter the statement).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; will only affect the single statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the notes below.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=17214.1">Using the USE_CONCAT hint with IN/OR Statements</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">- - - - - B.  Examine Data Access Paths </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>The choice of access path greatly affects the performance of queries.  If the query has a predicate that will reduce the number of rows from a table, then the use of an index is usually beneficial (hopefully, indexes exist for the columns in the predicate).  On the other hand, if there is no predicate to filter the rows from a table or the predicate is not very selective and many rows are expected, a full table scan may be a better choice over an index scan.</p>
<p>It is important to understand the actual number of rows expected for each plan step and compare it to the CBO's estimate so that you can determine if FTS or index access makes more sense.</p>
<p><b>Data Required for Analysis</b></p>
<ul>
<li>Source: Execution plan (gathered in "Data Collection", part A)
<ul>
<li>Actual number of rows returned by the query or an execution plan that shows actual and estimated rows per plan step.</li>
<li>Estimated number of rows returned by the query ("Estim Card" or similar)  from the execution plan</li>
<li>Determine if there is a large discrepancy between the actual and estimated rows</li>
</ul>
</li>
</ul>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Few rows expected to be returned by the query (typically OLTP apps)</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
If you know that few rows will be returned by the query or by a particular predicate, then you should expect to see an index access method to retrieve those rows.  Look for places in the plan where the <i>actual</i> cardinality is low (the estimated one may be high due to an inaccurate CBO estimate) but an index is not used.	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Query is not using an index, or is using the "wrong" one</b></i></p>    <br><p class="detailTblTxt3">Either an index is not available for one or more columns in the query's predicate(s), or an available index is not chosen by the CBO.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">The execution plan shows that an index is not used (FTS is used instead typically) to access rows from a table for a particular predicate's column(s) AND
 <ul class="detailTblTxt3">
<li>The column(s) do not have an index</li>
or
<li>An existing index that contains the column is not used</li></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No index available for columns in the predicate</i></b></p>    <br><p class="detailTblTxt3">No indexes have been defined for one or more columns in the query predicate.  Oracle only has a full table scan access method available in this case.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>For each column in the query's WHERE clause, check that there is an index available.  In some cases, multiple columns from a table will be in the WHERE clause - ideally, there is an index defined with these columns as the leading columns of the index.</li>
<li>Examine the execution plan in the SQLTXPLAIN report and look for predicates using the "FILTER()" function rather than the "ACCESS()" function.  Predicates obtained via ACCESS() were obtained using an index (more efficiently and directly), whereas those obtained via FILTER() where obtained by applying a condition to a row source after the data was obtained.</li>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect selectivity estimate</i></b></p>    <br><p class="detailTblTxt3">The CBO needs additional information for estimating the selectivity of the query (in maybe just one of the plan steps).  Usually this is due to predicate clauses that have some correlation.  The CBO assumes that filter predicates are independent of each other; when ANDed, these predicates reduce the number of rows returned (increased selectivity).  However, when these predicates are not independent (e.g., a query that filtered on the city name and postal code), more rows are returned than the CBO estimates.  This leads to inaccurate cost estimates and inefficient plans.  </p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for the query or for individual plan steps differ significantly.
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Plan Stability to Set the Desired Execution Plan</i></b></p>    <br><p class="detailTblTxt3">Plan stability preserves execution plans in stored outlines. An outline is implemented as a set of optimizer hints that are associated with the SQL statement. If the use of the outline is enabled for the statement, Oracle automatically considers the stored hints and tries to generate an execution plan in accordance with those hints.<br>
<br>The performance of a statement is improved without modifying the statement (assuming an outline can be created with the hints that generate a better plan).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; Depending on the circumstance, sometimes an outline for a query is easily generated and used. The easiest case is when a better plan is generated simply by changing an initialization parameter and an outline is captured for the query.<br>
In other cases, it is difficult to obtain the plan and capture it for the outline.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the outline will only affect the associated query.  The outline should be associated with a category that enables one to easily disable the outline if desired.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">Using Plan Stability</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">Stored Outline Quick Reference</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=122812.1">How to Tune a Query that Cannot be Modified</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=102311.1">How to Move Stored Outlines for One Application from One Database to Another</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use dynamic sampling to obtain accurate selectivity estimates</i></b></p>    <br><p class="detailTblTxt3">The purpose of dynamic sampling is to improve server performance by determining more accurate estimates for predicate selectivity and statistics for tables and indexes. The statistics for tables and indexes include table block counts, applicable index block counts, table cardinalities, and relevant join column statistics. These more accurate estimates allow the optimizer to produce better performing plans.<br>
<br>
You can use dynamic sampling to:<br>
<ul class="detailTblTxt3">
<li>Estimate single-table predicate selectivities when collected statistics cannot be used or are likely to lead to significant errors in estimation.</li>
<li>Estimate statistics for tables and relevant indexes without statistics.</li>
<li>Estimate statistics for tables and relevant indexes whose statistics are too out of date to trust.</li>
</ul>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; Dynamic sampling can be turned on at the instance, session, or query level.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Depending on the level, dynamic sampling can consume system resources (I/O bandwidth, CPU) and increase query parse time.  Its is best used as an intermediate step to find a better execution plan which can then be hinted or captured with an outline.  </p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1496">When to Use Dynamic Sampling</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1498">How to Use Dynamic Sampling to Improve Performance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Available Indexes are too unselective.</i></b></p>    <br><p class="detailTblTxt3">None of the available indexes are selective enough to be useful.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">TBD</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Implicit data type conversion in the query</i></b></p>    <br><p class="detailTblTxt3">If the datatypes of two values being compared are different, then Oracle has to implement type conversion on one of the values to enable comparisons to be made. This is called implicit type conversion. Typically this causes problems when developers store numbers in character columns. At runtime oracle is forced to convert one of the values and (due to fixed rules) places a to_number around the indexed character column. Adding any function to an indexed column prevents use of the index. The fact that Oracle has to do this type conversion is an indication of a design problem with the application. Because conversion is performed on EVERY ROW RETRIEVED, this will also result in a performance hit. 
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">An index exists that satisfies the predicate, but the execution plan's predicate info shows a data type conversion and an "ACCESS" operation.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Eliminate implicit data type conversion</i></b></p>    <br><p class="detailTblTxt3">Eliminating implicit data type conversions will allow the CBO to use an index if its available and potentially improve performance. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort.  Either the query will need to be re-written to use the same datatype that is stored in the table, or the table and index will need to be modified to reflect the way its used in queries.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; The risk is low if only the query is changed.  If the table and index are modified, other queries may be affected.  The change should be thoroughly tested before implementing in production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_1016.htm#sthref1089">Avoid Transformed Columns in the WHERE Clause </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No index has the required columns as <i>leading</i> columns of the index</i></b></p>    <br><p class="detailTblTxt3">Oracle usually needs to have the leading columns of the index supplied in the query predicate.  In some versions, a "skip scan" access method is possible if an index's leading columns are not in the predicate, but this method is only useful in special cases (where the leading columns have few distinct values).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">TBD</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   A function is used on a column in the query's predicate which prevents the use of an index</i></b></p>    <br><p class="detailTblTxt3">A function on a column in the predicate will prevent the use of an index unless a function-based index is available.  For example:<br>
<br>
use: WHERE a.order_no = b.order_no<br>
<br>
rather than:<br>
<br>
WHERE TO_NUMBER (SUBSTR(a.order_no, INSTR(b.order_no, '.') - 1))
= TO_NUMBER (SUBSTR(a.order_no, INSTR(b.order_no, '.') - 1))
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">If the query is performing a full table scan or is using an undesirable index, examine the query's predicate for columns involved in functions.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a function-based index</i></b></p>    <br><p class="detailTblTxt3">Function-based indexes provide an efficient mechanism for evaluating statements that contain functions in their WHERE clauses. The value of the expression is computed and stored in the index. When it processes INSERT and UPDATE statements, however, Oracle must still evaluate the function to process the statement.  The use of a function-based index will often avoid a full table scan and lead to better performance (when a small number of rows from a rowsource are desired).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; requires the creation of an index using the function used in the query and setting an initialization parameter.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The function-based index will typically be used by a very small set of queries.  There is some risk of a performance regression when performing bulk DML operations due to the application of the index function on each value inserted into the index.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/schema.htm#sthref928">Function-based Indexes</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i9946">Using Function-based Indexes for Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_indexing.htm#sthref598">When to Use Function-Based Indexes</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Re-write the query to permit the use of an existing index</i></b></p>    <br><p class="detailTblTxt3">Rewrite the query to avoid the use of SQL functions in predicate clauses or WHERE clauses. Any expression using a column, such as a function having the column as its argument, causes the optimizer to ignore the possibility of using an index on that column, even a unique index, unless there is a function-based index defined that can be used.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; assuming the query can be modified, it involves rewriting it to avoid the use of functions.  Often, this could mean changing the way the data is stored which would involve changes to the underlying table, indexes, and client software.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; if just the query is changed, the risk is low.  However, if the query change is accompanied by changes in tables, indexes, and client software, other queries may suffer regressions (although in general, this change will improve the design across the board).  An impact analysis should be performed and the changes should be thoroughly tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_1016.htm#sthref1086">Avoid Transformed Columns in the WHERE Clause</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   The index's cluster factor is too high</i></b></p>    <br><p class="detailTblTxt3">When an index is used to access a table's blocks, the optimizer takes into account the cost of accessing the table in addition to the cost of accessing the index.  This is computed using something called the <i>cluster factor</i>.  The cluster factor is a measure of how closely the rows in the index are ordered relative to the order of the rows in the table.  When the rows in the index are ordered closely with those in the table, the cluster factor is low and thus access to the table's blocks will be less expensive since adjacent rows of the index will be found in the table's blocks that are likely already cached.  If the rows in the table are not well ordered compared to the order of the index (cluster factor will be high), then access to the table will be much more expensive.  The CBO will estimate this cost using the cluster factor; thus, indexes with high cluster factors tend to appear more costly to the CBO and may not be chosen.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><p>In the 10053 trace, compare the cost of the chosen access path to the index access path that is desired.  The index access cost is calculated as follows:</p>
<blockquote><p><i>Total index access cost = index cost + table cost</p>
<blockquote><p>Index cost = # of Levels + (index selectivity * Index leaf blocks) <br>
Table cost = table selectivity * cluster factor </i></p>
</blockquote>
</blockquote>
<p>From the table cost equation, you can see that a large cluster factor will easily dominate the  total index access cost and will lead the CBO to chose a different index or a full table scan.</p>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Load the data in the table in key order</i></b></p>    <br><p class="detailTblTxt3">When the table's data is inserted in the same order as one of its indexes (the one of use to the query that needs tuning), it will cost less to access the table based on the rows identified by the index.  This will be reflected in the clustering factor and the CBO's cost estimate for using the index.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High effort; it is usually non-trivial to recreate a table or change the insert process so that rows are inserted according to a particular order.  Sometimes its not even possible to do because of the nature of the application.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High risk; although the change in the way rows are stored in the table may benefit a certain query using a particular index, it may actually cause other queries to perform worse if they benefited from the former order.  An impact analysis should be performed and the application tested prior to implementing in production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The simplest way to reorder the table is to do the following:<br>
<br>
CREATE TABLE new AS SELECT * FROM old ORDER BY b,d; <br>
<br>
Then, rename NEW to OLD. <br>
<br>
If the table is loaded via SQLLOAD or a custom loader, it may be possible to change the way the input files are loaded.
</p>    <br><p class="detailTblTxt3"> Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=39836.1">Clustering Factor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=223117.1">Tuning I/O-related waits</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use an Index-Organized Table (IOT)</i></b></p>    <br><p class="detailTblTxt3">Index-organized tables provide faster access to table rows by the primary key or any key that is a valid prefix of the primary key. Presence of non-key columns of a row in the B-tree leaf block itself avoids an additional block access. Also, because rows are stored in primary key order, range access by the primary key (or a valid prefix) involves minimum block accesses.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">An IOT is easily created using the CREATE TABLE command.  There may be some downtime costs when building the IOT (exporting data from the old table, dropping the old table, creating the new table).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk.  IOTs are not a substitute for tables in every case.  Very large rows can cause the IOT to have deep levels in the B-tree which increase I/Os.<br>
Since the IOT is organized along one key order, it may not provide a competitive cluster factor value for secondary indexes created on it.  The value of the IOT should be tested against all of the queries that reference the table.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/schema.htm#CNCPT911">Benefits of Index-Organized Tables </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/tables.htm#ADMIN01506">Managing Index-Organized Tables </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a hint that is preventing the use of indexes</i></b></p>    <br><p class="detailTblTxt3">The query has one of the following hints: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  These hints may be set to choose no indexes, or an inferior index the CBO would not have chosen.<br><br>In some cases, the FULL hint may be used to suppress the use of all indexes on a table.  Existing hints should be viewed with some skepticism when tuning (their presence doesn't mean they were optimal in the first place or that they're still relevant).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Query contains an access path hint and performs a full table scan or uses an index that does not perform well.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Index hint is being ignored</i></b></p>    <br><p class="detailTblTxt3">Index hints may be ignored due to syntax errors in the hints, forgetting to use table aliases, or because it may be semantically impossible to use the index (due to selected join orders or types)</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Hint is specified in the query but execution plan shows it is not being used.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Correct common problems with hints</i></b></p>    <br><p class="detailTblTxt3">There are various reasons why a hint may be ignored.  Please see the resources below for guidance.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; The effort to correct a hint problem could range from a simple spelling correction to trying to find a workaround for  semantic error that makes the use of a hint impossible.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the query of interest.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=286360.1">How To Avoid Join Method Hints Being Ignored</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>CBO expects the query to return many rows, but only first few rows are actually desired by users</b></i></p>    <br><p class="detailTblTxt3">The query will return many rows, but users are only interested in the first few (usually less than 100) rows.  This is very common for OLTP applications or web-based applications as opposed to batch or reporting applications.<br><br>
In this case, the optimizer needs to know that the query will be used in this way in order to generate a better plan.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Users are only interested in the first few rows (typically less than 100)</li>
<li>The query can return many more rows than the first few rows desired</li>
<li>The optimizer mode is ALL_ROWS or CHOOSE</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect OPTIMIZER_MODE being used</i></b></p>    <br><p class="detailTblTxt3">The OPTIMIZER_MODE is used to tell the CBO whether the application desires to use all of the rows estimated to be returned by the query or just a small number.  This will affect how the CBO approaches the execution plan and how it estimates the costs of access methods and join types.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">OPTIMIZER_MODE is ALL_ROWS or CHOOSE<br><br>
Look for the SQL in V$SQL and calculate the following:<br><br>
<blockquote>
Avg Rows per Execution = V$SQL.ROWS_PROCESSED / V$SQL.EXECUTIONS
</blockquote>
<br>If this value is typically less than 1000 rows, then the optimizer may need to know how many rows are typically desired per execution.
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use the FIRST_ROWS or FIRST_ROWS_N optimizer mode</i></b></p>    <br><p class="detailTblTxt3">The FIRST_ROWS or FIRST_ROWS_K optimizer modes will bias the CBO to look for plans that cost less when a small number of rows are expected.  This often produces better plans for OLTP applications because rows are fetched quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The change involves hints or initialization parameters</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The risk depends on the scope of the change.  if just a hint is used, then the risk of impacting other queries is low; whereas if the initialization parameter is used, the impact may be widespread.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following links for more detail:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">FIRST_ROWS(n) hint description</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams145.htm#sthref610">OPTIMIZER_MODE initialization parameter</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=154354.1">Fast response optimization (FIRST_ROWS variants)</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Few rows are expected but many rows are returned</b></i></p>    <br><p class="detailTblTxt3">Few rows are expected but many rows are returned.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">Many rows are returned (greater than a few percent of the total rows)</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Cartesian product is occurring due to missing join predicates</i></b></p>    <br><p class="detailTblTxt3">Some tables in the query are missing join predicates.  When this happens, Oracle will return a cartesian product of the tables resulting in many rows being returned (and generally undesirable results).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Tables in the FROM clause do not have the proper join clauses.  You may need to consult the data model to determine the correct way to join the tables.  </li>
<li>Rows in the result set have many columns</li>
</ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Add the appropriate join predicate for the query</i></b></p>    <br><p class="detailTblTxt3">Review the join predicates and ensure all required predicates are present</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; depending on the complexity of the query and underlying data model, identifying the missing predicate may be easy or difficult.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the additional predicate affects only the query.  If not specified properly, the additional predicate may not return the expected values.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Requires understanding of the joins and data model to troubleshoot.  The solution is simply to add a join predicate.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Many rows expected to be returned by the query  (typically decision support apps)</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
When many rows are expected, full table scans or full index scans are usually more appropriate than index scans (unique or range).  If you know that many rows need to be returned or processed, look for inappropriate use of indexes.	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Full index scan used against a large index</b></i></p>    <br><p class="detailTblTxt3">An INDEX FULL SCAN access method is used against a large table (not an INDEX FAST FULL SCAN).</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The execution plan shows INDEX SCAN on a table (view the plan using SQLTXPLAIN).</li>
<li>The table is large (see the NUM_ROWS and BLOCKS value in the SQLTXPLAIN report)</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Optimizer mode or hint set to FIRST_ROWS or FIRST_ROWS_K</i></b></p>    <br><p class="detailTblTxt3">When optimizer mode is set to FIRST_ROWS or FIRST_ROWS_K, the optimizer will favor the use of indexes to retrieve rows quickly.  This mode will result in a very inefficient plan If many rows are actually desired from the query.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The optimizer mode may be set in a hint, such as "/*+ FIRST_ROWS_1 */ "</li>
<li>The optimizer mode may be set in an initialization parameter, such as "OPTIMIZER_MODE=FIRST_ROWS_1".  Sometimes a session may have its initialization parameters set through a LOGON trigger - the 10053 trace will show whether this parameter was set or not.
<li>The TKProf will show the optimizer mode used for each statement</li></ul></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Try using the ALL_ROWS hint</i></b></p>    <br><p class="detailTblTxt3">If most of the rows from the query are desired (not just the first few that are returned), then the ALL_ROWS hint may allow the CBO to find better execution plans than the FIRST_ROWS_N mode which will produce plans that return rows promptly, but will not be as efficient for retrieving all of the rows.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simply add the hint to the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The hint will affect only the query where its applied.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The hint syntax is:<br>
/*+ ALL_ROWS */
<br></p>    <br><p class="detailTblTxt3">For reference, see:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">ALL_ROWS hint</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   INDEX FULL SCAN used to avoid a sort operation</i></b></p>    <br><p class="detailTblTxt3">The CBO will cost the effort needed to returns rows in order (due to an ORDER BY).  Sometimes the estimated cost of using a FULL INDEX SCAN (rows returned in key order) will be cheaper than doing a sort.  This estimation may be incorrect and lead to a bad use of the INDEX FULL SCAN operation.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>The execution plan shows the operation, "INDEX FULL SCAN"</li>
<li>The predicate corresponding to the "INDEX FULL SCAN" operation shows the columns - those columns are the ones used in the ORDER BY clause</li>
</ol><br>
<p>You might be able to quickly confirm if not using this index helps, by modifying the test query to use the "/*+ NO_INDEX(...) */" hint.</p>
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use the NO_INDEX or ALL_ROWS  hint</i></b></p>    <br><p class="detailTblTxt3">If the CBO's choice of using a particular index was incorrect (assuming statistics were properly collected), it may be possible to improve the plan by using the following hints:<br>
<ul class="detailTblTxt3">
<li>NO_INDEX : suppress the use of the index; this is usually enough to change the plan to avoid the FULL INDEX SCAN</li>
<li>ALL_ROWS : if FIRST_ROWS_N is being used, the use of the index may be attractive to the CBO for returning rows in order quickly.  If this isn't really desired (you want ALL of the rows in the shortest time), the ALL_ROWS hint will help the CBO cost the sort better.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; if the query can be modified, adding the hint is trivial.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; only affects the query being tuned.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67409.1">When will an ORDER BY statement use an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50411">NO_INDEX hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50301">ALL_ROWS hint</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use PGA_AGGREGATE_TARGET to optimize session memory</i></b></p>    <br><p class="detailTblTxt3">The use of an INDEX FULL SCAN operation may be due to a small SORT_AREA_SIZE.  The CBO will consider the cost of satisfying the ORDER BY using the INDEX FULL SCAN if there is insufficient PGA memory for sorting.  In Oracle8i administrators sized the PGA by carefully adjusting a number of initialization parameters, such as, SORT_AREA_SIZE, HASH_AREA_SIZE, BITMAP_MERGE_AREA_SIZE, and CREATE_BITMAP_AREA_SIZE, etc. <br>
<br>
Beginning with 9i, Oracle provides an option to completely automate the management of PGA memory. Administrators merely need to specify the maximum amount of PGA memory available to an instance using a newly introduced initialization parameter 
PGA_AGGREGATE_TARGET. The database server automatically distributes this memory among various active queries in an intelligent manner so as to ensure maximum performance benefits and the most efficient utilization of memory. Furthermore, Oracle9i can adapt itself to changing workload thus utilizing resources efficiently regardless of the load on the system. The amount of the PGA memory available to an instance can be changed dynamically by altering the value of the 
PGA_AGGREGATE_TARGET parameter making it possible to add to and remove PGA memory from an active instance online. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The auto-PGA management feature may be activated easily.  Some tuning of this will be needed, but it is not difficult.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the change will affect the entire instance, but in general, many queries should see their performance improve as memory is allocated more intelligently to the PGA (as long as the overall amount isn't set too small).</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Refer to the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/memory.htm#i49320">PGA Memory Management</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=223730.1">Automatic PGA Memory Management in 9i</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>The query processes or returns many rows</b></i></p>    <br><p class="detailTblTxt3">The query either returns many rows or there are steps in the execution plan that must operate on very large tables</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Large number of rows returned.</li>
<li>The execution plan shows full table scan operations on large tables, hash / merge joins, or sorts / sort aggregate to compute some values.</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Missing filter predicate</i></b></p>    <br><p class="detailTblTxt3">A missing filter predicate may cause many more rows to be processed or returned than would otherwise.  If the large number of rows is unexpected, a filter predicate may have been forgotten when the query was written.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Examine the predicate (WHERE clause) to see if any tables are missing a filter condition.  Discuss or observe how the data from this query is used by end-users.  See if end-users need to filter data on their client or only use a few rows out of the entire result set.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Review the intent of the query and ensure a predicate isn't missing</i></b></p>    <br><p class="detailTblTxt3">If the number of rows returned is unexpectedly high, its possible that part of the predicate is missing.  With a smaller number of rows returned, the CBO may choose an index that can retrieve the rows quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; usually requires coordination with developers to examine the query</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the solution applies to the query and won't affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Review the predicate and ensure it isn't missing a filter or join criteria.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   A large number of rows must be processed for this query</i></b></p>    <br><p class="detailTblTxt3">The query must indeed process many rows and must be tuned for processing large amounts of data</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">There is a business need for the large volume of data.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use parallel execution / parallel DML</i></b></p>    <br><p class="detailTblTxt3">If sufficient resources exist, the work can be split using parallel execution (PX)  to complete the work in a short time.  PX should be considered as a solution after the query has been thoroughly tuned- it shouldn't be the first choice in speeding up a query.  <br>
<br>
PX works best in cases where a large number of rows must be processed in a timely manner, such as data warehousing or batch operations.  OLTP applications with short transactions ( a few seconds) are not good candidates for PX.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; it is fairly simple to use parallel execution for a query, but some research and testing may need to be done regarding available resources to ensure PX performs well and doesn't exhaust machine resources.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the use of PX may affect all users on the machine and other queries (if a table or index's degree was changed).</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/usingpe.htm#i1009828">Using Parallel Execution</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/ex_plan.htm#sthref1885">Viewing Parallel Execution with EXPLAIN PLAN </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1619">Parallel Execution Hints on Views </a></p>    <br><p class="detailTblTxt3">Troubleshooting Documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=280939.1">Checklist for Performance Problems with Parallel Execution</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237287.1">How To Verify Parallel Execution is running</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=233754.1">Why doesn't my query run in parallel?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=201978.1">Restrictions on Parallel DML</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=263414.1">Find Parallel Statements which are Candidates for tuning</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Ensure array processing is used</i></b></p>    <br><p class="detailTblTxt3">Array processing allows Oracle to process many rows at the same time.  It is most commonly used when fetching so that rather than fetch one row at a time and send each one back to the client, Oracle will fetch a set of them and return the set back to the client in one call (usually 10 or more).  Array processing is a more efficient way to manage queries that involve many rows and significant performance improvements occur when using it.  Large array sizes mean that Oracle can do more work per call to the database and often greatly reduces time spent waiting for context switching, network latency, block pinning, and logical reads. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; set at the session level in the client.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; very large array fetch sizes may use a large amount of PGA memory as well as cause a perceived degradation in performance for queries that only need a few rows at a time.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Depends on the language used by the client.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14357/ch12040.htm#i2698625">SQLPlus Arraysize variable</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14407/pc_08arr.htm#g20885">Pro*C / C++ : Host Arrays</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14407/pc_14ady.htm#sthref1901">Pro*C / C++ : Using Arrays for Bulk Operations</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_packages.htm#sthref851">PL/SQL : Bulk Binds</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use materialized views and query rewrite to use data that has already been summarized</i></b></p>    <br><p class="detailTblTxt3">A materialized view is like a query with a result that is materialized and stored in a table. When a user query is found compatible with the query associated with a materialized view, the user query can be rewritten in terms of the materialized view. This technique improves the execution of the user query, because most of the query result has been pre-computed. The query transformer looks for any materialized views that are compatible with the user query and selects one or more materialized views to rewrite the user query. The use of materialized views to rewrite a query is cost-based. That is, the query is not rewritten if the plan generated without the materialized views has a lower cost than the plan generated with the materialized views.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; creating the materialized view is not difficult, but some considerations must be given to whether and how it should be created and maintained (fast refresh vs. complete, refresh interval, storage requirements).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the CBO will rewrite a query to use the materialized view instead of accessing the base tables in the query.  Some queries that are performing well may change and use the materialized view (generally this should be an improvement).  The implementation must be thoroughly tested before deploying  to production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/basicmv.htm#i1007299">Basic Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=76673.1">What are Materialized Views?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=106024.1">Using Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/advmv.htm#i1007694">Advanced Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/qrbasic.htm#i1008297">Basic Query Rewrite</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">- - - - - C.  Examine the Join Order and Join Types </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="100%" class="detailMainTxt">
<p>The join order can have a huge impact on the performance of a query.  The optimal join order is usually one where the fewest rows are returned earliest in the plan.  The CBO tries to start join orders with tables that it believes will only return one row.  If this estimate is wrong, the wrong table may be chosen and the performance of the query may be impacted.</p>
<p>The choice of join type is also important.  Nested loop joins are desirable when just a few rows are desired quickly and join columns are indexed.  Hash joins are typically very good at joining large tables, returning many rows, or joining columns that don't have indexes.</p>
<p><b>Data Required for Analysis</b></p>
<ul>
<li>Source: Execution plan (gathered in "Data Collection", part A)
<ul>
<li>Actual number of rows returned by the query or an execution plan that shows actual and estimated rows per plan step.</li>
<li>Estimated number of rows returned by the query ("Estim Card" or similar)  from the execution plan</li>
<li>Determine if there is a large discrepancy between the actual and estimated rows</li>
</ul>
</li><br>
<li>Source: SQLTXPLAIN report (gathered in "Data Collection", part B)
<ul>
<li>Execution plan showing the execution order in the "Exec Order" column (usable only if SQLTXPLAIN's plan matches the one collected in "Data Collection", part A)</li>
</ul>
</li><br>
<li>Source: SQLTXPLAIN report, Optimizer Trace section, "Parameters Used by the Optimizer"</li>
</ul>
    </td>  </tr>  <tr>    <td width="100%" class="detailEmptyLine">&nbsp;</td>  </tr>  </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Join Order Issues</li></ol><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Incorrect join order; the first few tables being joined return more rows than later tables</b></i></p>    <br><p class="detailTblTxt3">The actual rows returned from tables earliest in the join order are much higher than tables joined later. It is very critical to start the join order with the table that will return the fewest rows and then join to the table returning the next fewest rows, and so on.  The table returning the fewest rows is not necessarily the smallest table because even a huge table may only return one row when predicates of the query are applied to the table.  Conversely, a smaller table may have no predicates applied to it and return many rows.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">The estimated vs. actual cardinality for one or more tables in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the each table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan steps).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect selectivity / cardinality estimate for the <i>first</i> table  in a join</i></b></p>    <br><p class="detailTblTxt3">The CBO is not estimating the cardinality of the first table in the join order.  This could drastically affect the performance of the query because this error will cascade into subsequent join orders and lead to bad choices for the join type and access paths.<br>
The estimate may be bad due to missing statistics (see the Statistics and Parameters section above) or a bad assumption about the predicates of the query having non-overlapping data.  Oracle is unable to use statistics to detect overlapping data values in complex predicates without the use of "dynamic sampling".</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for the first table in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the first table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan step).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect join selectivity / cardinality estimate</i></b></p>    <br><p class="detailTblTxt3">The CBO must estimate the cardinality of each join in the plan.  The estimate will be used in each subsequent join for costing the various types of joins (and makes a significant impact to the cost of nested loop joins). <br>
When this estimate is wrong, the costing of subsequent joins in the plan may be very inaccurate.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for one or more tables in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the each table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan steps).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use dynamic sampling to obtain accurate selectivity estimates</i></b></p>    <br><p class="detailTblTxt3">The purpose of dynamic sampling is to improve server performance by determining more accurate estimates for predicate selectivity and statistics for tables and indexes. The statistics for tables and indexes include table block counts, applicable index block counts, table cardinalities, and relevant join column statistics. These more accurate estimates allow the optimizer to produce better performing plans.<br>
<br>
You can use dynamic sampling to:<br>
<ul class="detailTblTxt3">
<li>Estimate single-table predicate selectivities when collected statistics cannot be used or are likely to lead to significant errors in estimation.</li>
<li>Estimate statistics for tables and relevant indexes without statistics.</li>
<li>Estimate statistics for tables and relevant indexes whose statistics are too out of date to trust.</li>
</ul>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; Dynamic sampling can be turned on at the instance, session, or query level.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Depending on the level, dynamic sampling can consume system resources (I/O bandwidth, CPU) and increase query parse time.  Its is best used as an intermediate step to find a better execution plan which can then be hinted or captured with an outline.  </p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1496">When to Use Dynamic Sampling</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1498">How to Use Dynamic Sampling to Improve Performance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Initialization parameter "OPTIMIZER_MAX_PERMUTATIONS" is too low for the number of tables in the join</i></b></p>    <br><p class="detailTblTxt3">When a large number of tables are joined together, the CBO may not be able to try all permutations because the parameter "OPTIMIZER_MAX_PERMUTATIONS" is too low.  Some join orders might have been better than the chosen one if the CBO had been given enough chances to try costing them.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">If the value of "OPTIMIZER_MAX_PERMUTATIONS" is less than the factorial of the number of tables in a join (e.g., if number of tables in the join is 5, 5 factorial is 5*4*3*2*1 or 120), this may be the cause for the bad join order.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Increase the value of "OPTIMIZER_MAX_PERMUTATIONS" or "OPTIMIZER_SEARCH_LIMIT"</i></b></p>    <br><p class="detailTblTxt3">Queries with more than 6 tables (depending on the database version) may require the optimizer to cost more join order permutations than the default settings allow.  These additional permutations may yield a lower cost and better performing plan.<br>
<br>
<b>Note: in version 10g or later, this parameter is obsolete.</b></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply an initialization parameter change.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; will generally result in better plans and can be tested at the session level.  The highest risk is in increasing parse times for queries with more than 6 tables in a join.  The increased parse time will be attributed to CPU usage while the optimizer looks for additional join orders.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the links below.</p>    <br><p class="detailTblTxt3">Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=73489.1">Affect of Number of Tables on Join Order Permutations</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=66030.1">Relationship between OPTIMIZER_MAX_PERMUTATIONS and OPTIMIZER_SEARCH_LIMIT</a></p>    <br><p class="detailTblTxt3">Parameter is obsolete in 10g:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14238/changes.htm">Upgrade Guide, Appendix A</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Join Type Issues</li></ol><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Query or rowsource returns many rows, but nested loop join chosen</b></i></p>    <br><p class="detailTblTxt3">Nested loop joins enable fast retrieval of a small number of rows.  They do not perform well when many rows will be retrieved.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">NA</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL hint that is not appropriate</i></b></p>    <br><p class="detailTblTxt3">The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL, FIRST_ROWS, or FIRST_ROWS_K hint that is favoring NL</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</li>
<li>The query has a FIRST_ROWS or FIRST_ROWS_K hint that is causing the CBO to favor index access and NL join types</li>
</ul>
<br>Remove the hints or avoid the use of the index by adding a NOINDEX() hint; NL joins will usually not be "cost competitive" when indexes are not available to the CBO.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" valign="top" align="left">&nbsp;</td> <td width="95%" class="detailSubHdrTxt">- - - - - D.  Examine Other Operations (parallelism, etc) </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Parallel Execution</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
<p><b>Data Required for Analysis</b>:</p>
<ul>
<li>Source:  Execution plan showing parallel information; collected in "Data Collection", part A.</li>
</ul>	</td>	</tr>	</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <p><b>Note:</b> This list shows some common observations and causes but is not a complete list.  If you do not find a possible cause in this list, you can always open a service request with Oracle to investigate other possible causes.  Please see the section below called, "Open a Service Request with Oracle Support Services". </p> </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Degree of parallelism is wrong or unexpected</b></i></p>    <br><p class="detailTblTxt3">This problem occurs when the requested degree of parallelism is different from what Oracle actually uses for the query.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Execution plan shows fewer slaves allocated than requested</li>
<li>_px_trace reports a smaller degree of parallelism than requested</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No parallel slaves available for the query</i></b></p>    <br><p class="detailTblTxt3">No parallel slaves were available so the query executed in serial mode.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Event 10392, level 1 shows that the PX coordinator was enable to get enough slaves (at least 2).</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Additional CPUs are needed</i></b></p>    <br><p class="detailTblTxt3">Additional CPUs may be needed to allow enough sessions to use PX.  If manual PX tuning is used, you will have to increase the value of  PARALLEL_MAX_SERVERS after adding the  CPUs.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; adding CPUs may involve downtime depending on the high availability architecture employed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; adding additional CPUs should only improve performance and scalability in this case.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Hardware addition, no details provided here.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Parallelism occurs but is not desired</b></i></p>    <br><p class="detailTblTxt3">The query runs best in serial mode or you are trying to avoid parallel mode due to a lack of available resources when the query is executed by many users simultaneously.  The query is observed to be executing in parallel.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Execution plan shows parallel operations</li>
<li>You see parallel slaves associated with your session</li>
</ul></p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Hints or configuration settings causing parallel plans</i></b></p>    <br><p class="detailTblTxt3">The CBO will attempt to use parallel operations if the following are set or used:
<ul class="detailTblTxt3">
<li>Parallel hint: <i>parallel(t1, 4)</i>
<li>ALTER SESSION FORCE PARALLEL</li>
<li>Setting a degree of parallel and/or the number of instances on a table or index in a query </li>
</ul>
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Examine the 10053 trace and check the parallel degree for tables and presence of hints in the query.  The presence of any of these is justification for this cause.</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/usingpe.htm#CACCAGCH">Summary of Parallelization Rules</a></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove parallel hints</i></b></p>    <br><p class="detailTblTxt3">The statement is executing in parallel due to parallel hints.  Removing these hints may allow the statement to run serially.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the hint from the statement.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk, only affects the statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Remove one or more hints of the type:<br>
<ul class="detailTblTxt3">
<li>PARALLEL</li>
<li>PARALLEL_INDEX</li>
<li>PQ_DISTRIBUTE </li>
</ul>
<br>
If one of the tables has a degree greater than 1, the query may still run in parallel.</p>    <br><p class="detailTblTxt3">Hint information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1619">Hints for Parallel Execution </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Alter a table or index's degree of parallelism</i></b></p>    <br><p class="detailTblTxt3">A table or index in the query has its degree (of parallelism) set higher than 1.  This may be one factor causing the query to execute in parallel.  If the parallel plan is not performing well, a serial plan may be obtained by changing the degree.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the object may be changed with an ALTER command.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; other queries may be running in parallel due to the degree setting and will revert to a serial plan.  
An impact analysis should be performed to determine the effect of this change on other queries.<br>
<br>The ALTER command will invalidate cursors that depend on the table or index and may cause a spike in library cache contention - the change should be done during a period of low activity.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7002.htm#i2159323">Parallel clause for the CREATE and ALTER TABLE / INDEX statements</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-style:double; border-width:6; border-collapse: collapse" bgcolor="#DDDBC5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><i><b>Query executed serially, parallel plan was desired.</b></i></p>    <br><p class="detailTblTxt3">The query was not running in parallel.  The performance of the query was slower due to serial execution.</p>    <br><p class="detailTblTxt3"><b><i>What to look for</i></b></p>    <br><p class="detailTblTxt3">After executing the query, Check V$PQ_SESSTAT.LAST_QUERY for the statistic "queries parallelized".  If it is 0 then the query did not run in parallel.
</p><br> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No parallel slaves available for the query</i></b></p>    <br><p class="detailTblTxt3">No parallel slaves were available so the query executed in serial mode.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Event 10392, level 1 shows that the PX coordinator was enable to get enough slaves (at least 2).</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p><p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="96%" border="1" cellpadding="0" cellspacing="0"  style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Additional CPUs are needed</i></b></p>    <br><p class="detailTblTxt3">Additional CPUs may be needed to allow enough sessions to use PX.  If manual PX tuning is used, you will have to increase the value of  PARALLEL_MAX_SERVERS after adding the  CPUs.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; adding CPUs may involve downtime depending on the high availability architecture employed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; adding additional CPUs should only improve performance and scalability in this case.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Hardware addition, no details provided here.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
<p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> </div> <p class="detailTblEmptyLine">&nbsp;</p><br> </td> </tr> </table> </td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><br></td> <td width="25%" valign="top"><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Documentation</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_tune.htm#i22019">    10g: Automatic SQL Tuning</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_1016.htm#sthref1060">    SQL Tuning Overview</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/optimops.htm#i21299">    The Query Optimizer</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams141.htm#sthref594">    Parameter: OPTIMIZER_DYNAMIC_SAMPLING</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams142.htm#sthref597">    Parameter: OPTIMIZER_FEATURES_ENABLE</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams143.htm#sthref602">    Parameter: OPTIMIZER_INDEX_CACHING</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams144.htm#sthref607">    Parameter: OPTIMIZER_INDEX_COST_ADJ</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50801">    Hint:  PARALLEL</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50706">    Hint:  MERGE</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50507">    Hint:  NO_MERGE</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50907">    Hint:  PUSH_PRED</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50909">    Hint:  PUSH_SUBQ</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50905">    Hint:  UNNEST</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">    Using Plan Stability (Stored Outlines)</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">    Stored Outline Quick Reference</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">How To</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=233112.1">    Diagnosing Query Tuning Problems</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=169935.1">    Troubleshooting Oracle Applications Performance Issues</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=122812.1">    How to Tune a Query that Cannot be Modified</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=102311.1">    How to Move Stored Outlines for One Application from One Database to Another</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href=" http://www.oracle.com">    SQLTXPLAIN report: How to determine if an index should be created</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href=" http://www.oracle.com">    How to compare actual and estimated cardinalities in each step of the execution plan</a></li>    </td>  </tr>  </table>  <br><table width="100%" height="46" border="1" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#A6B3C8" bgcolor="#EEF3F7">  <tr>   <td width="100%">    <p align="left" class="detailTblHdr">Reference Notes</td>  </tr>  <tr>    <td width="100%" valign="top">      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=46234.1">    Interpreting Explain plan</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">    Using Plan Stability (Stored Outlines)</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">    Stored Outline Quick Reference</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">    Diagnosing Why a Query is Not Using an Index</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=73489.1">    Affect of Number of Tables on Join Order Permutations</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=280939.1">    Checklist for Performance Problems with Parallel Execution</a></li>      <li class="detailTblBullet">    <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=196938.1">    Why did my query go parallel?</a></li>  </table></td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Open a Service Request with Oracle Support Services">Open a Service Request with Oracle Support Services</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">  <tr>    <td width="3%"  class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">
<p>If you would like to stop at this point and receive assistance from Oracle Support Services, please do the following:</p>
<ul>
<li>Please copy and paste the following into the SR:<br>
<blockquote>
Last Diagnostic Step = Performance_Diagnostic_Guide.QTune.Cause_Determination.Data_Analysis
</blockquote>
<li>Enter the problem statement and how the issue has been verified</li>
<li>Upload into the SR:
<ul>
<li> Extended SQL trace (event 10046 trace) (Identify the Issue, Data Collection)</li>
<li>Execution Plan (Determine a Cause, Data Collection, part A)</li>
<li>SQLTXPLAIN report (Determine a Cause, Data Collection, part B)</li>
<li>Any other data collected (e.g., awrsqlrpt report)</li>
<li>(optionally) RDA collection</li>
</ul>
</ul>
<p>The more data you collect ahead of time and upload to Oracle, the fewer round trips will be required for this data and the quicker the problem will be resolved.</p>
<p><a target="detailWindow" href="https://support.oracle.com/epmos/faces/SrCreate">Click here to log your service request</a></p>
    </td>  </tr>  <tr>    <td width="3%" class="detailMainTxt">&nbsp;</td>    <td width="97%" class="detailMainTxt">&nbsp;</td>  </tr>  </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table><p class=pagebreak>&nbsp;</p>
<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">		<tr>      <td width="100%" colspan="4">      <p class="htmlHdr"><a name="Query Tuning &gt; Reference">Query Tuning &gt; Reference</a></p>      <p class="htmlHdr">&nbsp;</p>		</td></tr>		</table><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">     <tr>     <td width="100%" class="detailMainTxt"><h2><b>Cause / Solution Reference</h2></b>
The reference page contains a summary of common causes and solutions. </td>   </tr> </table> <br> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Optimizer Mode, Statistics, and Initialization Parameters">Optimizer Mode, Statistics, and Initialization Parameters</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Optimizer Mode</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No statistics gathered (pre10g)</i></b></p>    <br><p class="detailTblTxt3">Oracle will default to the RBO when none of the objects in the query have any statistics.  In 10g and to some extent in 9.2, Oracle will use the CBO with dynamic sampling and avoid the RBO.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
The execution plan will not display estimated cardinality or cost if RBO is used.  In general, RBO will be used in the following cases (see references for more detail):<br><br>
No "exotic" (post 8.x) features like partitioning, IOTs, parallelism, etc AND:
<ul class="detailTblTxt3">
<li>Pre 9.2.x: <br>
-  OPTIMIZER_MODE = CHOOSE.  Confirm by looking at TKProf, "Optimizer Mode: CHOOSE" for the query<br>
-  and, no statistics on ANY table.  Confirm this by looking at each table in SQLTXPLAIN and checking for a NULL value in the "LAST ANALYZED" column</li>
<li>9.2x + : <br>
-  OPTIMIZER_MODE = CHOOSE or RULE<br>
-  and, dynamic sampling disabled (set to level 0 via hint or parameter)<br>
-  and, no statistics on ANY table.  Confirm this by looking at each table in SQLTXPLAIN and checking for a NULL value in the "LAST ANALYZED" column</li>
</ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameter "optimizer mode" set to RULE</i></b></p>    <br><p class="detailTblTxt3">The optimizer_mode parameter will cause Oracle to use the RBO even if statistics are gathered on some or all objects in the query.  If a feature such as parallel execution or partitioning is used, then the query will switch over to the CBO.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
The execution plan will not display estimated cardinality or cost if RBO is used.  In general, RBO will be used in the following cases (see references for more detail):<br><br>
No "exotic" (post 8.x) features like partitioning, IOTs, parallelism, etc AND:
<ul class="detailTblTxt3">
<li>Pre 9.2.x: optimizer_mode = choose and no statistics on ANY table</li>
<li>9.2x + : optimizer_mode = choose or rule and dynamic sampling disabled</li>
</ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Migrate from the RBO to the CBO</i></b></p>    <br><p class="detailTblTxt3">The RBO is no longer supported and many features since 8.0 do not use it.  The longer term strategy for Oracle installations is to use the CBO.  This will ensure the highest level of support and the most efficient plans when using new features.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Migrating to the CBO can be a high or low effort task depending on the amount of risk you are willing to tolerate.  The lowest effort involves simply changing the "OPTIMIZER_MODE" initialization parameter and gathering statistics on objects, but the less risky approaches take more effort to ensure execution plans don't regress.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Risk depends on the effort placed in localizing the migration (to a single query, session, or application at a time).  The highest risk for performance regressions involve using the init.ora "OPTIMIZER_MODE" parameter.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The most cautious approach involves adding a hint to the query that is performing poorly.  The hint can be "FIRST_ROWS_*" or "ALL_ROWS" depending on the expected number of rows.  If the query can't be changed, then it may be possible to limit the change to CBO to just a certain session using a LOGON trigger.<br>
<br>
See the following links for more detail:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#i12916">Moving from RBO to the Query Optimizer</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://www.oracle.com/technology/products/manageability/database/pdf/ow05/PS_S997_273997_106-1_FIN_v2.pdf">Optimizing the Optimizer: Essential SQL Tuning Tips and Techniques, see the section "Avoiding Plan Regressions after Database Upgrades"</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect OPTIMIZER_MODE being used</i></b></p>    <br><p class="detailTblTxt3">The OPTIMIZER_MODE is used to tell the CBO whether the application desires to use all of the rows estimated to be returned by the query or just a small number.  This will affect how the CBO approaches the execution plan and how it estimates the costs of access methods and join types.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">OPTIMIZER_MODE is ALL_ROWS or CHOOSE<br><br>
Look for the SQL in V$SQL and calculate the following:<br><br>
<blockquote>
Avg Rows per Execution = V$SQL.ROWS_PROCESSED / V$SQL.EXECUTIONS
</blockquote>
<br>If this value is typically less than 1000 rows, then the optimizer may need to know how many rows are typically desired per execution.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use the FIRST_ROWS or FIRST_ROWS_N optimizer mode</i></b></p>    <br><p class="detailTblTxt3">The FIRST_ROWS or FIRST_ROWS_K optimizer modes will bias the CBO to look for plans that cost less when a small number of rows are expected.  This often produces better plans for OLTP applications because rows are fetched quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The change involves hints or initialization parameters</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The risk depends on the scope of the change.  if just a hint is used, then the risk of impacting other queries is low; whereas if the initialization parameter is used, the impact may be widespread.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following links for more detail:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">FIRST_ROWS(n) hint description</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams145.htm#sthref610">OPTIMIZER_MODE initialization parameter</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=154354.1">Fast response optimization (FIRST_ROWS variants)</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Optimizer mode or hint set to FIRST_ROWS or FIRST_ROWS_K</i></b></p>    <br><p class="detailTblTxt3">When optimizer mode is set to FIRST_ROWS or FIRST_ROWS_K, the optimizer will favor the use of indexes to retrieve rows quickly.  This mode will result in a very inefficient plan If many rows are actually desired from the query.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The optimizer mode may be set in a hint, such as "/*+ FIRST_ROWS_1 */ "</li>
<li>The optimizer mode may be set in an initialization parameter, such as "OPTIMIZER_MODE=FIRST_ROWS_1".  Sometimes a session may have its initialization parameters set through a LOGON trigger - the 10053 trace will show whether this parameter was set or not.
<li>The TKProf will show the optimizer mode used for each statement</li></ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Try using the ALL_ROWS hint</i></b></p>    <br><p class="detailTblTxt3">If most of the rows from the query are desired (not just the first few that are returned), then the ALL_ROWS hint may allow the CBO to find better execution plans than the FIRST_ROWS_N mode which will produce plans that return rows promptly, but will not be as efficient for retrieving all of the rows.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simply add the hint to the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The hint will affect only the query where its applied.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The hint syntax is:<br>
/*+ ALL_ROWS */
<br></p>    <br><p class="detailTblTxt3">For reference, see:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">ALL_ROWS hint</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Statistics in General</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Missing or inadequate statistics</i></b></p>    <br><p class="detailTblTxt3">
<ul class="detailTblTxt3">
<li>Missing Statistics</li> 
     <ul class="detailTblTxt3">
          <li>Statistics were never gathered for tables in the query</li>
          <li>Gathering was not &quot;cascaded&quot; down to indexes</li>
     </ul>
 <li>Inadequate sample size</li>
     <ul class="detailTblTxt3">
          <li>The sample size was not sufficient to allow the CBO to compute selectivity values accurately</li>
     </ul>
      <ul class="detailTblTxt3">
          <li>Histograms not collected on columns involved in the query predicate that have skewed values</li>
      </ul>
</ul></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
One or more of the following may justify the need for better statistics collection:
<ul class="detailTblTxt3">
<li>Missing table statistics:  DBA_TABLES.LAST_ANALYZED is NULL </li>
<li>Missing index statistics:  For indexes belonging to each table: DBA_INDEX.LAST_ANALYZED is NULL </li>
<li>Inadequate sample size for tables: DBA_TABLES.SAMPLE_SIZE / # of rows in the table < 5%</li>
<li>Inadequate sample size for indexes: DBA_INDEXES.SAMPLE_SIZE / # of rows in the table < 30%</li>
<li>Histograms not collected: for each table in the query, no rows in DBA_TAB_HISTOGRAMS for the columns having skewed data</li>
<li>Inadequate number of histograms buckets: For each table in the query, less than 255 rows in DBA_TAB_HISTOGRAMS for the columns having skewed data</li>
</ul>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Unreasonable table stat values were manually set</i></b></p>    <br><p class="detailTblTxt3">Someone either miscalculated or misused DBMS_STATS.SET_STATISTICS</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Check the SQLTXPLAIN report, "Table" or "Index" columns, look for the column "User Stats".  If this is YES", then the stats were entered directly by users through the DBMS_STATS.SET_*_STATS procedure.</li>
<br>
<li>Outrageous statistics values are usually associated with very inaccurate estimated cardinality for the query.  You can also examine the statistics by looking at things like the number of rows and comparing them to the actual number of rows in the table (SQLTXPLAIN will list both for each table and index).<br><br>
One approach to confirming this is to export the current statistics on certain objects, gather fresh statistics and compare the two (avoid doing this on  a production system).</li>
</ul>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   The tables have undergone extreme DML changes; stats are old</i></b></p>    <br><p class="detailTblTxt3">The table has changed dramatically since the stats were collected due to large DML activity.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">
You can determine if significant DML activity has occurred against certain tables in the query by looking in the SQLTXPLAIN report and comparing the "Current COUNT" with the "Num Rows".  If there is a large difference, the statistics are stale.<br><br>
You can also look in the DBA_TAB_MODIFICATIONS table to see how much DML has occurred against tables since statistics were last gathered.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p><p class="detailMainTxt">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Histograms</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Long VARCHAR2 strings are exact up to the 32 character position</i></b></p>    <br><p class="detailTblTxt3">The histogram endpoint algorithm for character strings looks at the first 32 characters only.  If those characters are exactly the same for many columns, the histograms will not be accurate.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Observe the histogram endpoint values for the column in the SQLTXPLAIN report under the heading "Table Histograms".  Many, if not all, endpoint values will be indistinguishable from each other.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Data skewing is such that the maximum bucket resolution doesn't help</i></b></p>    <br><p class="detailTblTxt3">The histogram buckets must have enough resolution to catch the skewed data.  This usually means at least two endpoints must have the same value in order to be detected as a "popular" (skewed) value.  Skewing goes undetected when the number of samples in each bucket is so large that truly skewed values are buried inside the bucket.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Check the following for the column suspected of having skewed data:
<ol>
<li>A crude way to confirm there is skewed data is by running this query:<br>
SELECT AVG(col1)/((MIN(col1)+MAX(col1))/2) skew_factor FROM table1
<br>
<i>col1, table1</i> refers to the column/table that has skewed data. <br>
</li>
<li>Examine the output of the query for skewing; when the "skew_factor" is much less than or much greater than 1.0, there is some skewing.</li>
<li>Look at the endpoint values for the column in SQLTXPLAIN ("Table Histograms" section) and check if "popular" values are evident in the bucket endpoints (a popular value will have the same endpoint repeated in 2 or more buckets - these are skewed values)</li>
<li>If the histogram has 254 buckets and doesn't show any popular buckets, then this cause is justified.</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Manually set histogram statistics to reflect the skewing in the column's data </i></b></p>    <br><p class="detailTblTxt3">The histogram will need to be manually defined according to the following method
<ol>
  <li>Find the values where skewing occurs most severely</li>
  <li>Use DBMS_STATS.SET_TABLE_STATS to enter the endpoints and endpoint values representing the skewed data values</li>
</ol>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High effort; It will take some effort to determine what the endpoint values should be and then set them using DBMS_STATS.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; By altering statistics manually, there is a chance that a miscalculation or mistake may affect many queries in the system.  The change may also destabilize good plans.]</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Details for this solution are not yet available.
</p>    <br><p class="detailTblTxt3">Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=72539.1">Interpreting Histogram Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="4">Parameters</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing full table scans and merge/hash joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to affect the CBO's cost estimates :<br><li>optimizer_index_cost_adj set much higher than 100</li><li>db_file_multiblock_read_count set too high (greater than 1MB / db_block_size) </li><li>optimizer_mode=all_rows</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans, merge/hash joins occurring and above parameters not set to default values.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing index scans and nested loop joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to bias the CBO towards index scans and nested loop joins :<br><li>optimizer_index_cost_adj set much lower than 100</li><li>db_file_multiblock_read_count set too low (smaller than 1MB / db_block_size) </li><li>optimizer_index_caching set too high</li><li>optimizer_mode=first_rows (or first_rows_N)</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Index scans and nested loop joins occurring and above parameters not set to default values.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Init.ora parameters not set for Oracle Applications 11i</i></b></p>    <br><p class="detailTblTxt3">Oracle Applications 11i requires certain database initialization parameters to be set according to specific recommendations</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Oracle Applications 11i in use and init.ora parameters not set accordingly</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Set Database Initialization Parameters for Oracle Applications 11i</i></b></p>    <br><p class="detailTblTxt3">Oracle Applications 11i have strict requirements for database initialization parameters that must be followed.  The use of these parameters generally result in much better performance for the queries used by Oracle Apps.  This is a minimum step required when tuning Oracle Apps.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply set the parameters as required.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; these parameters have been extensively tested by Oracle for use with the Apps.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the notes below.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=216205.1">Database Initialization Parameters and Configuration for Oracle Applications 11i</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=174605.1">bde_chk_cbo.sql - Reports Database Initialization Parameters related to an Apps 11i instance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Initialization parameter "OPTIMIZER_MAX_PERMUTATIONS" is too low for the number of tables in the join</i></b></p>    <br><p class="detailTblTxt3">When a large number of tables are joined together, the CBO may not be able to try all permutations because the parameter "OPTIMIZER_MAX_PERMUTATIONS" is too low.  Some join orders might have been better than the chosen one if the CBO had been given enough chances to try costing them.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">If the value of "OPTIMIZER_MAX_PERMUTATIONS" is less than the factorial of the number of tables in a join (e.g., if number of tables in the join is 5, 5 factorial is 5*4*3*2*1 or 120), this may be the cause for the bad join order.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Increase the value of "OPTIMIZER_MAX_PERMUTATIONS" or "OPTIMIZER_SEARCH_LIMIT"</i></b></p>    <br><p class="detailTblTxt3">Queries with more than 6 tables (depending on the database version) may require the optimizer to cost more join order permutations than the default settings allow.  These additional permutations may yield a lower cost and better performing plan.<br>
<br>
<b>Note: in version 10g or later, this parameter is obsolete.</b></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply an initialization parameter change.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; will generally result in better plans and can be tested at the session level.  The highest risk is in increasing parse times for queries with more than 6 tables in a join.  The increased parse time will be attributed to CPU usage while the optimizer looks for additional join orders.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the links below.</p>    <br><p class="detailTblTxt3">Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=73489.1">Affect of Number of Tables on Join Order Permutations</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=66030.1">Relationship between OPTIMIZER_MAX_PERMUTATIONS and OPTIMIZER_SEARCH_LIMIT</a></p>    <br><p class="detailTblTxt3">Parameter is obsolete in 10g:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14238/changes.htm">Upgrade Guide, Appendix A</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Access Path">Access Path</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Index Not Used</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">
This table lists common causes for cases where the CBO did NOT choose an index (and an index was thought to be optimal).	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing full table scans and merge/hash joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to affect the CBO's cost estimates :<br><li>optimizer_index_cost_adj set much higher than 100</li><li>db_file_multiblock_read_count set too high (greater than 1MB / db_block_size) </li><li>optimizer_mode=all_rows</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans, merge/hash joins occurring and above parameters not set to default values.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   CBO costs a full table scan cheaper than a series of index range scans</i></b></p>    <br><p class="detailTblTxt3">The CBO determines that it is cheaper to do a full table scan than to expand the IN list / OR into separate query blocks where each one uses an index.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans in the execution plan instead of a set of index range scans (one per value) with a CONCATENATION operation.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Implement the USE_CONCAT hint to force the optimizer to use indexes and avoid a full table scan</i></b></p>    <br><p class="detailTblTxt3">This hint will force the use of an index (supplied with the hint) instead of using a full table scan (FTS).  For certain combinations of IN LIST and OR predicates in queries with tables of a certain size, the use of an index may be far superior to an FTS on a large table.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; simply use the hint in the statement (assuming you can alter the statement).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; will only affect the single statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the notes below.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=17214.1">Using the USE_CONCAT hint with IN/OR Statements</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No index available for columns in the predicate</i></b></p>    <br><p class="detailTblTxt3">No indexes have been defined for one or more columns in the query predicate.  Oracle only has a full table scan access method available in this case.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>For each column in the query's WHERE clause, check that there is an index available.  In some cases, multiple columns from a table will be in the WHERE clause - ideally, there is an index defined with these columns as the leading columns of the index.</li>
<li>Examine the execution plan in the SQLTXPLAIN report and look for predicates using the "FILTER()" function rather than the "ACCESS()" function.  Predicates obtained via ACCESS() were obtained using an index (more efficiently and directly), whereas those obtained via FILTER() where obtained by applying a condition to a row source after the data was obtained.</li>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Available Indexes are too unselective.</i></b></p>    <br><p class="detailTblTxt3">None of the available indexes are selective enough to be useful.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">TBD</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Implicit data type conversion in the query</i></b></p>    <br><p class="detailTblTxt3">If the datatypes of two values being compared are different, then Oracle has to implement type conversion on one of the values to enable comparisons to be made. This is called implicit type conversion. Typically this causes problems when developers store numbers in character columns. At runtime oracle is forced to convert one of the values and (due to fixed rules) places a to_number around the indexed character column. Adding any function to an indexed column prevents use of the index. The fact that Oracle has to do this type conversion is an indication of a design problem with the application. Because conversion is performed on EVERY ROW RETRIEVED, this will also result in a performance hit. 
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">An index exists that satisfies the predicate, but the execution plan's predicate info shows a data type conversion and an "ACCESS" operation.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Eliminate implicit data type conversion</i></b></p>    <br><p class="detailTblTxt3">Eliminating implicit data type conversions will allow the CBO to use an index if its available and potentially improve performance. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort.  Either the query will need to be re-written to use the same datatype that is stored in the table, or the table and index will need to be modified to reflect the way its used in queries.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; The risk is low if only the query is changed.  If the table and index are modified, other queries may be affected.  The change should be thoroughly tested before implementing in production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_1016.htm#sthref1089">Avoid Transformed Columns in the WHERE Clause </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No index has the required columns as <i>leading</i> columns of the index</i></b></p>    <br><p class="detailTblTxt3">Oracle usually needs to have the leading columns of the index supplied in the query predicate.  In some versions, a "skip scan" access method is possible if an index's leading columns are not in the predicate, but this method is only useful in special cases (where the leading columns have few distinct values).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">TBD</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   10g+ : Use the SQL Access Advisor for Index Recommendations</i></b></p>    <br><p class="detailTblTxt3">The SQL Access Advisor recommends bitmap, function-based, and B-tree indexes. A bitmap index offers a reduced response time for many types of ad hoc queries and reduced storage requirements compared to other indexing techniques. B-tree indexes are most commonly used in a data warehouse to index unique or near-unique keys.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; available through Enterprise Manager's GUI or via command line PL/SQL interface.  </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; changes to indexes should be tested in a test system before implementing in production because they may affect many other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Please see the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/license.102/b14199/options.htm#CIHIGHAH">Tuning Pack Licensing Information</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   A function is used on a column in the query's predicate which prevents the use of an index</i></b></p>    <br><p class="detailTblTxt3">A function on a column in the predicate will prevent the use of an index unless a function-based index is available.  For example:<br>
<br>
use: WHERE a.order_no = b.order_no<br>
<br>
rather than:<br>
<br>
WHERE TO_NUMBER (SUBSTR(a.order_no, INSTR(b.order_no, '.') - 1))
= TO_NUMBER (SUBSTR(a.order_no, INSTR(b.order_no, '.') - 1))
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">If the query is performing a full table scan or is using an undesirable index, examine the query's predicate for columns involved in functions.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a function-based index</i></b></p>    <br><p class="detailTblTxt3">Function-based indexes provide an efficient mechanism for evaluating statements that contain functions in their WHERE clauses. The value of the expression is computed and stored in the index. When it processes INSERT and UPDATE statements, however, Oracle must still evaluate the function to process the statement.  The use of a function-based index will often avoid a full table scan and lead to better performance (when a small number of rows from a rowsource are desired).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; requires the creation of an index using the function used in the query and setting an initialization parameter.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The function-based index will typically be used by a very small set of queries.  There is some risk of a performance regression when performing bulk DML operations due to the application of the index function on each value inserted into the index.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/schema.htm#sthref928">Function-based Indexes</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i9946">Using Function-based Indexes for Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_indexing.htm#sthref598">When to Use Function-Based Indexes</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Re-write the query to permit the use of an existing index</i></b></p>    <br><p class="detailTblTxt3">Rewrite the query to avoid the use of SQL functions in predicate clauses or WHERE clauses. Any expression using a column, such as a function having the column as its argument, causes the optimizer to ignore the possibility of using an index on that column, even a unique index, unless there is a function-based index defined that can be used.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; assuming the query can be modified, it involves rewriting it to avoid the use of functions.  Often, this could mean changing the way the data is stored which would involve changes to the underlying table, indexes, and client software.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; if just the query is changed, the risk is low.  However, if the query change is accompanied by changes in tables, indexes, and client software, other queries may suffer regressions (although in general, this change will improve the design across the board).  An impact analysis should be performed and the changes should be thoroughly tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/sql_1016.htm#sthref1086">Avoid Transformed Columns in the WHERE Clause</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   The index's cluster factor is too high</i></b></p>    <br><p class="detailTblTxt3">When an index is used to access a table's blocks, the optimizer takes into account the cost of accessing the table in addition to the cost of accessing the index.  This is computed using something called the <i>cluster factor</i>.  The cluster factor is a measure of how closely the rows in the index are ordered relative to the order of the rows in the table.  When the rows in the index are ordered closely with those in the table, the cluster factor is low and thus access to the table's blocks will be less expensive since adjacent rows of the index will be found in the table's blocks that are likely already cached.  If the rows in the table are not well ordered compared to the order of the index (cluster factor will be high), then access to the table will be much more expensive.  The CBO will estimate this cost using the cluster factor; thus, indexes with high cluster factors tend to appear more costly to the CBO and may not be chosen.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><p>In the 10053 trace, compare the cost of the chosen access path to the index access path that is desired.  The index access cost is calculated as follows:</p>
<blockquote><p><i>Total index access cost = index cost + table cost</p>
<blockquote><p>Index cost = # of Levels + (index selectivity * Index leaf blocks) <br>
Table cost = table selectivity * cluster factor </i></p>
</blockquote>
</blockquote>
<p>From the table cost equation, you can see that a large cluster factor will easily dominate the  total index access cost and will lead the CBO to chose a different index or a full table scan.</p>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Load the data in the table in key order</i></b></p>    <br><p class="detailTblTxt3">When the table's data is inserted in the same order as one of its indexes (the one of use to the query that needs tuning), it will cost less to access the table based on the rows identified by the index.  This will be reflected in the clustering factor and the CBO's cost estimate for using the index.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High effort; it is usually non-trivial to recreate a table or change the insert process so that rows are inserted according to a particular order.  Sometimes its not even possible to do because of the nature of the application.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">High risk; although the change in the way rows are stored in the table may benefit a certain query using a particular index, it may actually cause other queries to perform worse if they benefited from the former order.  An impact analysis should be performed and the application tested prior to implementing in production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The simplest way to reorder the table is to do the following:<br>
<br>
CREATE TABLE new AS SELECT * FROM old ORDER BY b,d; <br>
<br>
Then, rename NEW to OLD. <br>
<br>
If the table is loaded via SQLLOAD or a custom loader, it may be possible to change the way the input files are loaded.
</p>    <br><p class="detailTblTxt3"> Related documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=39836.1">Clustering Factor</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=223117.1">Tuning I/O-related waits</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use an Index-Organized Table (IOT)</i></b></p>    <br><p class="detailTblTxt3">Index-organized tables provide faster access to table rows by the primary key or any key that is a valid prefix of the primary key. Presence of non-key columns of a row in the B-tree leaf block itself avoids an additional block access. Also, because rows are stored in primary key order, range access by the primary key (or a valid prefix) involves minimum block accesses.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">An IOT is easily created using the CREATE TABLE command.  There may be some downtime costs when building the IOT (exporting data from the old table, dropping the old table, creating the new table).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk.  IOTs are not a substitute for tables in every case.  Very large rows can cause the IOT to have deep levels in the B-tree which increase I/Os.<br>
Since the IOT is organized along one key order, it may not provide a competitive cluster factor value for secondary indexes created on it.  The value of the IOT should be tested against all of the queries that reference the table.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14220/schema.htm#CNCPT911">Benefits of Index-Organized Tables </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14231/tables.htm#ADMIN01506">Managing Index-Organized Tables </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a hint that is preventing the use of indexes</i></b></p>    <br><p class="detailTblTxt3">The query has one of the following hints: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  These hints may be set to choose no indexes, or an inferior index the CBO would not have chosen.<br><br>In some cases, the FULL hint may be used to suppress the use of all indexes on a table.  Existing hints should be viewed with some skepticism when tuning (their presence doesn't mean they were optimal in the first place or that they're still relevant).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Query contains an access path hint and performs a full table scan or uses an index that does not perform well.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Index hint is being ignored</i></b></p>    <br><p class="detailTblTxt3">Index hints may be ignored due to syntax errors in the hints, forgetting to use table aliases, or because it may be semantically impossible to use the index (due to selected join orders or types)</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Hint is specified in the query but execution plan shows it is not being used.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Correct common problems with hints</i></b></p>    <br><p class="detailTblTxt3">There are various reasons why a hint may be ignored.  Please see the resources below for guidance.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; The effort to correct a hint problem could range from a simple spelling correction to trying to find a workaround for  semantic error that makes the use of a hint impossible.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the query of interest.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the related documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=286360.1">How To Avoid Join Method Hints Being Ignored</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect OPTIMIZER_MODE being used</i></b></p>    <br><p class="detailTblTxt3">The OPTIMIZER_MODE is used to tell the CBO whether the application desires to use all of the rows estimated to be returned by the query or just a small number.  This will affect how the CBO approaches the execution plan and how it estimates the costs of access methods and join types.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">OPTIMIZER_MODE is ALL_ROWS or CHOOSE<br><br>
Look for the SQL in V$SQL and calculate the following:<br><br>
<blockquote>
Avg Rows per Execution = V$SQL.ROWS_PROCESSED / V$SQL.EXECUTIONS
</blockquote>
<br>If this value is typically less than 1000 rows, then the optimizer may need to know how many rows are typically desired per execution.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use the FIRST_ROWS or FIRST_ROWS_N optimizer mode</i></b></p>    <br><p class="detailTblTxt3">The FIRST_ROWS or FIRST_ROWS_K optimizer modes will bias the CBO to look for plans that cost less when a small number of rows are expected.  This often produces better plans for OLTP applications because rows are fetched quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The change involves hints or initialization parameters</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The risk depends on the scope of the change.  if just a hint is used, then the risk of impacting other queries is low; whereas if the initialization parameter is used, the impact may be widespread.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following links for more detail:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">FIRST_ROWS(n) hint description</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14237/initparams145.htm#sthref610">OPTIMIZER_MODE initialization parameter</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=154354.1">Fast response optimization (FIRST_ROWS variants)</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No Index Available for columns in the predicate</i></b></p>    <br><p class="detailTblTxt3">An index is needed to avoid a FTS.  The index may never have been created or might have been dropped accidentally.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>For each column in the query's WHERE clause, check that there is an index available.  In some cases, multiple columns from a table will be in the WHERE clause - ideally, there is an index defined with these columns as the leading columns of the index.</li>
<li>Examine the execution plan in the SQLTXPLAIN report and look for predicates using the "FILTER()" function rather than the "ACCESS()" function.  Predicates obtained via ACCESS() were obtained using an index (more efficiently and directly), whereas those obtained via FILTER() where obtained by applying a condition to a row source after the data was obtained.</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create a new index or re-create an existing index</i></b></p>    <br><p class="detailTblTxt3">The performance of the query will greatly improve if few rows are expected and an index may be used to retrieve those rows.  The column(s) in the  predicate which filter the rows down should be in the leading part of an index.  Indexes may need to be created or recreated for the following reasons:<br>
<ul class="detailTblTxt3">
<li>A column in the predicate is not indexed; if it were, a full table scan would be avoided</li>
<li>The columns in the predicate are indexed, but the key order (in a composite index) should be rearranged to make the index more selective</li>
<li>For columns that have few distinct values and are not updated frequently, a bitmap (vs. B-tree) index would be better</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; Simply drop and recreate an index or create a new index.  However, the application may need to be down to avoid affecting it if an existing index must be dropped and recreated. <br>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium; the recreated index may change some execution plans since it will be slightly bigger and its contribution to the cost of a query will be larger.  On the other hand, the created index may be more compact than the one it replaces since it will not have many deleted keys in its leaf blocks.<br>
<br>
A newly created index may cause other query's plans to change if it is seen as a  lower cost alternative (typically this should result in better performance).<br>
<br>
The DDL to create or recreate the index may cause some cursors to be invalidated which might lead to a spike in library cache latch contention; ideally, the DDL is issued during a time of low activity.<br>
<br>
This change should be thoroughly tested before implementing on a production system.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">If an index would reduce the time to retrieve rows for the query, its best to review existing indexes and see if any of them can be rebuilt with  additional column(s) that would cause the index to be used.  Otherwise, a new index may have to be created.  Please note that adding indexes will add some overhead during DML operations and should be created judiciously.<br>
<br>
See the links below for information on creating indexes.</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/advisor.htm#sthref1652">10g+ : Consult the SQL Access Advisor</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i2678">Understanding Index Performance</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67522.1">Diagnosing Why a Query is Not Using an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/data_acc.htm#i17778">Using Indexes and Clusters</a></p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_5010.htm#i2062403">SQL Reference: CREATE INDEX</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Missing filter predicate</i></b></p>    <br><p class="detailTblTxt3">A missing filter predicate may cause many more rows to be processed or returned than would otherwise.  If the large number of rows is unexpected, a filter predicate may have been forgotten when the query was written.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Examine the predicate (WHERE clause) to see if any tables are missing a filter condition.  Discuss or observe how the data from this query is used by end-users.  See if end-users need to filter data on their client or only use a few rows out of the entire result set.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Review the intent of the query and ensure a predicate isn't missing</i></b></p>    <br><p class="detailTblTxt3">If the number of rows returned is unexpectedly high, its possible that part of the predicate is missing.  With a smaller number of rows returned, the CBO may choose an index that can retrieve the rows quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; usually requires coordination with developers to examine the query</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the solution applies to the query and won't affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Review the predicate and ensure it isn't missing a filter or join criteria.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Full Table Scan is Used</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">This table lists common causes for cases where the CBO chose an FTS (and the use of FTS seems to be sub-optimal).<br>
This is related to the cause section above, "Index was NOT used", where you will also find causes when FTS was chosen over an index path. However, the causes in this section are specific to the undesired use of FTS.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing full table scans and merge/hash joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to affect the CBO's cost estimates :<br><li>optimizer_index_cost_adj set much higher than 100</li><li>db_file_multiblock_read_count set too high (greater than 1MB / db_block_size) </li><li>optimizer_mode=all_rows</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Full table scans, merge/hash joins occurring and above parameters not set to default values.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   A large number of rows must be processed for this query</i></b></p>    <br><p class="detailTblTxt3">The query must indeed process many rows and must be tuned for processing large amounts of data</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">There is a business need for the large volume of data.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use parallel execution / parallel DML</i></b></p>    <br><p class="detailTblTxt3">If sufficient resources exist, the work can be split using parallel execution (PX)  to complete the work in a short time.  PX should be considered as a solution after the query has been thoroughly tuned- it shouldn't be the first choice in speeding up a query.  <br>
<br>
PX works best in cases where a large number of rows must be processed in a timely manner, such as data warehousing or batch operations.  OLTP applications with short transactions ( a few seconds) are not good candidates for PX.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; it is fairly simple to use parallel execution for a query, but some research and testing may need to be done regarding available resources to ensure PX performs well and doesn't exhaust machine resources.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the use of PX may affect all users on the machine and other queries (if a table or index's degree was changed).</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/usingpe.htm#i1009828">Using Parallel Execution</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/ex_plan.htm#sthref1885">Viewing Parallel Execution with EXPLAIN PLAN </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1619">Parallel Execution Hints on Views </a></p>    <br><p class="detailTblTxt3">Troubleshooting Documents:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=280939.1">Checklist for Performance Problems with Parallel Execution</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237287.1">How To Verify Parallel Execution is running</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=233754.1">Why doesn't my query run in parallel?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=201978.1">Restrictions on Parallel DML</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=263414.1">Find Parallel Statements which are Candidates for tuning</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Ensure array processing is used</i></b></p>    <br><p class="detailTblTxt3">Array processing allows Oracle to process many rows at the same time.  It is most commonly used when fetching so that rather than fetch one row at a time and send each one back to the client, Oracle will fetch a set of them and return the set back to the client in one call (usually 10 or more).  Array processing is a more efficient way to manage queries that involve many rows and significant performance improvements occur when using it.  Large array sizes mean that Oracle can do more work per call to the database and often greatly reduces time spent waiting for context switching, network latency, block pinning, and logical reads. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; set at the session level in the client.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; very large array fetch sizes may use a large amount of PGA memory as well as cause a perceived degradation in performance for queries that only need a few rows at a time.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Depends on the language used by the client.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14357/ch12040.htm#i2698625">SQLPlus Arraysize variable</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14407/pc_08arr.htm#g20885">Pro*C / C++ : Host Arrays</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14407/pc_14ady.htm#sthref1901">Pro*C / C++ : Using Arrays for Bulk Operations</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14251/adfns_packages.htm#sthref851">PL/SQL : Bulk Binds</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use materialized views and query rewrite to use data that has already been summarized</i></b></p>    <br><p class="detailTblTxt3">A materialized view is like a query with a result that is materialized and stored in a table. When a user query is found compatible with the query associated with a materialized view, the user query can be rewritten in terms of the materialized view. This technique improves the execution of the user query, because most of the query result has been pre-computed. The query transformer looks for any materialized views that are compatible with the user query and selects one or more materialized views to rewrite the user query. The use of materialized views to rewrite a query is cost-based. That is, the query is not rewritten if the plan generated without the materialized views has a lower cost than the plan generated with the materialized views.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; creating the materialized view is not difficult, but some considerations must be given to whether and how it should be created and maintained (fast refresh vs. complete, refresh interval, storage requirements).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the CBO will rewrite a query to use the materialized view instead of accessing the base tables in the query.  Some queries that are performing well may change and use the materialized view (generally this should be an improvement).  The implementation must be thoroughly tested before deploying  to production.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/basicmv.htm#i1007299">Basic Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=76673.1">What are Materialized Views?</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=106024.1">Using Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/advmv.htm#i1007694">Advanced Materialized Views</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/qrbasic.htm#i1008297">Basic Query Rewrite</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p><p class="detailMainTxt">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Full Table Scan is Not Used</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">This table lists common causes for cases where the CBO did NOT choose an FTS (and the use of FTS would have been optimal).	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   INDEX FULL SCAN used to avoid a sort operation</i></b></p>    <br><p class="detailTblTxt3">The CBO will cost the effort needed to returns rows in order (due to an ORDER BY).  Sometimes the estimated cost of using a FULL INDEX SCAN (rows returned in key order) will be cheaper than doing a sort.  This estimation may be incorrect and lead to a bad use of the INDEX FULL SCAN operation.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>The execution plan shows the operation, "INDEX FULL SCAN"</li>
<li>The predicate corresponding to the "INDEX FULL SCAN" operation shows the columns - those columns are the ones used in the ORDER BY clause</li>
</ol><br>
<p>You might be able to quickly confirm if not using this index helps, by modifying the test query to use the "/*+ NO_INDEX(...) */" hint.</p>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use the NO_INDEX or ALL_ROWS  hint</i></b></p>    <br><p class="detailTblTxt3">If the CBO's choice of using a particular index was incorrect (assuming statistics were properly collected), it may be possible to improve the plan by using the following hints:<br>
<ul class="detailTblTxt3">
<li>NO_INDEX : suppress the use of the index; this is usually enough to change the plan to avoid the FULL INDEX SCAN</li>
<li>ALL_ROWS : if FIRST_ROWS_N is being used, the use of the index may be attractive to the CBO for returning rows in order quickly.  If this isn't really desired (you want ALL of the rows in the shortest time), the ALL_ROWS hint will help the CBO cost the sort better.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; if the query can be modified, adding the hint is trivial.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; only affects the query being tuned.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67409.1">When will an ORDER BY statement use an Index</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50411">NO_INDEX hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50301">ALL_ROWS hint</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use PGA_AGGREGATE_TARGET to optimize session memory</i></b></p>    <br><p class="detailTblTxt3">The use of an INDEX FULL SCAN operation may be due to a small SORT_AREA_SIZE.  The CBO will consider the cost of satisfying the ORDER BY using the INDEX FULL SCAN if there is insufficient PGA memory for sorting.  In Oracle8i administrators sized the PGA by carefully adjusting a number of initialization parameters, such as, SORT_AREA_SIZE, HASH_AREA_SIZE, BITMAP_MERGE_AREA_SIZE, and CREATE_BITMAP_AREA_SIZE, etc. <br>
<br>
Beginning with 9i, Oracle provides an option to completely automate the management of PGA memory. Administrators merely need to specify the maximum amount of PGA memory available to an instance using a newly introduced initialization parameter 
PGA_AGGREGATE_TARGET. The database server automatically distributes this memory among various active queries in an intelligent manner so as to ensure maximum performance benefits and the most efficient utilization of memory. Furthermore, Oracle9i can adapt itself to changing workload thus utilizing resources efficiently regardless of the load on the system. The amount of the PGA memory available to an instance can be changed dynamically by altering the value of the 
PGA_AGGREGATE_TARGET parameter making it possible to add to and remove PGA memory from an active instance online. </p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The auto-PGA management feature may be activated easily.  Some tuning of this will be needed, but it is not difficult.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; the change will affect the entire instance, but in general, many queries should see their performance improve as memory is allocated more intelligently to the PGA (as long as the overall amount isn't set too small).</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Refer to the following documents:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/memory.htm#i49320">PGA Memory Management</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=223730.1">Automatic PGA Memory Management in 9i</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Parameters causing index scans and nested loop joins</i></b></p>    <br><p class="detailTblTxt3">The following parameters are known to bias the CBO towards index scans and nested loop joins :<br><li>optimizer_index_cost_adj set much lower than 100</li><li>db_file_multiblock_read_count set too low (smaller than 1MB / db_block_size) </li><li>optimizer_index_caching set too high</li><li>optimizer_mode=first_rows (or first_rows_N)</li></p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Index scans and nested loop joins occurring and above parameters not set to default values.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Reset parameters to default settings</i></b></p>    <br><p class="detailTblTxt3">Changing certain non-default initialization parameter settings could improve the query.  However, this should be done in a session (rather than at the database level in the init.ora or spfile) first and you must consider the impact of this change on other queries.  If the parameter cannot be changed due to the effect on other queries, you may need to use outlines or hints to improve the plan.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simple change of initialization parameter(s).  However, care should be taken to test the effects of this change and these tests may take considerable effort.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblHighBG">      <p align="center"><b>H</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Initialization parameter changes have the potential of affecting many other queries in the database, so the risk may be high.  Risk can be mitigated through testing on a test system or  in a session, if possible.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Various notes describe the important parameters that influence the CBO, see the links below:</p>    <br><p class="detailTblTxt3"></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390034.1">TBW: Parameters affecting the optimizer and their default values</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Optimizer mode or hint set to FIRST_ROWS or FIRST_ROWS_K</i></b></p>    <br><p class="detailTblTxt3">When optimizer mode is set to FIRST_ROWS or FIRST_ROWS_K, the optimizer will favor the use of indexes to retrieve rows quickly.  This mode will result in a very inefficient plan If many rows are actually desired from the query.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The optimizer mode may be set in a hint, such as "/*+ FIRST_ROWS_1 */ "</li>
<li>The optimizer mode may be set in an initialization parameter, such as "OPTIMIZER_MODE=FIRST_ROWS_1".  Sometimes a session may have its initialization parameters set through a LOGON trigger - the 10053 trace will show whether this parameter was set or not.
<li>The TKProf will show the optimizer mode used for each statement</li></ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Try using the ALL_ROWS hint</i></b></p>    <br><p class="detailTblTxt3">If most of the rows from the query are desired (not just the first few that are returned), then the ALL_ROWS hint may allow the CBO to find better execution plans than the FIRST_ROWS_N mode which will produce plans that return rows promptly, but will not be as efficient for retrieving all of the rows.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Simply add the hint to the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The hint will affect only the query where its applied.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">The hint syntax is:<br>
/*+ ALL_ROWS */
<br></p>    <br><p class="detailTblTxt3">For reference, see:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDFIAJD">ALL_ROWS hint</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL hint that is not appropriate</i></b></p>    <br><p class="detailTblTxt3">The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL, FIRST_ROWS, or FIRST_ROWS_K hint that is favoring NL</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</li>
<li>The query has a FIRST_ROWS or FIRST_ROWS_K hint that is causing the CBO to favor index access and NL join types</li>
</ul>
<br>Remove the hints or avoid the use of the index by adding a NOINDEX() hint; NL joins will usually not be "cost competitive" when indexes are not available to the CBO.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No parallel slaves available for the query</i></b></p>    <br><p class="detailTblTxt3">No parallel slaves were available so the query executed in serial mode.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Event 10392, level 1 shows that the PX coordinator was enable to get enough slaves (at least 2).</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Additional CPUs are needed</i></b></p>    <br><p class="detailTblTxt3">Additional CPUs may be needed to allow enough sessions to use PX.  If manual PX tuning is used, you will have to increase the value of  PARALLEL_MAX_SERVERS after adding the  CPUs.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; adding CPUs may involve downtime depending on the high availability architecture employed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; adding additional CPUs should only improve performance and scalability in this case.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Hardware addition, no details provided here.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Incorrect Selectivity or Cardinality">Incorrect Selectivity or Cardinality</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Filter predicates</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">These causes and solutions apply to incorrect selectivity or cardinality estimates for filter predicates.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect selectivity estimate</i></b></p>    <br><p class="detailTblTxt3">The CBO needs additional information for estimating the selectivity of the query (in maybe just one of the plan steps).  Usually this is due to predicate clauses that have some correlation.  The CBO assumes that filter predicates are independent of each other; when ANDed, these predicates reduce the number of rows returned (increased selectivity).  However, when these predicates are not independent (e.g., a query that filtered on the city name and postal code), more rows are returned than the CBO estimates.  This leads to inaccurate cost estimates and inefficient plans.  </p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for the query or for individual plan steps differ significantly.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Hints to Get the Desired Plan</i></b></p>    <br><p class="detailTblTxt3">Hints will override the CBO's choices (depending on the hint) with a desired change to the execution plan. When hints are used, the execution plans tend to be much less flexible and big changes to the data volume or distribution may lead to sub-optimal plans.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Determining the exact hints to arrive at a certain execution plan may be easy or difficult depending on the degree to which the plan needs to be changed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Hints are applied to a single query so their effect is localized to that query and has no chance of widespread changes (except for widely used views with embedded hints).<br>
For volatile tables, there is a risk that the hint will enforce a plan that is no longer optimal.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the following resources for advice on using hints.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use Plan Stability to Set the Desired Execution Plan</i></b></p>    <br><p class="detailTblTxt3">Plan stability preserves execution plans in stored outlines. An outline is implemented as a set of optimizer hints that are associated with the SQL statement. If the use of the outline is enabled for the statement, Oracle automatically considers the stored hints and tries to generate an execution plan in accordance with those hints.<br>
<br>The performance of a statement is improved without modifying the statement (assuming an outline can be created with the hints that generate a better plan).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; Depending on the circumstance, sometimes an outline for a query is easily generated and used. The easiest case is when a better plan is generated simply by changing an initialization parameter and an outline is captured for the query.<br>
In other cases, it is difficult to obtain the plan and capture it for the outline.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the outline will only affect the associated query.  The outline should be associated with a category that enables one to easily disable the outline if desired.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">Using Plan Stability</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">Stored Outline Quick Reference</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=122812.1">How to Tune a Query that Cannot be Modified</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=102311.1">How to Move Stored Outlines for One Application from One Database to Another</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use dynamic sampling to obtain accurate selectivity estimates</i></b></p>    <br><p class="detailTblTxt3">The purpose of dynamic sampling is to improve server performance by determining more accurate estimates for predicate selectivity and statistics for tables and indexes. The statistics for tables and indexes include table block counts, applicable index block counts, table cardinalities, and relevant join column statistics. These more accurate estimates allow the optimizer to produce better performing plans.<br>
<br>
You can use dynamic sampling to:<br>
<ul class="detailTblTxt3">
<li>Estimate single-table predicate selectivities when collected statistics cannot be used or are likely to lead to significant errors in estimation.</li>
<li>Estimate statistics for tables and relevant indexes without statistics.</li>
<li>Estimate statistics for tables and relevant indexes whose statistics are too out of date to trust.</li>
</ul>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; Dynamic sampling can be turned on at the instance, session, or query level.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Depending on the level, dynamic sampling can consume system resources (I/O bandwidth, CPU) and increase query parse time.  Its is best used as an intermediate step to find a better execution plan which can then be hinted or captured with an outline.  </p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1496">When to Use Dynamic Sampling</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1498">How to Use Dynamic Sampling to Improve Performance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Joins</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">These causes and solutions apply to incorrect selectivity or cardinality estimates for joins.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect selectivity / cardinality estimate for the <i>first</i> table  in a join</i></b></p>    <br><p class="detailTblTxt3">The CBO is not estimating the cardinality of the first table in the join order.  This could drastically affect the performance of the query because this error will cascade into subsequent join orders and lead to bad choices for the join type and access paths.<br>
The estimate may be bad due to missing statistics (see the Statistics and Parameters section above) or a bad assumption about the predicates of the query having non-overlapping data.  Oracle is unable to use statistics to detect overlapping data values in complex predicates without the use of "dynamic sampling".</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for the first table in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the first table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan step).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect join selectivity / cardinality estimate</i></b></p>    <br><p class="detailTblTxt3">The CBO must estimate the cardinality of each join in the plan.  The estimate will be used in each subsequent join for costing the various types of joins (and makes a significant impact to the cost of nested loop joins). <br>
When this estimate is wrong, the costing of subsequent joins in the plan may be very inaccurate.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for one or more tables in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the each table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan steps).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use dynamic sampling to obtain accurate selectivity estimates</i></b></p>    <br><p class="detailTblTxt3">The purpose of dynamic sampling is to improve server performance by determining more accurate estimates for predicate selectivity and statistics for tables and indexes. The statistics for tables and indexes include table block counts, applicable index block counts, table cardinalities, and relevant join column statistics. These more accurate estimates allow the optimizer to produce better performing plans.<br>
<br>
You can use dynamic sampling to:<br>
<ul class="detailTblTxt3">
<li>Estimate single-table predicate selectivities when collected statistics cannot be used or are likely to lead to significant errors in estimation.</li>
<li>Estimate statistics for tables and relevant indexes without statistics.</li>
<li>Estimate statistics for tables and relevant indexes whose statistics are too out of date to trust.</li>
</ul>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; Dynamic sampling can be turned on at the instance, session, or query level.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Depending on the level, dynamic sampling can consume system resources (I/O bandwidth, CPU) and increase query parse time.  Its is best used as an intermediate step to find a better execution plan which can then be hinted or captured with an outline.  </p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1496">When to Use Dynamic Sampling</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1498">How to Use Dynamic Sampling to Improve Performance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p><p class="detailMainTxt">&nbsp;</p> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Predicates and Query Transformation">Predicates and Query Transformation</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Predicates</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The causes and solutions to problems with predicates are listed here.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Cartesian product is occurring due to missing join predicates</i></b></p>    <br><p class="detailTblTxt3">Some tables in the query are missing join predicates.  When this happens, Oracle will return a cartesian product of the tables resulting in many rows being returned (and generally undesirable results).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>Tables in the FROM clause do not have the proper join clauses.  You may need to consult the data model to determine the correct way to join the tables.  </li>
<li>Rows in the result set have many columns</li>
</ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Add the appropriate join predicate for the query</i></b></p>    <br><p class="detailTblTxt3">Review the join predicates and ensure all required predicates are present</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; depending on the complexity of the query and underlying data model, identifying the missing predicate may be easy or difficult.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the additional predicate affects only the query.  If not specified properly, the additional predicate may not return the expected values.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Requires understanding of the joins and data model to troubleshoot.  The solution is simply to add a join predicate.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Missing filter predicate</i></b></p>    <br><p class="detailTblTxt3">A missing filter predicate may cause many more rows to be processed or returned than would otherwise.  If the large number of rows is unexpected, a filter predicate may have been forgotten when the query was written.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Examine the predicate (WHERE clause) to see if any tables are missing a filter condition.  Discuss or observe how the data from this query is used by end-users.  See if end-users need to filter data on their client or only use a few rows out of the entire result set.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Review the intent of the query and ensure a predicate isn't missing</i></b></p>    <br><p class="detailTblTxt3">If the number of rows returned is unexpectedly high, its possible that part of the predicate is missing.  With a smaller number of rows returned, the CBO may choose an index that can retrieve the rows quickly.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; usually requires coordination with developers to examine the query</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the solution applies to the query and won't affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Review the predicate and ensure it isn't missing a filter or join criteria.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Index needed for columns used with fine grained access control </i></b></p>    <br><p class="detailTblTxt3">The use of FGAC will cause additional predicates to be generated.  These predicates may be difficult for the CBO to optimize or they may require the use of new indexes.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>Query performance improves when FGAC is not used</li>
<li>Manually adding  the FGAC-generated predicates to the base query will reproduce the problem.</li>
<li>Event 10730 shows the predicate added by FGAC and it matches the predicate seen in the execution plan's access and filter predicates
</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Create an index on the columns involved in the FGAC</i></b></p>    <br><p class="detailTblTxt3">FGAC introduces additional predicates that may require an index on the relevant columns.  In some cases, a function-based index may be needed.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; just add an index or recreate an index to include the columns used in the security policy.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">The index should have little negative impact except where a table already has many indexes and this index causes DML to take longer than desired.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">TBD</p>    <br><p class="detailTblTxt3">TBD</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://coe.oraclecorp.com">TBD</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>	<p class="detailTblTxt2"><b><i>Cause Identified:   <a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=BUG&id=5195882">Bug 5195882</a></i></b></p>    <br><p class="detailTblTxt3">Queries In FGAC Using Full Table Scan Instead Of Index Access
<br>
<br>
This bug prevents view merging when PL/SQL functions and views are involved - which is common when FGAC is used.  The inability to merge views leads to bad execution plans.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>Query performance improves when FGAC is not used</li>
<li>Manually adding  the FGAC-generated predicates to the base query will reproduce the problem.</li>
<li>Event 10730 shows the predicate added by FGAC and it matches the predicate seen in the execution plan's access and filter predicates
</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Apply patch for bug 5195882 or use the workaround</i></b></p>    <br><p class="detailTblTxt3">Patch and workaround available.
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Requires a patch application.  The workaround is lower effort, but side effects are unknown.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">If applying the one-off patch,  it carries the risk typically associated with one-off patches.<br>
Patchset 10.2.0.3 has the fix for this bug and is lower risk since patchsets are rigorously tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Contact Oracle Support Services for the patch.<br>
<br>
Workaround:<br>
Set optimizer_secure_view_merging=false</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Join Order and Type">Join Order and Type</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Join Order</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The causes and solutions to problems with join order are listed here.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect selectivity / cardinality estimate for the <i>first</i> table  in a join</i></b></p>    <br><p class="detailTblTxt3">The CBO is not estimating the cardinality of the first table in the join order.  This could drastically affect the performance of the query because this error will cascade into subsequent join orders and lead to bad choices for the join type and access paths.<br>
The estimate may be bad due to missing statistics (see the Statistics and Parameters section above) or a bad assumption about the predicates of the query having non-overlapping data.  Oracle is unable to use statistics to detect overlapping data values in complex predicates without the use of "dynamic sampling".</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for the first table in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the first table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan step).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Gather statistics properly</i></b></p>    <br><p class="detailTblTxt3">The CBO will generate better plans when it has accurate statistics for tables and indexes.  In general, the main aspects to focus on are:<br>
<ul class="detailTblTxt3">
<li>ensuring the sample size is large enough</li>
<li>ensuring all objects (tables and indexes) have stats gathered (CASCADE parameter)</li>
<li>ensuring that any columns with skewed data have histograms collected, and at sufficient resolution (METHOD_OPT parameter)</li>
<li>if possible, gather global partition stats</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; easily scripted and executed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Gathering new stats may change some execution plans for the worse, but its more likely plans will improve.  Gathering stats will invalidate cursors in the shared pool - this should be done only during periods of low activity in the database.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">
In general, you can use the following to gather stats for a single table and its indexes as a starting point.  You may need to alter this as you find out that histograms are needed or sample sizes need to be explicitly set:<br>
<br>
<i>Oracle 9.0.x - 9.2.x</i>
<pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE ,
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1' );
</pre>
<br>
<i>Oracle 10g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
estimate_percent => <set this value as high as possible>
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<i>Oracle 11g:</i><pre>
exec DBMS_STATS.GATHER_TABLE_STATS(  
tabname => '  Table_name  ' 
ownname => NULL,  
cascade => 'TRUE',  
method_opt => 'FOR ALL COLUMNS SIZE 1');
</pre>
<br>
Note: replace '  Table_name  ' with the name of the table to gather statistics for.  "<set this value as high as possible>" means that you should strive for 100 percent sample sizes if possible, but if time doesn't permit this, then use values that are as high as possible to gather an accurate sample while finishing the stats gathering in a reasonable time (values like 35% can yield good results).  Oracle 9.2 used 100% sample sizes by default; 11g uses a new very accurate algorithm that takes about the same time as a 10% sample yet yields results close to a 100% sample.  So for 11g, we recommend leaving the estimate_percent to default to AUTO.<br>
</p>    <br><p class="detailTblTxt3">Review the following resources for guidance on properly gathering statistics:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=114671.1">Gathering Statistics for the Cost Based Optimizer</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=237901.1">Gathering Schema or Database Statistics Automatically - Examples</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=1031826.6">Histograms: An Overview</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377152.1">Best Practices for automatic statistics collection on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=377143.1">How to check what automatic statistics collection is scheduled on 10g</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=44961.1">Statistics Gathering: Frequency and Strategy Guidelines</a></p>    <br><p class="detailTblTxt3">In Oracle 9.2 and later versions, system statistics may improve the accuracy of the CBO's estimates by providing the CBO with CPU cost estimates in addition to the normal I/O cost estimates.</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=149560.1">Collect and Display System Statistics (CPU and IO) for CBO usage</a></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=153761.1">Scaling the System to Improve CBO optimizer</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3">
</p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Incorrect join selectivity / cardinality estimate</i></b></p>    <br><p class="detailTblTxt3">The CBO must estimate the cardinality of each join in the plan.  The estimate will be used in each subsequent join for costing the various types of joins (and makes a significant impact to the cost of nested loop joins). <br>
When this estimate is wrong, the costing of subsequent joins in the plan may be very inaccurate.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The estimated vs. actual cardinality for one or more tables in the join order differs significantly.  This can be observed by looking at the following:<br>
<br><b>Estimated cardinality</b>: Look at the execution plan (in SQLTXPLAIN) and find the "Estim Cardinality" column corresponding to the each table in the join order (see the column "Exec Order" to see where to start reading the execution plan)<br>
<br><b>Actual cardinality</b>: Check the runtime execution plan in the TKProf for the query (for the same plan steps).  If you collected the plan from V$SQL using the script in the "Data Collection" section, simply compare the estimated and actual columns.
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use hints to choose a desired join order</i></b></p>    <br><p class="detailTblTxt3">Hints may be used for guiding the CBO to the correct join order.  There are two hints available:<br>
<ul class="detailTblTxt3">
<li><b>ORDERED</b> : The join order will be implemented based on the order of the tables in the FROM clause (from left to right, left being the first table in the join order).  This gives complete control over the join order and overrides the LEADING hint below.</li>
<li><b>LEADING</b> : The join order will start with the specified tables; the rest of the join order will be generated by the CBO.  This is useful when you know the plan is improved by just starting with one or two tables and the rest are set properly by the CBO.</li>
</ul></p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the hint is easily applied to the query.  The LEADING hint is the easiest to use as it requires specifying just  the start of the join.<br>
<br>
Sometimes the CBO will not implement a join order even with a hint.  This occurs when the requested join order is semantically impossible to satisfy the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; the hint will only affect the specific SQL statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABIJGJF">ORDERED hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#BABJIHCI">LEADING hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=69992.1">Why is my hint ignored?</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use dynamic sampling to obtain accurate selectivity estimates</i></b></p>    <br><p class="detailTblTxt3">The purpose of dynamic sampling is to improve server performance by determining more accurate estimates for predicate selectivity and statistics for tables and indexes. The statistics for tables and indexes include table block counts, applicable index block counts, table cardinalities, and relevant join column statistics. These more accurate estimates allow the optimizer to produce better performing plans.<br>
<br>
You can use dynamic sampling to:<br>
<ul class="detailTblTxt3">
<li>Estimate single-table predicate selectivities when collected statistics cannot be used or are likely to lead to significant errors in estimation.</li>
<li>Estimate statistics for tables and relevant indexes without statistics.</li>
<li>Estimate statistics for tables and relevant indexes whose statistics are too out of date to trust.</li>
</ul>
</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; Dynamic sampling can be turned on at the instance, session, or query level.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; Depending on the level, dynamic sampling can consume system resources (I/O bandwidth, CPU) and increase query parse time.  Its is best used as an intermediate step to find a better execution plan which can then be hinted or captured with an outline.  </p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below:</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1496">When to Use Dynamic Sampling</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/stats.htm#sthref1498">How to Use Dynamic Sampling to Improve Performance</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Nested Loop Joins</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The causes and solutions to problems with the use of nested loop joins are listed here.	</td>	</tr>	</table><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL hint that is not appropriate</i></b></p>    <br><p class="detailTblTxt3">The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has a USE_NL, FIRST_ROWS, or FIRST_ROWS_K hint that is favoring NL</i></b></p>    <br><p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The query has a USE_NL hint that may have been improperly specified (specifies the wrong inner table) or is now obsolete.</li>
<li>The query has a FIRST_ROWS or FIRST_ROWS_K hint that is causing the CBO to favor index access and NL join types</li>
</ul>
<br>Remove the hints or avoid the use of the index by adding a NOINDEX() hint; NL joins will usually not be "cost competitive" when indexes are not available to the CBO.
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">The query contains a USE_NL hint and performs better without the hint or with a USE_HASH or USE_MERGE hint.</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove hints that are influencing the choice of index</i></b></p>    <br><p class="detailTblTxt3">Remove the hint that is affecting the CBO's choice of an access path.  Typically, these hints could be: INDEX_**, NO_INDEX, FULL, AND_EQUAL.  By removing the hint, the CBO may choose a better plan (assuming statistics are fresh).</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the suspected hint, assuming you can modify the query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low; this change will only affect the query with the hint.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See related documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#CHDJDIAH">Hints for Access Paths</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p><p class="detailMainTxt">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="3">Merge Joins</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The causes and solutions to problems with the use of merge joins are listed here.	</td>	</tr>	</table><br> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="4">Hash Joins</li></ol> <br>	<table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">	<tr>	<td width="100%" class="detailMainTxt">The causes and solutions to problems with the use of hash joins are listed here.	</td>	</tr>	</table><br> </td> </tr> </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr></table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>     <td width="2%" valign="top" align="left">&nbsp;</td>     <td width="98%">     <p class="detailHdrTxt"><a name="Miscellaneous Causes and Solutions">Miscellaneous Causes and Solutions</a></p><hr class="detailLine">     </td>   </tr> </table> <table width="100%" border="0" cellspacing="1" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111">   <tr>       <td width="75%" valign="top"> <table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr> <td width="3%" class="detailMainTxt">&nbsp;</td> <td width="2%" class="detailMainTxt">&nbsp;</td> <td width="95%" class="detailSubHdrTxt"><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="1">Parsing</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Dynamic sampling is being used for the query and impacting the parse time</i></b></p>    <br><p class="detailTblTxt3">Dynamic sampling is performed by the CBO (naturally at parse time) when it is either requested via hint or parameter, or by default because statistics are missing.  Depending on the level of the dynamic sampling, it may take some time to complete - this time is reflected in the parse time for the statement.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>The execution plan output of SQLTXPLAIN, the UTLXPLS script, or a 10053 trace will show if dynamic sampling was used while optimizing the query.</li>
</ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Alternatives to Dynamic Sampling</i></b></p>    <br><p class="detailTblTxt3">If the parse time is high due to dynamic sampling, alternatives may be needed to obtain the desired plan without using dynamic sampling.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; some alternatives are easy to implement (add a hint), whereas others are more difficult (determine the hint required by comparing plans)</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; in general, the solution will affect only the query.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Some alternatives to dynamic sampling are:<br>
<ol>
<li>In 10g or higher, use the SQL Tuning Advisor (STA)  to generate a profile for the query (in fact, its unlikely you'll even set dynamic sampling on a query that has been tuned by the STA)</li>
<li>Find the hints needed to implement the plan normally generated with dynamic sampling and modify the query with the hints</li>
<li>Use a stored outline to capture the plan generated with dynamic sampling</li>
</ol>
<br>
For very volatile data (in which dynamic sampling was helping obtain a good plan), an approach can be used where an application will choose one of several hinted queries depending on the state of the data (i.e., if data recently deleted use query #1, else query #2).
</p>    <br><p class="detailTblTxt3">Documents for hints:<br></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1602">Using Optimizer Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=221970.1">Forcing a Known Plan Using Hints</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=50607.1">How to Specify an Index Hint</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=29236.1">QREF:  SQL Statement HINTS</a></p>    <br><p class="detailTblTxt3">Documents for stored outlines / plan stability:<br></p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14211/outlines.htm#sthref1787">Using Plan Stability</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=67536.1">Stored Outline Quick Reference</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=122812.1">How to Tune a Query that Cannot be Modified</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=102311.1">How to Move Stored Outlines for One Application from One Database to Another</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Query has many IN LIST parameters / OR statements</i></b></p>    <br><p class="detailTblTxt3">The CBO may take a long time to cost a statement with dozens of IN LIST / OR clauses.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ul class="detailTblTxt3">
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>The query has a large set of IN LIST values or OR clauses.</li>
</ul></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Implement the NO_EXPAND hint to avoid transforming the query block</i></b></p>    <br><p class="detailTblTxt3">In versions 8.x and higher, this will avoid the transformation to separate query blocks with UNION ALL (and save parse time) while still allowing indexes to be used with the IN-LIST ITERATOR operation.  By avoiding a large number of query blocks, the CBO will save time (and hence the parse time will be shorter) since it doesn't have to optimize each block.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; hint applied to a query.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; hint applied only to the query and will not affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the reference documents.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=62153.1">Optimization of large inlists/multiple OR`s</a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14200/sql_elements006.htm#SQLRF50502">NO_EXPAND Hint </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Partitioned table with many partitions</i></b></p>    <br><p class="detailTblTxt3">The use of partitioned tables with many partitions (more than 1,000) may cause high parse CPU times while the CBO determines an execution plan.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>The parse time is responsible for most of  the query's overall elapsed time</li>
<li>Determine total number of partitions for all tables used in the query.</li>
<li>If the number is over 1,000, this cause is likely</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   9.2.0.x, 10.0.0: Bug 2785102 - Query involving many partitions (>1000) has high CPU/memory use</i></b></p>    <br><p class="detailTblTxt3">A query involving a table with a large number of partitions takes a long time to  parse, causes rowcache  contention, and high CPU consumption. The case of this bug involved a table with greater than 10000 partitions and global statistics ere not gathered.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; application of a patchset.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; patchsets generally are low risk because they have been regression tested.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Apply patchset 9.2.0.4<br>
<br>
Workaround: <br>Set "_improved_row_length_enabled"=false</p>    <br><p class="detailTblTxt3">Additional bug information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=BUG&id=2785102">Bug 2785102</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Waits for large query texts to be sent from the client</i></b></p>    <br><p class="detailTblTxt3">A large query (containing lots of text) may take several round trips to be sent from the client to the server; each trip takes time (especially on slow networks).</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3"><ol>
<li>High parse wait times occur any time, not just during peak load or during certain times of the day</lI>
<li>Most other queries do not have high parse wait times at the same time as the query you are trying to tune</li>
<li>TKProf shows "SQL*Net more data from client" wait events.</li>
<li>Raw 10046 trace shows "SQL*Net more data from client" waits just before the PARSE call completes</li>
<li>Slow network ping times due to high latency networks make these waits worse</li>
</ol>
</p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Use PL/SQL REF CURSORs to avoid sending query text to the server across the network</i></b></p>    <br><p class="detailTblTxt3">The performance of parsing a large statement may be improved by encapsulating the SQL in a PL/SQL package and then obtaining a REF CURSOR to the resultset.  This will avoid sending the SQL statement across the network and will only require sending bind values and the PL/SQL call.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; a PL/SQL package will need to be created and the client code will need to be changed to call the PL/SQL and obtain a REF CURSOR.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; there are changes to the client code as well as the PL/SQL code in the database that must be tested thoroughly, but the changes are not widespread and won't affect other queries.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=120201.1">How to use PL/SQL REF Cursors to Return Result Sets </a></p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/appdev.102/b14261/sqloperations.htm#sthref1393">Using Cursor Variables (REF CURSORs)</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> </td> </tr> </table><table width="98%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"><tr> <td width="3%" valign="top" align="right">&nbsp;</td> <td width="97%" class="detailLevel1"> <ol class="detailLevel1"><li value="2">Parallel Execution (PX)</li></ol><br><br> <table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse: collapse" bordercolor="#111111"> <tr><td width="100%" class="detailMainTxt"> <b>Note:</b> This list shows some common causes and solutions but is not a complete list.  If you do not find a possible cause or solution in this list, you can always open a service request with Oracle to investigate other possible causes. </td></tr> </table> <p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   No parallel slaves available for the query</i></b></p>    <br><p class="detailTblTxt3">No parallel slaves were available so the query executed in serial mode.</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Event 10392, level 1 shows that the PX coordinator was enable to get enough slaves (at least 2).</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=199272.1">Why didn't my parallel query use the expected number of slaves?</a></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Additional CPUs are needed</i></b></p>    <br><p class="detailTblTxt3">Additional CPUs may be needed to allow enough sessions to use PX.  If manual PX tuning is used, you will have to increase the value of  PARALLEL_MAX_SERVERS after adding the  CPUs.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium effort; adding CPUs may involve downtime depending on the high availability architecture employed.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk; adding additional CPUs should only improve performance and scalability in this case.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Hardware addition, no details provided here.</p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p>    <table width="100%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bgcolor="#FFFFDF" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Cause Identified:   Hints or configuration settings causing parallel plans</i></b></p>    <br><p class="detailTblTxt3">The CBO will attempt to use parallel operations if the following are set or used:
<ul class="detailTblTxt3">
<li>Parallel hint: <i>parallel(t1, 4)</i>
<li>ALTER SESSION FORCE PARALLEL</li>
<li>Setting a degree of parallel and/or the number of instances on a table or index in a query </li>
</ul>
</p>    <br><p class="detailTblTxt3"><b><i>Cause Justification</i></b></p>	  <p class="detailTblTxt3">Examine the 10053 trace and check the parallel degree for tables and presence of hints in the query.  The presence of any of these is justification for this cause.</p>	  <br><p class="detailTblTxt3">Additional Information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14223/usingpe.htm#CACCAGCH">Summary of Parallelization Rules</a></p> <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table> <p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Remove parallel hints</i></b></p>    <br><p class="detailTblTxt3">The statement is executing in parallel due to parallel hints.  Removing these hints may allow the statement to run serially.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; simply remove the hint from the statement.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low risk, only affects the statement.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">Remove one or more hints of the type:<br>
<ul class="detailTblTxt3">
<li>PARALLEL</li>
<li>PARALLEL_INDEX</li>
<li>PQ_DISTRIBUTE </li>
</ul>
<br>
If one of the tables has a degree greater than 1, the query may still run in parallel.</p>    <br><p class="detailTblTxt3">Hint information:</p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download.oracle.com/docs/cd/B19306_01/server.102/b14211/hintsref.htm#sthref1619">Hints for Parallel Execution </a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table></div><p class="detailTblEmptyLine">&nbsp;</p> <div align="right">    
 
 <table width="98%" border="1" cellpadding="0" cellspacing="0" style="border-style:dashed; border-width:1; border-collapse: collapse" bgcolor="#DBEAD5" bordercolor="#A6B3C8">		 <tr>	  	 <td width="100%" class="detailTblTxt3" valign="top" align="left"> <p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt2"><b><i>Solution Identified:   Alter a table or index's degree of parallelism</i></b></p>    <br><p class="detailTblTxt3">A table or index in the query has its degree (of parallelism) set higher than 1.  This may be one factor causing the query to execute in parallel.  If the parallel plan is not performing well, a serial plan may be obtained by changing the degree.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblLowBG">      <p align="center"><b>L</b></td>      <td width="2%">&nbsp;</td>      <td width="93%" class="detailTblTxt3"><b><i>Effort Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Low effort; the object may be changed with an ALTER command.</p>  <br><table border="0" cellpadding="0" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber2">    <tr>      <td width="5%" class="detailTblMedBG">      <p align="center"><b>M</b></td>      <td width="2%">&nbsp;</td>      <td width="93%"  class="detailTblTxt3"><b><i>Risk Details</i></b></td>    </tr>  </table>    <br><p class="detailTblTxt3">Medium risk; other queries may be running in parallel due to the degree setting and will revert to a serial plan.  
An impact analysis should be performed to determine the effect of this change on other queries.<br>
<br>The ALTER command will invalidate cursors that depend on the table or index and may cause a spike in library cache contention - the change should be done during a period of low activity.</p><p class="detailTblEmptyLine">&nbsp;</p>    <p class="detailTblTxt3"><b><i>Solution Implementation</i></b></p>    <br><p class="detailTblTxt3">See the documents below.</p>    <br><p class="detailTblTxt3"> </p>	<p class="detailTblTxt3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a target="detailWindow" href="http://download-west.oracle.com/docs/cd/B19306_01/server.102/b14200/statements_7002.htm#i2159323">Parallel clause for the CREATE and ALTER TABLE / INDEX statements</a></p>    <br><p class="detailTblTxt3"><b><i>Implementation Verification</i></b></p>    <br><p class="detailTblTxt3"></p><br>
<p class="detailTblTxt3">Re-run the query and determine if the performance 
improves. If performance does not improve, examine the following:</p>
<ul>
<li><p class="detailTblTxt3">Review other possible reasons</li>
<li><p class="detailTblTxt3">Verify the data collection was done properly</li>
<li><p class="detailTblTxt3">Verify the problem statement</li>
</ul>
<p class="detailTblTxt3">If you would like to log a service request, a test case 
would be helpful at this stage, see the following document for instructions:</p>
<p class="detailTblTxt3">&nbsp;</p>
<p class="detailTblTxt3">
<a target="detailWindow" href="https://support.oracle.com/CSP/main/article?cmd=show&type=NOT&id=390610.1">
How to Submit a Testcase to Oracle Support for Reproducing an Execution Plan</a></p>
 <p class="detailTblEmptyLine">&nbsp;</p>		</td>      </tr>     </table>
 </div><p class="detailTblEmptyLine">&nbsp;</p><p class="detailMainTxt">&nbsp;</p> </td> </tr> 
 </table> </td> </tr> <tr> <td width="3%" class="detailEmptyLayer">&nbsp;</td> <td width="2%" class="detailEmptyLayer">&nbsp;</td> <td width="95%" class="detailEmptyLayer">&nbsp;</td> </tr> <tr> <td width="100%" colspan="3" class="detailEmptyLine">&nbsp;</td> </tr> 
 </table><p class="detailMainTxt">&nbsp;</p></td> <td width="25%" valign="top">&nbsp;</td></tr>
 </table>
</body>
</html>
